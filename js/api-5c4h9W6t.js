import{o as e,l as t,h as n}from"./firestore-service-B8JADViu.js";const r={},o=function(e,t,n){let o=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));o=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in r)return;r[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,n&&s.setAttribute("nonce",n),document.head.appendChild(s),t?new Promise((t,n)=>{s.addEventListener("load",t),s.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},s=n.gasApiUrl,a=new Map;async function i(t){if(!t)return null;const n=Date.now(),r=a.get(t);if(r&&n-r.timestamp<3e5)return r.data;try{const r=await e(t);if(r.success&&r.settings&&Object.keys(r.settings).length>0)return a.set(t,{data:r.settings,timestamp:n}),r.settings}catch(o){console.log("[RecruitSettings] Firestore読み込みエラー:",o)}return(null==r?void 0:r.data)||null}async function c(e){try{const n=await t(e.companyDomain,e);if(!n.success)throw new Error(n.error||"保存に失敗しました");return e.companyDomain&&a.set(e.companyDomain,{data:e,timestamp:Date.now()}),n}catch(c){throw console.error("[RecruitSettings] Firestore保存エラー:",c),c}const n=btoa(unescape(encodeURIComponent(JSON.stringify({action:"updateRecruitSettings",settings:e})))),r=`${s}?action=post&data=${encodeURIComponent(n)}`,o=await fetch(r,{method:"GET",redirect:"follow"}),i=await o.json();if(!i.success)throw new Error(i.message||i.error||"保存に失敗しました");return e.companyDomain&&a.set(e.companyDomain,{data:e,timestamp:Date.now()}),i}export{o as _,i as l,c as s};
