import{showToast as e}from"./utils-BNVq905i.js";const a={cloudName:"dnvtqyhuw",uploadPreset:"rikueko_unsigned"},n="prod";async function t(e,a={}){const{maxWidth:n=1200,maxHeight:t=1200,quality:r=.8,outputType:o="image/webp",maxFileSize:l=null}=a;return new Promise((a,s)=>{const d=new Image,c=document.createElement("canvas"),u=c.getContext("2d");d.onload=async()=>{let{width:e,height:p}=d;const m=e/p;if(e>n&&(e=n,p=e/m),p>t&&(p=t,e=p*m),c.width=Math.round(e),c.height=Math.round(p),u.drawImage(d,0,0,c.width,c.height),l){let e=r,n=await i(c,o,e);for(;n.size>l&&e>.1;)e-=.1,n=await i(c,o,e);a(n)}else c.toBlob(e=>{e?a(e):s(new Error("ç”»åƒã®å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ"))},o,r)},d.onerror=()=>s(new Error("ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ")),d.src=URL.createObjectURL(e)})}function i(e,a,n){return new Promise((t,i)=>{e.toBlob(e=>{e?t(e):i(new Error("ç”»åƒã®å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ"))},a,n)})}async function r(e){return t(e,{maxWidth:800,maxHeight:800,quality:.85,outputType:"image/webp",maxFileSize:102400})}async function o(e){return t(e,{maxWidth:1200,maxHeight:1200,quality:.85,outputType:"image/webp",maxFileSize:512e3})}async function l(e,n,t=null){var i;const{cloudName:r,uploadPreset:o}=a,l=new FormData;l.append("file",e),l.append("upload_preset",o),l.append("folder",n),t&&l.append("public_id",t);const s=await fetch(`https://api.cloudinary.com/v1_1/${r}/image/upload`,{method:"POST",body:l});if(!s.ok){const e=await s.json();throw new Error((null==(i=e.error)?void 0:i.message)||"ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ")}return(await s.json()).secure_url}async function s(e,a){const t=await r(e),i=`${n}/companies/${a}`,o=Date.now();return await l(t,i,`logo_${o}`)}async function d(e,a){const t=await r(e),i=`${n}/recruit/${a}`;return await l(t,i,"logo")}async function c(e,a){const i=await t(e,{maxWidth:1920,maxHeight:1920,quality:.85,outputType:"image/webp",maxFileSize:512e3}),r=`${n}/recruit/${a}`,o=Date.now();return await l(i,r,`hero_${o}`)}async function u(e,a){const t=await o(e),i=`${n}/companies/${a}/images`;return await l(t,i)}async function p(e,a){const t=await r(e),i=`${n}/jobs/${a}/logos`,o=Date.now();return await l(t,i,`logo_${o}`)}async function m(e,a){const t=await o(e),i=`${n}/lp/${a}`;return await l(t,i)}function g(e={}){const{accept:a="image/*",multiple:n=!1}=e;return new Promise((e,t)=>{const i=document.createElement("input");i.type="file",i.accept=a,i.multiple=n,i.onchange=a=>{const i=a.target.files;i&&i.length>0?e(n?Array.from(i):i[0]):t(new Error("ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ"))},i.click()})}function y(a={}){const{id:n="image-uploader",label:t="ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",currentUrl:i="",onUpload:r=()=>{},uploadFn:o=null}=a,l=document.createElement("div");l.className="image-uploader",l.id=n,l.innerHTML=`\n    <label class="image-uploader-label">${t}</label>\n    <div class="image-uploader-area" data-drop-zone>\n      ${i?`<img src="${i}" alt="ç¾åœ¨ã®ç”»åƒ" class="image-uploader-preview">`:'<div class="image-uploader-placeholder">\n            <span class="upload-icon">ğŸ“·</span>\n            <p>ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</p>\n            <p class="upload-hint">PNG, JPG, WebP (æœ€å¤§5MB)</p>\n          </div>'}\n      <input type="file" accept="image/*" class="image-uploader-input" style="display: none;">\n      <div class="image-uploader-loading" style="display: none;">\n        <div class="loading-spinner"></div>\n        <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>\n      </div>\n    </div>\n    <input type="hidden" class="image-uploader-url" value="${i}">\n  `;const s=l.querySelector("[data-drop-zone]"),d=l.querySelector(".image-uploader-input"),c=l.querySelector(".image-uploader-loading"),u=l.querySelector(".image-uploader-url");var p,m;async function g(a){if(o){c.style.display="flex";try{const e=await o(a);u.value=e,s.innerHTML=`\n        <img src="${e}" alt="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿" class="image-uploader-preview">\n        <div class="image-uploader-loading" style="display: none;">\n          <div class="loading-spinner"></div>\n          <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>\n        </div>\n      `,r(e)}catch(n){console.error("[ImageUploader] Upload failed:",n),e("ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ: "+n.message,"error")}finally{c.style.display="none"}}else console.error("[ImageUploader] uploadFn is required")}return s.addEventListener("click",()=>{c.style.display&&"none"!==c.style.display||d.click()}),d.addEventListener("change",async e=>{const a=e.target.files[0];a&&await g(a)}),m=async e=>{e.length>0&&await g(e[0])},(p=s).addEventListener("dragover",e=>{e.preventDefault(),p.classList.add("drag-over")}),p.addEventListener("dragleave",e=>{e.preventDefault(),p.classList.remove("drag-over")}),p.addEventListener("drop",async e=>{e.preventDefault(),p.classList.remove("drag-over");const a=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/"));a.length>0&&m(a)}),l.getUrl=()=>u.value,l.setUrl=e=>{u.value=e,e&&(s.innerHTML=`\n        <img src="${e}" alt="ç¾åœ¨ã®ç”»åƒ" class="image-uploader-preview">\n        <div class="image-uploader-loading" style="display: none;">\n          <div class="loading-spinner"></div>\n          <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>\n        </div>\n      `)},l}export{s as a,u as b,y as c,m as d,d as e,c as f,g as s,p as u};
