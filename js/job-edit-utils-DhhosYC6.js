import{escapeHtml as e,showToast as t}from"./utils-BNVq905i.js";import{a as n}from"./env-config-Bna8zKOp.js";import{c as o,U as i,i as a,m as l,b as s,h as r,n as c,e as d,g as u,a as m}from"./firestore-service-qEqRY9xZ.js";import{c as p,d as y,s as v}from"./image-uploader-DhILrmx3.js";import{f,b as g,e as h,d as b}from"./jobs-loader-DkJA1PgK.js";import{D as E,S as w,C as I,c as x,b as $,d as C,g as S,L}from"./LPEditor-DCVlG__W.js";import{a as B,s as q}from"./modal-BOD5e818.js";import{f as A,n as T,r as k,g as D,j,i as M,a as P,s as N,p as U,k as _,l as O,h as F,b as R,u as H}from"./core-CGzeo6h2.js";import{l as V}from"./api-DapBkB8R.js";let J=null,Y=null,K=null,G=null,z=null,W=null,Z=[];function Q(){"undefined"!=typeof firebase&&(firebase.apps.length||firebase.initializeApp(o.firebaseConfig),J=firebase.auth(),Y=firebase.firestore(),J.onAuthStateChanged(async e=>{if(e){K=e;try{G=await e.getIdToken(),console.log("[Admin] Firebase ID token obtained"),await X(e.uid,e.email);if(sessionStorage.getItem(o.sessionKey)){const t=new CustomEvent("authReady",{detail:{user:e,idToken:G,userRole:z,userCompanyDomain:W}});document.dispatchEvent(t)}}catch(t){console.error("[Admin] Failed to get ID token:",t)}}else K=null,G=null,z=null,W=null}))}async function X(e,t){if(Y)try{const n=await Y.collection("admin_users").doc(e).get();if(n.exists){const e=n.data();return z=e.role||i.ADMIN,W=e.companyDomain||null,sessionStorage.setItem(o.userRoleKey,z),W&&sessionStorage.setItem(o.userCompanyKey,W),void console.log("[Admin] User role loaded from admin_users:",z,W)}const a=await Y.collection("admin_users").where("email","==",t).limit(1).get();if(!a.empty){const e=a.docs[0].data();return z=e.role||i.ADMIN,W=e.companyDomain||null,sessionStorage.setItem(o.userRoleKey,z),W&&sessionStorage.setItem(o.userCompanyKey,W),void console.log("[Admin] User role loaded from admin_users by email:",z,W)}const l=await Y.collection("company_users").where("email","==",t).where("isActive","==",!0).get();if(!l.empty){const e=l.docs.map(e=>({docId:e.id,companyDomain:e.data().companyDomain,companyName:e.data().companyName||e.data().companyDomain,userName:e.data().name||e.data().username||t}));Z=e,sessionStorage.setItem("available_companies",JSON.stringify(e));const n=e[0];return z=i.COMPANY,W=n.companyDomain,sessionStorage.setItem(o.userRoleKey,z),sessionStorage.setItem(o.userCompanyKey,W),console.log("[Admin] User role loaded from company_users:",z,W,`(${e.length} companies)`),void(e.length>1&&sessionStorage.setItem("requires_company_selection","true"))}z=null,W=null,Z=[],console.log("[Admin] User not registered in admin_users or company_users")}catch(n){console.error("[Admin] Failed to load user role:",n)}}function ee(){return!!sessionStorage.getItem(o.sessionKey)}function te(e,t){return e===o.credentials.username&&t===o.credentials.password?(sessionStorage.setItem(o.sessionKey,"authenticated"),sessionStorage.setItem(o.userRoleKey,i.ADMIN),z=i.ADMIN,W=null,{success:!0,role:i.ADMIN}):{success:!1,error:"ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"}}async function ne(e,t){if(!J||!Y)return{success:!1,error:"FirebaseãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};if(e.includes("@")){const n=await async function(e,t){try{const a=await J.signInWithEmailAndPassword(e,t),l=a.user.uid;K=a.user,G=await a.user.getIdToken();const s=(await Y.collection("company_users").where("email","==",e).get()).docs.filter(e=>!1!==e.data().isActive);if(0===s.length)return await J.signOut(),{success:!1,error:"ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚"};if(s.length>1){const t=s.map(t=>{const n=t.data();return{docId:t.id,companyDomain:n.companyDomain,companyName:n.companyName||n.companyDomain,userName:n.name||n.username||e}});return sessionStorage.setItem("pending_auth",JSON.stringify({email:e,uid:l,companies:t,authMethod:"firebase_auth"})),Z=t,console.log("[Auth] Firebase Auth: Multiple companies found:",t.length),{success:!0,requiresCompanySelection:!0,companies:t,authMethod:"firebase_auth"}}const r=s[0],c=r.data(),d=c.companyDomain;sessionStorage.setItem(o.sessionKey,"authenticated"),sessionStorage.setItem(o.userRoleKey,i.COMPANY),sessionStorage.setItem(o.userCompanyKey,d),sessionStorage.setItem("auth_method","firebase_auth"),sessionStorage.setItem("company_user_id",c.username||e),sessionStorage.setItem("available_companies",JSON.stringify([{docId:r.id,companyDomain:d,companyName:c.companyName||d}])),z=i.COMPANY,W=d,Z=[{docId:r.id,companyDomain:d,companyName:c.companyName||d}];try{await Y.collection("company_users").doc(r.id).update({lastLogin:firebase.firestore.FieldValue.serverTimestamp()})}catch(n){console.warn("Failed to update last login:",n)}return{success:!0,role:i.COMPANY,companyDomain:d,companyName:c.companyName||d,userName:c.name||c.username||e,userId:r.id,authMethod:"firebase_auth",availableCompanies:Z}}catch(a){console.error("Firebase Auth login error:",a);let e="ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ";switch(a.code){case"auth/user-not-found":case"auth/invalid-credential":e="ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“";break;case"auth/wrong-password":e="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“";break;case"auth/invalid-email":e="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“";break;case"auth/user-disabled":e="ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™";break;case"auth/too-many-requests":e="ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›æ•°ãŒå¤šã™ãã¾ã™ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„"}return{success:!1,error:e,errorCode:a.code}}}(e,t);if(n.success)return n;if("auth/user-not-found"!==n.errorCode&&"auth/invalid-credential"!==n.errorCode)return n;console.log("[Auth] Firebase Auth user not found, trying legacy auth...")}return await async function(e,t){try{const n=await fetch(o.legacyLoginUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usernameOrEmail:e,password:t})}),a=await n.json();if(!a.success)return{success:!1,error:a.error||"ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ"};if(a.requiresCompanySelection)return sessionStorage.setItem("pending_auth",JSON.stringify({email:e,companies:a.companies,authMethod:"legacy"})),Z=a.companies,console.log("[Auth] Multiple companies found:",a.companies.length),{success:!0,requiresCompanySelection:!0,companies:a.companies,authMethod:"legacy"};const l=a.user,s=l.companyDomain;return sessionStorage.setItem(o.sessionKey,"authenticated"),sessionStorage.setItem(o.userRoleKey,i.COMPANY),sessionStorage.setItem(o.userCompanyKey,s),sessionStorage.setItem("auth_method","legacy"),sessionStorage.setItem("company_user_id",l.userName),sessionStorage.setItem("available_companies",JSON.stringify(a.companies)),z=i.COMPANY,W=s,Z=a.companies,console.log("[Auth] Legacy login successful for:",l.userName),{success:!0,role:i.COMPANY,companyDomain:s,companyName:l.companyName,userName:l.userName,userId:l.docId,authMethod:"legacy",availableCompanies:Z}}catch(n){return console.error("Legacy login error:",n),{success:!1,error:"ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: "+n.message}}}(e,t)}async function oe(){if(!J)return{success:!1,error:"Firebaseèªè¨¼ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{const e=new firebase.auth.GoogleAuthProvider,t=await J.signInWithPopup(e);if(K=t.user,G=await t.user.getIdToken(),await X(t.user.uid,t.user.email),!z)return await J.signOut(),{success:!1,error:"ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç®¡ç†ç”»é¢ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚"};sessionStorage.setItem(o.sessionKey,"authenticated"),sessionStorage.setItem("auth_method","google");return"true"===sessionStorage.getItem("requires_company_selection")&&Z.length>1?(sessionStorage.setItem("pending_auth",JSON.stringify({email:t.user.email,uid:t.user.uid,companies:Z,authMethod:"google"})),{success:!0,requiresCompanySelection:!0,companies:Z,authMethod:"google"}):{success:!0,user:K,idToken:G,role:z,companyDomain:W,availableCompanies:Z}}catch(e){return console.error("Google login error:",e),{success:!1,error:"Googleãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: "+e.message}}}async function ie(e){const t=sessionStorage.getItem("pending_auth");if(!t)return{success:!1,error:"èªè¨¼æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"};try{const a=JSON.parse(t),l=a.companies.find(t=>t.companyDomain===e);if(!l)return{success:!1,error:"é¸æŠã—ãŸä¼šç¤¾ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"};if(sessionStorage.setItem(o.sessionKey,"authenticated"),sessionStorage.setItem(o.userRoleKey,i.COMPANY),sessionStorage.setItem(o.userCompanyKey,e),sessionStorage.setItem("auth_method",a.authMethod),sessionStorage.setItem("company_user_id",l.userName),sessionStorage.setItem("available_companies",JSON.stringify(a.companies)),sessionStorage.removeItem("pending_auth"),sessionStorage.removeItem("requires_company_selection"),z=i.COMPANY,W=e,Z=a.companies,Y)try{await Y.collection("company_users").doc(l.docId).update({lastLogin:firebase.firestore.FieldValue.serverTimestamp()})}catch(n){console.warn("Failed to update last login:",n)}return console.log("[Auth] Company selection confirmed:",e),{success:!0,role:i.COMPANY,companyDomain:e,companyName:l.companyName,userName:l.userName,userId:l.docId,availableCompanies:Z}}catch(a){return console.error("Company selection error:",a),{success:!1,error:a.message}}}function ae(){sessionStorage.removeItem(o.sessionKey),sessionStorage.removeItem(o.userRoleKey),sessionStorage.removeItem(o.userCompanyKey),sessionStorage.removeItem("auth_method"),sessionStorage.removeItem("company_user_id"),sessionStorage.removeItem("available_companies"),sessionStorage.removeItem("pending_auth"),z=null,W=null,Z=[];const e=document.getElementById("company-view-section");e&&(e.style.display="none"),J&&J.signOut()}async function le(){if(K)try{return G=await K.getIdToken(!0),G}catch(e){console.error("[Auth] Failed to refresh ID token:",e)}return G}function se(){return z||sessionStorage.getItem(o.userRoleKey)}function re(){return W||sessionStorage.getItem(o.userCompanyKey)}function ce(){return se()===i.ADMIN}function de(){return K&&K.email?K.email:sessionStorage.getItem("company_user_id")||null}async function ue(e,t,n,i="",a="staff",l=""){if(!ce())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!Y)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return{success:!1,error:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"};try{if(!(await Y.collection("company_users").where("email","==",e).where("companyDomain","==",n).get()).empty)return{success:!1,error:"ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯æ—¢ã«ã“ã®ä¼šç¤¾ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™"};const s=await le(),r=await fetch(`${o.cloudFunctionsBaseUrl}/createCompanyUser`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({email:e,password:t,companyDomain:n,name:i,role:a,username:l||e.split("@")[0]})}),c=await r.json();return c.success?{success:!0,id:c.uid,email:e}:{success:!1,error:c.error||"ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ"}}catch(s){return console.error("Failed to add company user:",s),{success:!1,error:s.message}}}async function me(){if(!Y||!ce())return[];try{return(await Y.collection("company_users").orderBy("createdAt","desc").get()).docs.map(e=>{var t,n,o,i;return{id:e.id,...e.data(),password:void 0,createdAt:(null==(n=null==(t=e.data().createdAt)?void 0:t.toDate)?void 0:n.call(t))||null,lastLogin:(null==(i=null==(o=e.data().lastLogin)?void 0:o.toDate)?void 0:i.call(o))||null}})}catch(e){return console.error("Failed to get all company users:",e),[]}}async function pe(e,t){if(!ce())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!Y)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{const n={...t};return delete n.id,await Y.collection("company_users").doc(e).update({...n,updatedAt:firebase.firestore.FieldValue.serverTimestamp()}),{success:!0}}catch(n){return console.error("Failed to update company user:",n),{success:!1,error:n.message}}}async function ye(e){if(!ce())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!Y)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{const n=await Y.collection("company_users").doc(e).get();if(!n.exists)return{success:!1,error:"ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"};if(!n.data()._legacyAuth)try{const t=await le();await fetch(`${o.cloudFunctionsBaseUrl}/deleteCompanyUser`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({uid:e})})}catch(t){console.warn("Failed to delete from Firebase Auth:",t)}return await Y.collection("company_users").doc(e).delete(),{success:!0}}catch(n){return console.error("Failed to delete company user:",n),{success:!1,error:n.message}}}async function ve(e){if(!ce())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!J)return{success:!1,error:"Firebaseèªè¨¼ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{return await J.sendPasswordResetEmail(e),{success:!0,message:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ"}}catch(t){console.error("Failed to send password reset email:",t);let e="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ";switch(t.code){case"auth/user-not-found":e="ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“";break;case"auth/invalid-email":e="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"}return{success:!1,error:e}}}async function fe(e,t){if(!ce())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!Y)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{const n=await Y.collection("company_users").doc(e).get();if(!n.exists)return{success:!1,error:"ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"};const i=n.data();if(i.email&&!i._legacyAuth)return await ve(i.email);const a=await fetch(o.resetLegacyPasswordUrl,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,newPassword:t,adminUid:sessionStorage.getItem(o.userIdKey)})});return await a.json()}catch(n){return console.error("Failed to reset password:",n),{success:!1,error:n.message}}}function ge(e=12){const t="abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789!@#$%";let n="";for(let o=0;o<e;o++)n+=t.charAt(Math.floor(62*Math.random()));return n}function he(e){return`${e}_user_${Math.random().toString(36).substring(2,6)}`}async function be(e){if(!Y)return!1;try{return!(await Y.collection("company_users").where("companyDomain","==",e).limit(1).get()).empty}catch(t){return console.error("Failed to check company user:",t),!1}}function Ee(e,t=""){if(!ce())return console.warn("[Auth] Only admins can enter company view mode"),!1;sessionStorage.setItem("company_view_mode","true"),sessionStorage.setItem("company_view_domain",e),sessionStorage.setItem("company_view_name",t||e),W=e,sessionStorage.setItem(o.userCompanyKey,e),console.log("[Auth] Entered company view mode:",e);const n=new CustomEvent("companyViewModeChanged",{detail:{active:!0,companyDomain:e,companyName:t||e}});return document.dispatchEvent(n),!0}function we(){if(!Ie())return!1;sessionStorage.removeItem("company_view_mode"),sessionStorage.removeItem("company_view_domain"),sessionStorage.removeItem("company_view_name"),sessionStorage.removeItem(o.userCompanyKey),W=null,console.log("[Auth] Exited company view mode");const e=new CustomEvent("companyViewModeChanged",{detail:{active:!1}});return document.dispatchEvent(e),!0}function Ie(){return"true"===sessionStorage.getItem("company_view_mode")}function xe(){return Ie()?{companyDomain:sessionStorage.getItem("company_view_domain"),companyName:sessionStorage.getItem("company_view_name")}:null}async function $e(){if(!ce())return[];if(!Y)return[];try{const e=await Y.collection("companies").get(),t=[];return e.forEach(e=>{t.push({id:e.id,domain:e.data().domain||e.id,name:e.data().name||e.data().companyName||e.id,...e.data()})}),t}catch(e){return console.error("[Auth] Failed to get all companies:",e),[]}}const Ce=Object.freeze(Object.defineProperty({__proto__:null,addAdminUserByEmail:async function(e){if(!Y||!K)return{success:!1,error:"èªè¨¼ã•ã‚Œã¦ã„ã¾ã›ã‚“"};if(!e||!e.includes("@"))return{success:!1,error:"æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"};try{if(!(await Y.collection("admin_users").where("email","==",e).get()).empty)return{success:!1,error:"ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™"};return{success:!0,id:(await Y.collection("admin_users").add({email:e,role:i.ADMIN,companyDomain:null,createdAt:firebase.firestore.FieldValue.serverTimestamp(),createdBy:K.email})).id,email:e}}catch(t){return console.error("Failed to add admin user:",t),{success:!1,error:t.message}}},addCompanyStaff:async function(e,t,n="",i=""){if(!Y)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return{success:!1,error:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"};if(!t||t.length<8)return{success:!1,error:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„"};try{const a=await le();if(!a)return{success:!1,error:"èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚å†ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚"};const l=await fetch(`${o.cloudFunctionsBaseUrl}/createCompanyStaff`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({email:e,password:t,name:n,username:i||e.split("@")[0]})}),s=await l.json();return s.success?{success:!0,id:s.uid,email:e}:{success:!1,error:s.error||"ã‚¹ã‚¿ãƒƒãƒ•ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ"}}catch(a){return console.error("Failed to add company staff:",a),{success:!1,error:a.message}}},addCompanyUser:ue,checkSession:ee,confirmCompanySelection:ie,deleteAdminUser:async function(e){if(!Y||!K)return{success:!1,error:"èªè¨¼ã•ã‚Œã¦ã„ã¾ã›ã‚“"};if(e===K.uid)return{success:!1,error:"è‡ªåˆ†è‡ªèº«ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“"};try{return await Y.collection("admin_users").doc(e).delete(),{success:!0}}catch(t){return console.error("Failed to delete admin user:",t),{success:!1,error:t.message}}},deleteCompanyStaff:async function(e){if(!Y)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};const t=re();if(!t)return{success:!1,error:"ä¼šç¤¾æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"};try{const n=await Y.collection("company_users").doc(e).get();if(!n.exists)return{success:!1,error:"ã‚¹ã‚¿ãƒƒãƒ•ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"};const o=n.data();if(o.companyDomain!==t)return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};const i=sessionStorage.getItem("company_user_id");return o.username===i||o.email===i?{success:!1,error:"è‡ªåˆ†è‡ªèº«ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“"}:(await Y.collection("company_users").doc(e).delete(),{success:!0})}catch(n){return console.error("Failed to delete company staff:",n),{success:!1,error:n.message}}},deleteCompanyUser:ye,enterCompanyViewMode:Ee,exitCompanyViewMode:we,generatePassword:ge,generateUsername:he,getAdminUsers:async function(){if(!Y)return[];if(!K)return console.warn("[Admin] Not authenticated with Firebase Auth"),[];try{return(await Y.collection("admin_users").orderBy("createdAt","desc").get()).docs.map(e=>{var t,n;return{id:e.id,...e.data(),createdAt:(null==(n=null==(t=e.data().createdAt)?void 0:t.toDate)?void 0:n.call(t))||null}})}catch(e){return console.error("Failed to get admin users:",e),[]}},getAllCompanies:$e,getAllCompanyUsersWithInfo:me,getCompanyUsers:async function(e=null){if(!Y)return[];try{let t=Y.collection("company_users");e?t=t.where("companyDomain","==",e):ce()||(t=t.where("companyDomain","==",re()));return(await t.get()).docs.map(e=>({id:e.id,...e.data(),password:void 0}))}catch(t){return console.error("Failed to get company users:",t),[]}},getCompanyViewInfo:xe,getCurrentUser:function(){return K},getCurrentUserEmail:de,getIdToken:le,getUserCompanyDomain:re,getUserRole:se,handleCompanyLogin:ne,handleGoogleLogin:oe,handleLogin:te,handleLogout:ae,hasCompanyUser:be,initFirebase:Q,isAdmin:ce,isInCompanyViewMode:Ie,resetCompanyUserPassword:fe,sendPasswordResetEmail:ve,updateCompanyUser:pe},Symbol.toStringTag,{value:"Module"})),Se=n.analytics;async function Le(e,t={},n=null){const o=new URLSearchParams({type:e,...t}),i=`${Se}?${o.toString()}`,a={};n&&(a.Authorization=`Bearer ${n}`);const l=await fetch(i,{headers:a});if(!l.ok)throw new Error(`API Error: ${l.status}`);const s=await l.json();if(!s.success)throw new Error(s.error||"Unknown API error");return s.data}async function Be(e,t=null){return Le("overview",{days:e},t)}async function qe(e,t=null){return Le("traffic",{days:e},t)}async function Ae(e,t,n=null){return Le("company-detail",{domain:e,days:t},n)}function Te(e){if(!e||e<=0)return"-";const t=Math.round(e);if(t>=3600){return`${Math.floor(t/3600)}æ™‚é–“${Math.floor(t%3600/60)}åˆ†`}if(t>=60){return`${Math.floor(t/60)}åˆ†${t%60}ç§’`}return`${t}ç§’`}function ke(e){if(!e)return"ãã®ä»–";const t=e.toLowerCase();return"mobile"===t||t.includes("mobile")?"ãƒ¢ãƒã‚¤ãƒ«":"desktop"===t||t.includes("desktop")?"ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—":"tablet"===t||t.includes("tablet")?"ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ":e}function De(t,n,o){var i;const a=function(e,t){const n=(null==e?void 0:e.male)||0,o=n+((null==e?void 0:e.female)||0),i=document.getElementById(t.maleBar),a=document.getElementById(t.femaleBar),l=document.getElementById(t.malePercent),s=document.getElementById(t.femalePercent);if(o>0){const e=Math.round(n/o*100),t=100-e;return i&&(i.style.width=`${e}%`),a&&(a.style.width=`${t}%`),l&&(l.textContent=`${e}%`),s&&(s.textContent=`${t}%`),!0}return i&&(i.style.width="50%"),a&&(a.style.width="50%"),l&&(l.textContent="-"),s&&(s.textContent="-"),!1}(t,{maleBar:o.maleBarId,femaleBar:o.femaleBarId,malePercent:o.malePercentId,femalePercent:o.femalePercentId}),l=function(t,n){const o=document.getElementById(n);if(!o)return!1;const i=Object.entries(t||{}).filter(([e])=>"(not set)"!==e);if(i.length>0&&i.some(([,e])=>e>0)){const t=Math.max(...i.map(([,e])=>e));return o.innerHTML=i.map(([n,o])=>`\n        <div class="age-bar-wrapper">\n          <span class="age-bar-value">${o}</span>\n          <div class="age-bar" style="height: ${t>0?Math.max(10,o/t*80):10}px;"></div>\n          <span class="age-bar-label">${e(n)}</span>\n        </div>\n      `).join(""),!0}return o.innerHTML="",!1}(n,o.ageContainerId),s=o.insufficientDataId||"demographics-insufficient-data";let r=document.getElementById(s);if(a||l)r&&(r.style.display="none");else{if(!r){const e=null==(i=document.getElementById(o.ageContainerId))?void 0:i.closest(".demographics-grid");e&&(r=document.createElement("div"),r.id=s,r.className="demographics-insufficient-notice",r.innerHTML='\n          <p>ã‚¢ã‚¯ã‚»ã‚¹æ•°ãŒå°‘ãªã„ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã§ãã¾ã›ã‚“ã€‚</p>\n          <p class="notice-sub">Google Analyticsã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã«ã‚ˆã‚Šã€ä¸€å®šä»¥ä¸Šã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…è¦ã§ã™ã€‚</p>\n        ',e.parentElement.insertBefore(r,e))}r&&(r.style.display="block")}}let je=[],Me=!1;function Pe(){return je}async function Ne(){const e=document.getElementById("company-manage-tbody");e&&(e.innerHTML='<tr><td colspan="6" class="loading-cell">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</td></tr>');try{a();const t=await l();if(!t.success)throw new Error(t.error||"ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");if(je=t.companies||[],e){if(0===je.length)return void(e.innerHTML='<tr><td colspan="6" class="loading-cell">ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>');Re()}}catch(t){console.error("ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",t),e&&(e.innerHTML='<tr><td colspan="6" class="loading-cell">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</td></tr>')}}function Ue(e){var t;const n=null==je?void 0:je.find(t=>t.companyDomain===e);n&&sessionStorage.setItem("editing_company_data",JSON.stringify(n)),(null==(t=window.AdminDashboard)?void 0:t.navigateToCompanyEdit)?window.AdminDashboard.navigateToCompanyEdit(e,"company-manage"):window.location.href=`company-edit.html?domain=${encodeURIComponent(e)}`}function _e(){var e;(null==(e=window.AdminDashboard)?void 0:e.navigateToCompanyEdit)?window.AdminDashboard.navigateToCompanyEdit(null,"company-manage"):window.location.href="company-edit.html"}function Oe(){const e=document.getElementById("company-modal");e&&(e.style.display="none"),Me=!1}async function Fe(){var e,n,o,i,l,s,c;const d=document.getElementById("edit-company-domain"),u=(null==d?void 0:d.value.trim().toLowerCase())||"",m={company:(null==(e=document.getElementById("edit-company-name"))?void 0:e.value.trim())||"",company_domain:u,companyDomain:u,designPattern:(null==(n=document.getElementById("edit-design-pattern"))?void 0:n.value)||"modern",imageUrl:(null==(o=document.getElementById("edit-image-url"))?void 0:o.value.trim())||"",order:(null==(i=document.getElementById("edit-order"))?void 0:i.value)||"",description:(null==(l=document.getElementById("edit-description"))?void 0:l.value.trim())||"",showCompany:(null==(s=document.getElementById("edit-show-company"))?void 0:s.checked)?"â—‹":"",visible:(null==(c=document.getElementById("edit-show-company"))?void 0:c.checked)?"â—‹":""};if(m.company&&m.companyDomain)if(/^[a-z0-9-]+$/.test(m.companyDomain)){if(Me){if(null==je?void 0:je.find(e=>e.companyDomain===m.companyDomain))return void t("ã“ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™","error")}try{const e=document.getElementById("company-modal-save");e&&(e.disabled=!0,e.textContent="ä¿å­˜ä¸­..."),a();const n={company:m.company,companyAddress:m.companyAddress||"",description:m.description,imageUrl:m.imageUrl,designPattern:m.designPattern,order:parseInt(m.order)||0,showCompany:"â—‹"===m.showCompany||"â—¯"===m.showCompany},o=await r(u,n);if(e&&(e.disabled=!1,e.textContent="ä¿å­˜"),!o.success)return void t("Firestoreã¸ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: "+(o.error||"ä¸æ˜ãªã‚¨ãƒ©ãƒ¼"),"error");if(localStorage.removeItem(`company_data_${m.companyDomain}`),Me)je.push(m);else{const e=je.findIndex(e=>e.companyDomain===m.companyDomain);-1!==e&&(je[e]=m)}Oe(),Re(),t("ä¼šç¤¾æƒ…å ±ã‚’ä¿å­˜ã—ã¾ã—ãŸ","success")}catch(p){console.error("Firestoreä¿å­˜ã‚¨ãƒ©ãƒ¼:",p),t("Firestoreã¸ã®ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: "+p.message,"error")}}else t("ä¼šç¤¾ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯åŠè§’è‹±æ•°å­—ã¨ãƒã‚¤ãƒ•ãƒ³ã®ã¿ä½¿ç”¨ã§ãã¾ã™","error");else t("ä¼šç¤¾åã¨ä¼šç¤¾ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯å¿…é ˆã§ã™","error")}function Re(){const t=document.getElementById("company-manage-tbody");if(!t)return;const n=je||[];0!==n.length?(t.innerHTML=n.map(t=>`\n    <tr data-domain="${e(t.companyDomain||"")}">\n      <td>${e(t.company||"")}</td>\n      <td><code>${e(t.companyDomain||"")}</code></td>\n      <td><span class="badge ${t.designPattern||"modern"}">${s(t.designPattern||"modern")}</span></td>\n      <td>${!0===t.showCompany||"â—‹"===t.showCompany||"â—¯"===t.showCompany?'<span class="badge success">è¡¨ç¤º</span>':'<span class="badge">éè¡¨ç¤º</span>'}</td>\n      <td>\n        <div class="action-buttons">\n          <button class="btn-small btn-edit" data-action="edit" data-domain="${e(t.companyDomain||"")}">ç·¨é›†</button>\n          <button class="btn-small btn-primary" data-action="jobs" data-domain="${e(t.companyDomain||"")}">æ±‚äººç®¡ç†</button>\n          <button class="btn-small btn-secondary" data-action="recruit" data-domain="${e(t.companyDomain||"")}">æ¡ç”¨ãƒšãƒ¼ã‚¸ç¢ºèª</button>\n        </div>\n      </td>\n    </tr>\n  `).join(""),t.dataset.eventBound||(t.dataset.eventBound="true",t.addEventListener("click",e=>{const t=e.target.closest("[data-action]");if(!t)return;const n=t.dataset.action,o=t.dataset.domain;console.log("[CompanyManager] Action clicked:",n,o),"edit"===n?Ue(o):"jobs"===n?He(o):"recruit"===n&&function(e){const t=null==je?void 0:je.find(t=>t.companyDomain===e),n=new CustomEvent("navigateToSection",{detail:{section:"recruit-settings",companyDomain:e,company:t}});document.dispatchEvent(n)}(o)}))):t.innerHTML='<tr><td colspan="5" class="loading-cell">ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>'}function He(e){var n;const o=null==je?void 0:je.find(t=>t.companyDomain===e);if(o)if(null==(n=window.AdminDashboard)?void 0:n.navigateToJobManage)window.AdminDashboard.navigateToJobManage(e,o.company||e,"company-manage");else{const t=new URLSearchParams;t.set("domain",e),t.set("company",o.company||e),o.manageSheetUrl&&t.set("sheetUrl",o.manageSheetUrl),window.location.href=`job-manage.html?${t.toString()}`}else t("ä¼šç¤¾æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“","error")}function Ve(e){const{containerId:t,fillId:n,countId:o,totalSections:i,checkComplete:a}=e,l=document.getElementById(n),s=document.getElementById(o);if(!l||!s)return{update:()=>{}};const r=()=>{const e=a(),t=Math.round(e/i*100);l.style.width=`${t}%`,s.textContent=e};return r(),{update:r}}function Je(e){const t=[];return e.forEach(({selector:e,maxLength:n})=>{const o=document.querySelector(e);o&&t.push(function(e,t,n=.8){var o;if(!e)return;const i=null==(o=e.parentElement)?void 0:o.querySelector(".char-counter");i&&i.remove();const a=e.parentElement;a.classList.contains("input-with-counter")||(a.classList.add("input-with-counter"),a.style.position="relative");const l=document.createElement("span");l.className="char-counter",a.appendChild(l);const s=()=>{const o=e.value.length;l.textContent=`${o}/${t}`,l.classList.remove("warning","error"),o>t?l.classList.add("error"):o>=t*n&&l.classList.add("warning")};return e.addEventListener("input",s),s(),{update:s}}(o,n))}),t}function Ye(e){const{toggleContainerSelector:t,previewPanelSelector:n}=e,o=document.querySelector(t),i=document.querySelector(n);o&&i&&o.querySelectorAll("button[data-device]").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.device;o.querySelectorAll("button").forEach(t=>{t.classList.toggle("active",t===e)}),i.dataset.device=t})})}function Ke(e){const t=document.getElementById(e);if(!t)return{showSaving:()=>{},showSaved:()=>{},showOff:()=>{}};const n=t.querySelector("span");return{showSaving:()=>{t.className="autosave-indicator saving",n&&(n.textContent="ä¿å­˜ä¸­...")},showSaved:(e=new Date)=>{t.className="autosave-indicator saved";const o=e.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"});n&&(n.textContent=`æœ€çµ‚ä¿å­˜: ${o}`)},showOff:()=>{t.className="autosave-indicator",n&&(n.textContent="è‡ªå‹•ä¿å­˜: ã‚ªãƒ•")}}}function Ge(e,t){const n=document.querySelector(e);n&&t.forEach(e=>{var t;const o=n.querySelector(`#${e}`)||n.querySelector(`[name="${e}"]`);if(!o)return;const i=n.querySelector(`label[for="${e}"]`)||(null==(t=o.closest(".form-group"))?void 0:t.querySelector("label"));i&&!i.classList.contains("required")&&i.classList.add("required"),o.setAttribute("required","")})}function ze(e){if(!e)return[];const t=[],n=e.replace(/\\n/g,"\n").split(/\|\||[\n\r]+/).filter(e=>e.trim());for(const o of n){const e=o.match(/Q[:ï¼š](.+?)(?=\|A[:ï¼š]|$)/i),n=o.match(/A[:ï¼š](.+)/i);e&&n&&t.push({id:`faq-${t.length+1}`,question:e[1].trim(),answer:n[1].trim()})}return t}let We=[],Ze={},Qe=null,Xe=null,et=null,tt={};function nt(e,t={}){Xe=e,et=t.getCompanyDomain||(()=>null),function(){const e=document.getElementById("btn-add-section");e&&e.addEventListener("click",rt);const t=document.getElementById("btn-add-custom-section");t&&t.addEventListener("click",ut);const n=document.getElementById("add-section-modal-close");n&&n.addEventListener("click",ct);const o=document.getElementById("add-section-modal-cancel");o&&o.addEventListener("click",ct);const i=document.getElementById("section-editor-close");i&&i.addEventListener("click",gt);const a=document.getElementById("section-editor-cancel");a&&a.addEventListener("click",gt);const l=document.getElementById("section-editor-save");l&&l.addEventListener("click",ht);const s=document.getElementById("section-delete-btn");s&&s.addEventListener("click",()=>{Qe&&(pt(Qe.id),gt())});const r=document.getElementById("lp-sections-list");r&&r.addEventListener("click",lt);document.querySelectorAll(".modal-overlay").forEach(e=>{e.addEventListener("click",t=>{t.target===e&&(e.style.display="none")})})}(),function(){const e=document.getElementById("template-selector-container");if(!e)return;const t=Ze.layoutStyle||"modern";e.innerHTML=function(e="modern"){return`\n    <div class="layout-style-grid">\n      ${$.map((t,n)=>{const o=e===t.id;return`\n      <label class="layout-option ${o?"selected":""}">\n        <input type="radio" name="lp-layout-style" value="${t.id}" ${o?"checked":""} data-layout="${t.id}">\n        <div class="layout-preview" style="position: relative;">\n          <div class="template-color-preview" style="\n            position: absolute;\n            top: 8px;\n            right: 8px;\n            width: 24px;\n            height: 24px;\n            border-radius: 4px;\n            background: ${t.color};\n            border: 2px solid rgba(255,255,255,0.8);\n            box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n          "></div>\n          <span class="layout-name">${t.name}</span>\n          <span class="layout-desc">${t.description}</span>\n          <span class="layout-industries" style="font-size: 11px; color: #6b7280; margin-top: 4px; display: block;">${t.industries.join(" / ")}</span>\n        </div>\n      </label>\n    `}).join("")}\n    </div>\n  `}(t),function(e){e.querySelectorAll('input[name="lp-layout-style"]').forEach(t=>{t.addEventListener("change",()=>{const n=t.value;e.querySelectorAll(".layout-option").forEach(e=>{const t=e.querySelector('input[name="lp-layout-style"]');e.classList.toggle("selected",(null==t?void 0:t.value)===n)}),Ze.layoutStyle=n,Xe&&Xe()})})}(e)}()}function ot(e){const t=function(e){var t;if(!e)return{version:"2.0",sections:[{id:"hero-1",type:"hero",order:0,visible:!0,data:{title:"",subtitle:"",image:""},layout:{}},{id:"points-1",type:"points",order:1,visible:!0,data:{sectionTitle:"ã“ã®æ±‚äººã®ãƒã‚¤ãƒ³ãƒˆ",points:[]},layout:{columns:3,style:"cards"}},{id:"jobs-1",type:"jobs",order:2,visible:!0,data:{sectionTitle:"å‹Ÿé›†ä¸­ã®æ±‚äºº"},layout:{}},{id:"details-1",type:"details",order:3,visible:!0,data:{sectionTitle:"å‹Ÿé›†è¦é …"},layout:{}},{id:"faq-1",type:"faq",order:4,visible:!0,data:{sectionTitle:"ã‚ˆãã‚ã‚‹è³ªå•",items:[]},layout:{style:"accordion"}},{id:"apply-1",type:"apply",order:5,visible:!0,data:{},layout:{}}],globalSettings:{designPattern:"modern",layoutStyle:"modern",ctaText:"ä»Šã™ãå¿œå‹Ÿã™ã‚‹"}};if(e.lpContent){console.log("[migrateToV2Format] lpContent found, length:",e.lpContent.length);try{const n=JSON.parse(e.lpContent);if(console.log("[migrateToV2Format] Parsed lpContent, version:",n.version,"sections:",null==(t=n.sections)?void 0:t.length),"2.0"===n.version){if(e.faq){const t=ze(e.faq),o=n.sections.find(e=>"faq"===e.type);o&&(o.data=o.data||{},o.data.items=t,o.visible=t.length>0)}return console.log("[migrateToV2Format] Returning parsed v2 content with sections:",n.sections.map(e=>e.type)),n}}catch(s){console.error("[migrateToV2Format] JSON parse error:",s.message),console.log("[migrateToV2Format] lpContent value:",e.lpContent.substring(0,200))}}else console.log("[migrateToV2Format] No lpContent found, migrating from legacy format");const n=[];let o={points:!0,jobs:!0,details:!0,faq:!0};try{e.sectionVisibility&&(o={...o,...JSON.parse(e.sectionVisibility)})}catch(s){console.warn("sectionVisibility parse error:",s)}let i=E;if(e.sectionOrder){const t=e.sectionOrder.split(",").map(e=>e.trim()).filter(e=>e);if(t.length>0){const e=E.filter(e=>!t.includes(e));i=[...t,...e]}}n.push({id:"hero-1",type:"hero",order:i.indexOf("hero"),visible:!0,data:{title:e.heroTitle||"",subtitle:e.heroSubtitle||"",image:e.heroImage||""},layout:{}});const a=[];for(let r=1;r<=6;r++){const t=e[`pointTitle${r}`],n=e[`pointDesc${r}`];t&&a.push({id:`p${r}`,title:t,description:n||""})}n.push({id:"points-1",type:"points",order:i.indexOf("points"),visible:o.points,data:{sectionTitle:"ã“ã®æ±‚äººã®ãƒã‚¤ãƒ³ãƒˆ",points:a},layout:{columns:3,style:"cards"}}),n.push({id:"jobs-1",type:"jobs",order:i.indexOf("jobs"),visible:o.jobs,data:{sectionTitle:"å‹Ÿé›†ä¸­ã®æ±‚äºº"},layout:{}}),n.push({id:"details-1",type:"details",order:i.indexOf("details"),visible:o.details,data:{sectionTitle:"å‹Ÿé›†è¦é …"},layout:{}});const l=ze(e.faq);return n.push({id:"faq-1",type:"faq",order:i.indexOf("faq"),visible:o.faq&&l.length>0,data:{sectionTitle:"ã‚ˆãã‚ã‚‹è³ªå•",items:l},layout:{style:"accordion"}}),n.push({id:"apply-1",type:"apply",order:i.indexOf("apply"),visible:!0,data:{},layout:{}}),n.sort((e,t)=>e.order-t.order),{version:"2.0",sections:n,globalSettings:{designPattern:e.designPattern||"modern",layoutStyle:e.layoutStyle||"modern",ctaText:e.ctaText||"ä»Šã™ãå¿œå‹Ÿã™ã‚‹",tiktokPixelId:e.tiktokPixelId||"",googleAdsId:e.googleAdsId||"",googleAdsLabel:e.googleAdsLabel||"",ogpTitle:e.ogpTitle||"",ogpDescription:e.ogpDescription||"",ogpImage:e.ogpImage||""}}}(e);We=t.sections||[],Ze=t.globalSettings||{},e.layoutStyle&&(Ze.layoutStyle=e.layoutStyle),at(),function(){const e=document.getElementById("template-selector-container");if(!e)return;const t=Ze.layoutStyle||"modern";e.querySelectorAll('input[name="lp-layout-style"]').forEach(e=>{e.checked=e.value===t}),e.querySelectorAll(".layout-option").forEach(e=>{const n=e.querySelector('input[name="lp-layout-style"]');e.classList.toggle("selected",(null==n?void 0:n.value)===t)})}()}function it(){return{version:"2.0",sections:We,globalSettings:Ze}}function at(){const t=document.getElementById("lp-sections-list");if(!t)return void console.log("[renderSectionsList] Container not found");const n=[...We].sort((e,t)=>(e.order||0)-(t.order||0));console.log("[renderSectionsList] Rendering sections:",n.length,n.map(e=>e.type)),t.innerHTML=n.map(e=>function(e){var t,n;const o=w[e.type],i=null==o?void 0:o.required,a=!1!==e.visible,l="custom"===e.type&&(null==(t=e.layout)?void 0:t.variant)&&(null==(n=I[e.layout.variant])?void 0:n.name)||"";return`\n    <li class="section-item ${a?"":"hidden"}"\n        data-section-id="${e.id}"\n        data-type="${e.type}"\n        draggable="true">\n      <span class="section-drag-handle">â‹®â‹®</span>\n      <span class="section-icon">${(null==o?void 0:o.icon)||"ğŸ“„"}</span>\n      <div class="section-info">\n        <div class="section-name">${(null==o?void 0:o.name)||e.type}</div>\n        ${l?`<div class="section-type-label">${l}</div>`:""}\n      </div>\n      <div class="section-actions">\n        <button type="button" class="section-btn btn-edit" title="ç·¨é›†" data-section-id="${e.id}">\n          âœï¸\n        </button>\n        ${i?"":`\n          <button type="button" class="section-btn btn-duplicate" title="è¤‡è£½" data-section-id="${e.id}">\n            ğŸ“‹\n          </button>\n        `}\n        <button type="button" class="section-btn btn-visibility ${a?"":"hidden"}" title="${a?"éè¡¨ç¤ºã«ã™ã‚‹":"è¡¨ç¤ºã™ã‚‹"}" data-section-id="${e.id}">\n          ${a?"ğŸ‘ï¸":"ğŸ‘ï¸â€ğŸ—¨ï¸"}\n        </button>\n        ${i?"":`\n          <button type="button" class="section-btn btn-delete" title="å‰Šé™¤" data-section-id="${e.id}">\n            ğŸ—‘ï¸\n          </button>\n        `}\n      </div>\n    </li>\n  `}(e)).join(""),function(){const e=document.getElementById("lp-sections-list");if(!e)return;let t=null;e.querySelectorAll(".section-item").forEach(n=>{n.addEventListener("dragstart",e=>{t=n,n.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain","")}),n.addEventListener("dragend",()=>{n.classList.remove("dragging"),t=null,e.querySelectorAll(".section-item").forEach(e=>{e.classList.remove("drag-over")}),function(){const e=document.getElementById("lp-sections-list");if(!e)return;const t=e.querySelectorAll(".section-item");t.forEach((e,t)=>{const n=e.dataset.sectionId,o=We.find(e=>e.id===n);o&&(o.order=t)})}(),St()}),n.addEventListener("dragover",o=>{if(o.preventDefault(),o.dataTransfer.dropEffect="move",!t||t===n)return;const i=function(e,t){const n=[...e.querySelectorAll(".section-item:not(.dragging)")];return n.reduce((e,n)=>{const o=n.getBoundingClientRect(),i=t-o.top-o.height/2;return i<0&&i>(e.offset||Number.NEGATIVE_INFINITY)?{offset:i,element:n}:e},{offset:Number.NEGATIVE_INFINITY}).element||null}(e,o.clientY);e.querySelectorAll(".section-item").forEach(e=>{e.classList.remove("drag-over")}),i&&i!==t&&i.classList.add("drag-over"),null==i?e.appendChild(t):e.insertBefore(t,i)}),n.addEventListener("dragleave",()=>{n.classList.remove("drag-over")})})}(),function(){const t=document.getElementById("lp-custom-sections-panel"),n=document.getElementById("lp-custom-sections-list");if(!t||!n)return;const o=["hero","points","jobs","details","faq","apply"],i=We.filter(e=>!o.includes(e.type)).sort((e,t)=>(e.order||0)-(t.order||0));i.length>0?(n.innerHTML=i.map(t=>function(t){var n,o;const i=w[t.type],a=!1!==t.visible,l=(null==(n=t.data)?void 0:n.sectionTitle)||(null==(o=t.data)?void 0:o.title)||"",s=function(e){var t,n,o,i,a,l,s,r;switch(e.type){case"video":if(null==(t=e.data)?void 0:t.videoUrl){const t=e.data.videoUrl;return t.includes("youtube")||t.includes("youtu.be")?"YouTubeå‹•ç”»":t.includes("vimeo")?"Vimeoå‹•ç”»":t.includes("tiktok")?"TikTokå‹•ç”»":"å‹•ç”»URLè¨­å®šæ¸ˆã¿"}return"å‹•ç”»æœªè¨­å®š";case"carousel":const c=(null==(o=null==(n=e.data)?void 0:n.images)?void 0:o.length)||0;return c>0?`${c}æšã®ç”»åƒ`:"ç”»åƒæœªè¨­å®š";case"gallery":const d=(null==(a=null==(i=e.data)?void 0:i.images)?void 0:a.length)||0;return d>0?`${d}æšã®ç”»åƒ`:"ç”»åƒæœªè¨­å®š";case"testimonial":const u=(null==(s=null==(l=e.data)?void 0:l.testimonials)?void 0:s.length)||0;return u>0?`${u}äººã®å£°`:"æœªè¨­å®š";case"custom":const m=I[null==(r=e.layout)?void 0:r.variant];return(null==m?void 0:m.name)||"ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„";default:return""}}(t);return`\n    <div class="custom-section-item ${a?"":"hidden"}" data-section-id="${t.id}" data-type="${t.type}">\n      <span class="custom-section-icon">${(null==i?void 0:i.icon)||"ğŸ“„"}</span>\n      <div class="custom-section-info">\n        <span class="custom-section-type">${(null==i?void 0:i.name)||t.type}</span>\n        ${l?`<span class="custom-section-title">${e(l)}</span>`:""}\n        ${s?`<span class="custom-section-meta">${e(s)}</span>`:""}\n      </div>\n      <div class="custom-section-actions">\n        <button type="button" class="section-btn btn-edit" title="ç·¨é›†" data-section-id="${t.id}">âœï¸</button>\n        <button type="button" class="section-btn btn-visibility ${a?"":"hidden"}" title="${a?"éè¡¨ç¤ºã«ã™ã‚‹":"è¡¨ç¤ºã™ã‚‹"}" data-section-id="${t.id}">\n          ${a?"ğŸ‘ï¸":"ğŸ‘ï¸â€ğŸ—¨ï¸"}\n        </button>\n        <button type="button" class="section-btn btn-delete" title="å‰Šé™¤" data-section-id="${t.id}">ğŸ—‘ï¸</button>\n      </div>\n    </div>\n  `}(t)).join(""),function(){const e=document.getElementById("lp-custom-sections-list");if(!e)return;e.onclick=e=>{const t=e.target.closest("button");if(!t)return;const n=t.dataset.sectionId;n&&(t.classList.contains("btn-edit")?ft(n):t.classList.contains("btn-visibility")?yt(n):t.classList.contains("btn-delete")&&pt(n))}}()):n.innerHTML=""}()}function lt(e){const n=e.target.closest("button");if(!n)return;const o=n.dataset.sectionId;o&&(n.classList.contains("btn-edit")?ft(o):n.classList.contains("btn-duplicate")?function(e){var n;const o=We.find(t=>t.id===e);if(!o)return;if(!x(o.type,We))return void t(`${(null==(n=w[o.type])?void 0:n.name)||o.type}ã¯ã“ã‚Œä»¥ä¸Šè¿½åŠ ã§ãã¾ã›ã‚“`,"warning");const i={...JSON.parse(JSON.stringify(o)),id:S(o.type),order:o.order+.5};We.push(i),vt(),at(),St()}(o):n.classList.contains("btn-visibility")?yt(o):n.classList.contains("btn-delete")&&pt(o))}const st={heroCta:"ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒ“ãƒ¥ãƒ¼å†…ã«CTAãƒœã‚¿ãƒ³ï¼ˆå¿œå‹Ÿãƒœã‚¿ãƒ³ãƒ»å‹•ç”»ãƒœã‚¿ãƒ³ï¼‰ã‚’è¿½åŠ ",hero:"ãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã¨ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³",points:"æ±‚äººã®ç‰¹å¾´ã‚„ãƒã‚¤ãƒ³ãƒˆã‚’ç®‡æ¡æ›¸ãã§è¡¨ç¤º",jobs:"æ±‚äººä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³",details:"çµ¦ä¸ãƒ»å‹¤å‹™åœ°ãªã©å‹Ÿé›†è¦é …ã®è©³ç´°ã‚’è¡¨ç¤º",faq:"ã‚ˆãã‚ã‚‹è³ªå•ã¨å›ç­”ã‚’è¡¨ç¤º",apply:"å¿œå‹Ÿãƒ•ã‚©ãƒ¼ãƒ ã‚„å¿œå‹Ÿãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º",video:"å‹•ç”»ï¼ˆYouTubeã€Vimeoã€TikTokï¼‰ã‚’åŸ‹ã‚è¾¼ã¿è¡¨ç¤º",carousel:"è¤‡æ•°ã®ç”»åƒã‚’ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼å½¢å¼ã§è¡¨ç¤º",gallery:"è¤‡æ•°ã®ç”»åƒã‚’ã‚°ãƒªãƒƒãƒ‰å½¢å¼ã§è¡¨ç¤º",testimonial:"ç¤¾å“¡ã®å£°ã‚„ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼ã‚’æ²è¼‰",custom:"è‡ªç”±ãªãƒ†ã‚­ã‚¹ãƒˆã¨ç”»åƒã§ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ"};function rt(){const e=Object.entries(w).filter(([e])=>!w[e].required||x(e,We)).map(([e,t])=>{const n=!x(e,We),o=st[e]||"";return{id:e,name:t.name,description:o,icon:t.icon,iconBgColor:"#4AA7C0",disabled:n,disabledText:"è¿½åŠ æ¸ˆã¿"}});B({id:"lp-add-section-modal",title:"ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ",description:"è¿½åŠ ã—ãŸã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„",items:e,buttonText:"è¿½åŠ ã™ã‚‹",cancelText:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«",onSelect:e=>{mt(e)}})}function ct(){const e=document.getElementById("add-section-modal");e&&(e.style.display="none")}const dt=[{id:"video",name:"VIDEO",label:"å‹•ç”»",description:"å‹•ç”»ï¼ˆYouTubeã€Vimeoã€TikTokï¼‰ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã€æ±‚äººã‚„ä¼šç¤¾ã®é­…åŠ›ã‚’ä¼ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚",thumbnail:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 80"%3E%3Cdefs%3E%3ClinearGradient id="vidBg" x1="0%25" y1="0%25" x2="100%25" y2="100%25"%3E%3Cstop offset="0%25" stop-color="%23ef4444"/%3E%3Cstop offset="100%25" stop-color="%23dc2626"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="url(%23vidBg)" width="120" height="80" rx="4"/%3E%3Crect fill="%23000" opacity="0.3" x="15" y="15" width="90" height="50" rx="4"/%3E%3Ccircle fill="%23fff" opacity="0.9" cx="60" cy="40" r="15"/%3E%3Cpath fill="%23ef4444" d="M55 32 L55 48 L70 40 Z"/%3E%3C/svg%3E'},{id:"carousel",name:"CAROUSEL",label:"ç”»åƒã‚«ãƒ«ãƒ¼ã‚»ãƒ«",description:"è¤‡æ•°ã®ç”»åƒã‚’ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼å½¢å¼ã§è¡¨ç¤ºã§ãã¾ã™ã€‚è·å ´ã®æ§˜å­ã‚„ä»•äº‹é¢¨æ™¯ã‚’ã‚¢ãƒ”ãƒ¼ãƒ«ã§ãã¾ã™ã€‚",thumbnail:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 80"%3E%3Cdefs%3E%3ClinearGradient id="carBg" x1="0%25" y1="0%25" x2="100%25" y2="100%25"%3E%3Cstop offset="0%25" stop-color="%233b82f6"/%3E%3Cstop offset="100%25" stop-color="%232563eb"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="url(%23carBg)" width="120" height="80" rx="4"/%3E%3Crect fill="%23fff" opacity="0.2" x="25" y="12" width="70" height="45" rx="4"/%3E%3Ccircle fill="%23fff" opacity="0.6" cx="45" cy="28" r="8"/%3E%3Cpath fill="%23fff" opacity="0.5" d="M30 52 L50 32 L70 45 L90 35 L90 52 L30 52 Z"/%3E%3Crect fill="%23fff" opacity="0.4" x="8" y="20" width="12" height="30" rx="2"/%3E%3Crect fill="%23fff" opacity="0.4" x="100" y="20" width="12" height="30" rx="2"/%3E%3Cpath fill="%23fff" opacity="0.8" d="M12 32 L16 35 L12 38 Z"/%3E%3Cpath fill="%23fff" opacity="0.8" d="M108 32 L104 35 L108 38 Z"/%3E%3Ccircle fill="%23fff" opacity="0.5" cx="52" cy="65" r="3"/%3E%3Ccircle fill="%23fff" opacity="0.9" cx="60" cy="65" r="3"/%3E%3Ccircle fill="%23fff" opacity="0.5" cx="68" cy="65" r="3"/%3E%3C/svg%3E'},{id:"gallery",name:"GALLERY",label:"ç”»åƒã‚®ãƒ£ãƒ©ãƒªãƒ¼",description:"è¤‡æ•°ã®ç”»åƒã‚’ã‚°ãƒªãƒƒãƒ‰å½¢å¼ã§è¡¨ç¤ºã§ãã¾ã™ã€‚è·å ´ç’°å¢ƒã‚„ä»•äº‹ã®æ§˜å­ã‚’è¦‹ã›ã‚‰ã‚Œã¾ã™ã€‚",thumbnail:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 80"%3E%3Cdefs%3E%3ClinearGradient id="galBg" x1="0%25" y1="0%25" x2="100%25" y2="100%25"%3E%3Cstop offset="0%25" stop-color="%23f59e0b"/%3E%3Cstop offset="100%25" stop-color="%23d97706"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="url(%23galBg)" width="120" height="80" rx="4"/%3E%3Crect fill="%23fff" opacity="0.3" x="8" y="10" width="32" height="26" rx="3"/%3E%3Ccircle fill="%23fff" opacity="0.6" cx="18" cy="18" r="4"/%3E%3Cpath fill="%23fff" opacity="0.5" d="M12 32 L22 22 L32 28 L36 24 L36 32 L12 32 Z"/%3E%3Crect fill="%23fff" opacity="0.3" x="44" y="10" width="32" height="26" rx="3"/%3E%3Ccircle fill="%23fff" opacity="0.6" cx="54" cy="18" r="4"/%3E%3Cpath fill="%23fff" opacity="0.5" d="M48 32 L58 22 L68 28 L72 24 L72 32 L48 32 Z"/%3E%3Crect fill="%23fff" opacity="0.3" x="80" y="10" width="32" height="26" rx="3"/%3E%3Ccircle fill="%23fff" opacity="0.6" cx="90" cy="18" r="4"/%3E%3Cpath fill="%23fff" opacity="0.5" d="M84 32 L94 22 L104 28 L108 24 L108 32 L84 32 Z"/%3E%3Crect fill="%23fff" opacity="0.3" x="8" y="42" width="32" height="26" rx="3"/%3E%3Crect fill="%23fff" opacity="0.3" x="44" y="42" width="32" height="26" rx="3"/%3E%3Crect fill="%23fff" opacity="0.3" x="80" y="42" width="32" height="26" rx="3"/%3E%3C/svg%3E'},{id:"testimonial",name:"VOICE",label:"ç¤¾å“¡ã®å£°",description:"ç¤¾å“¡ã®å£°ã‚„ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼ã‚’æ²è¼‰ã§ãã¾ã™ã€‚å®Ÿéš›ã«åƒã„ã¦ã„ã‚‹äººã®å£°ã‚’å±Šã‘ã‚‰ã‚Œã¾ã™ã€‚",thumbnail:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 80"%3E%3Cdefs%3E%3ClinearGradient id="tstBg" x1="0%25" y1="0%25" x2="100%25" y2="100%25"%3E%3Cstop offset="0%25" stop-color="%2310b981"/%3E%3Cstop offset="100%25" stop-color="%23059669"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="url(%23tstBg)" width="120" height="80" rx="4"/%3E%3Ccircle fill="%23fff" opacity="0.3" cx="30" cy="32" r="16"/%3E%3Ccircle fill="%23fff" opacity="0.6" cx="30" cy="28" r="8"/%3E%3Cellipse fill="%23fff" opacity="0.4" cx="30" cy="42" rx="10" ry="6"/%3E%3Crect fill="%23fff" opacity="0.2" x="52" y="18" width="58" height="36" rx="4"/%3E%3Cpath fill="%23fff" opacity="0.3" d="M52 40 L46 48 L52 48 Z"/%3E%3Crect fill="%23fff" opacity="0.6" x="58" y="24" width="40" height="4" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="58" y="32" width="46" height="3" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="58" y="38" width="42" height="3" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="58" y="44" width="38" height="3" rx="1"/%3E%3Ccircle fill="%23fff" opacity="0.5" cx="30" cy="66" r="2"/%3E%3Ccircle fill="%23fff" opacity="0.9" cx="40" cy="66" r="2"/%3E%3Ccircle fill="%23fff" opacity="0.5" cx="50" cy="66" r="2"/%3E%3C/svg%3E'},{id:"custom",name:"CUSTOM",label:"ã‚«ã‚¹ã‚¿ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³",description:"è‡ªç”±ãªãƒ†ã‚­ã‚¹ãƒˆã¨ç”»åƒã§ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã§ãã¾ã™ã€‚",thumbnail:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 80"%3E%3Cdefs%3E%3ClinearGradient id="cstBg" x1="0%25" y1="0%25" x2="100%25" y2="100%25"%3E%3Cstop offset="0%25" stop-color="%238b5cf6"/%3E%3Cstop offset="100%25" stop-color="%237c3aed"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="url(%23cstBg)" width="120" height="80" rx="4"/%3E%3Crect fill="%23fff" opacity="0.2" x="8" y="12" width="48" height="56" rx="4"/%3E%3Crect fill="%23fff" opacity="0.6" x="14" y="18" width="36" height="4" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="14" y="26" width="32" height="3" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="14" y="32" width="36" height="3" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="14" y="38" width="28" height="3" rx="1"/%3E%3Crect fill="%23fff" opacity="0.3" x="14" y="48" width="36" height="14" rx="2"/%3E%3Ccircle fill="%23fff" opacity="0.5" cx="22" cy="52" r="3"/%3E%3Cpath fill="%23fff" opacity="0.4" d="M18 58 L26 50 L34 54 L42 48 L46 58 L18 58 Z"/%3E%3Crect fill="%23fff" opacity="0.2" x="64" y="12" width="48" height="56" rx="4"/%3E%3Crect fill="%23fff" opacity="0.3" x="70" y="18" width="36" height="24" rx="2"/%3E%3Ccircle fill="%23fff" opacity="0.5" cx="80" cy="26" r="5"/%3E%3Cpath fill="%23fff" opacity="0.4" d="M74 38 L86 26 L98 32 L102 28 L102 38 L74 38 Z"/%3E%3Crect fill="%23fff" opacity="0.5" x="70" y="48" width="30" height="3" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="70" y="54" width="36" height="2" rx="1"/%3E%3Crect fill="%23fff" opacity="0.4" x="70" y="58" width="32" height="2" rx="1"/%3E%3C/svg%3E'},{id:"heroCta",name:"CTA",label:"CTAãƒœã‚¿ãƒ³",description:"ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒ“ãƒ¥ãƒ¼å†…ã«CTAãƒœã‚¿ãƒ³ï¼ˆå¿œå‹Ÿãƒœã‚¿ãƒ³ãƒ»å‹•ç”»ãƒœã‚¿ãƒ³ï¼‰ã‚’è¿½åŠ ã§ãã¾ã™ã€‚",thumbnail:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 80"%3E%3Cdefs%3E%3ClinearGradient id="ctaBg" x1="0%25" y1="0%25" x2="100%25" y2="100%25"%3E%3Cstop offset="0%25" stop-color="%23ec4899"/%3E%3Cstop offset="100%25" stop-color="%23db2777"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="url(%23ctaBg)" width="120" height="80" rx="4"/%3E%3Crect fill="%23fff" opacity="0.95" x="20" y="28" width="80" height="24" rx="12"/%3E%3Crect fill="%23ec4899" x="28" y="36" width="64" height="8" rx="4"/%3E%3Cpath fill="%23fff" d="M84 40 L88 36 L88 44 Z"/%3E%3Crect fill="%23fff" opacity="0.4" x="35" y="60" width="50" height="6" rx="3"/%3E%3C/svg%3E'}];function ut(){const t=document.getElementById("lp-template-selector-modal");t&&t.remove();const n=`\n    <div id="lp-template-selector-modal" class="template-modal-overlay">\n      <div class="template-modal">\n        <div class="template-modal-header">\n          <h3>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¿½åŠ ã™ã‚‹</h3>\n          <button type="button" class="template-modal-close">&times;</button>\n        </div>\n        <div class="template-modal-body">\n          <p class="template-modal-description">è¿½åŠ ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>\n          <div class="template-list">\n            ${dt.map(t=>{const n=!x(t.id,We);return`\n              <div class="template-item ${n?"disabled":""}" data-template-id="${t.id}">\n                <div class="template-thumbnail">\n                  <img src='${t.thumbnail}' alt="${e(t.name)}">\n                </div>\n                <div class="template-info">\n                  <h4 class="template-name">${e(t.name)}ï¼ˆ${e(t.label)}ï¼‰</h4>\n                  <p class="template-description">${e(t.description)}</p>\n                </div>\n                <button type="button" class="btn-add-template" data-template-id="${t.id}" ${n?"disabled":""}>${n?"è¿½åŠ æ¸ˆã¿":"è¿½åŠ ã™ã‚‹"}</button>\n              </div>\n            `}).join("")}\n          </div>\n        </div>\n        <div class="template-modal-footer">\n          <button type="button" class="btn-template-cancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>\n        </div>\n      </div>\n    </div>\n  `;document.body.insertAdjacentHTML("beforeend",n);const o=document.getElementById("lp-template-selector-modal");o.querySelector(".template-modal-close").addEventListener("click",()=>{o.remove()}),o.querySelector(".btn-template-cancel").addEventListener("click",()=>{o.remove()}),o.addEventListener("click",e=>{e.target===o&&o.remove()}),o.querySelectorAll(".btn-add-template:not([disabled])").forEach(e=>{e.addEventListener("click",()=>{mt(e.dataset.templateId),o.remove()})})}function mt(e){const n=w[e];if(!n)return;if(!x(e,We))return void t(`${n.name}ã¯ã“ã‚Œä»¥ä¸Šè¿½åŠ ã§ãã¾ã›ã‚“`,"warning");let o;if(!["hero","points","jobs","details","faq","apply"].includes(e)){const e=We.find(e=>"apply"===e.type);e?(o=e.order,We.forEach(e=>{e.order>=o&&(e.order+=1)})):o=We.length}else o=We.length;const i={id:S(e),type:e,order:o,visible:!0,data:JSON.parse(JSON.stringify(n.defaultData)),layout:JSON.parse(JSON.stringify(n.defaultLayout))};We.push(i),vt(),at(),ft(i.id),St()}async function pt(e){var n;if(!C(e,We))return void t("ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯å‰Šé™¤ã§ãã¾ã›ã‚“","warning");const o=We.find(t=>t.id===e),i=(null==(n=w[null==o?void 0:o.type])?void 0:n.name)||(null==o?void 0:o.type);await q({title:"ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å‰Šé™¤",message:`ã€Œ${i}ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`,confirmText:"å‰Šé™¤ã™ã‚‹",cancelText:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«",danger:!0})&&(We=We.filter(t=>t.id!==e),vt(),at(),St())}function yt(e){const t=We.find(t=>t.id===e);t&&(t.visible=!t.visible,at(),St())}function vt(){We.sort((e,t)=>(e.order||0)-(t.order||0)),We.forEach((e,t)=>{e.order=t})}function ft(t){if(Qe=We.find(e=>e.id===t),!Qe)return void console.log("[openSectionEditor] Section not found:",t);console.log("[openSectionEditor] Opening editor for:",Qe.type,Qe);const n=document.getElementById("section-editor-modal"),o=document.getElementById("section-editor-title"),i=document.getElementById("section-editor-content"),a=document.getElementById("section-delete-btn");if(!n||!i)return void console.error("[openSectionEditor] Modal or content element not found");const l=w[Qe.type];console.log("[openSectionEditor] Type config:",l),o.textContent=`${(null==l?void 0:l.name)||Qe.type}ã‚’ç·¨é›†`,a&&(a.style.display=(null==l?void 0:l.required)?"none":"inline-block");const s=function(t){switch(console.log("[renderSectionEditorContent] Rendering editor for type:",t.type),t.type){case"hero":return function(t){var n,o,i,a;return`\n    <div class="editor-section">\n      <div class="form-group">\n        <label for="editor-hero-title">ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-hero-title" value="${e((null==(n=t.data)?void 0:n.title)||"")}" placeholder="ä¾‹: æœˆå32ä¸‡å††ä»¥ä¸Šå¯ï¼å…¥ç¤¾ç‰¹å…¸ã‚ã‚Š">\n      </div>\n      <div class="form-group">\n        <label for="editor-hero-subtitle">ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-hero-subtitle" value="${e((null==(o=t.data)?void 0:o.subtitle)||"")}" placeholder="ä¾‹: æœªçµŒé¨“è€…æ­“è¿ï¼å……å®Ÿã®ç ”ä¿®åˆ¶åº¦">\n      </div>\n      <div class="form-group">\n        <label>èƒŒæ™¯ç”»åƒ</label>\n        <div id="hero-image-uploader-container" data-current-url="${e((null==(i=t.data)?void 0:i.image)||"")}"></div>\n        <input type="hidden" id="editor-hero-image" value="${e((null==(a=t.data)?void 0:a.image)||"")}">\n      </div>\n    </div>\n  `}(t);case"points":return function(e){var t,n,o,i;const a=(null==(t=e.data)?void 0:t.points)||[];return`\n    <div class="editor-section">\n      <h4>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š</h4>\n      <div class="form-group">\n        <label for="editor-points-columns">ã‚«ãƒ©ãƒ æ•°</label>\n        <select id="editor-points-columns">\n          <option value="2" ${2===(null==(n=e.layout)?void 0:n.columns)?"selected":""}>2åˆ—</option>\n          <option value="3" ${3===(null==(o=e.layout)?void 0:o.columns)?"selected":""}>3åˆ—</option>\n          <option value="4" ${4===(null==(i=e.layout)?void 0:i.columns)?"selected":""}>4åˆ—</option>\n        </select>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ãƒã‚¤ãƒ³ãƒˆä¸€è¦§</h4>\n      <div id="editor-points-list" class="editor-items-list">\n        ${a.map((e,t)=>bt(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-point" class="btn-add-item">\n        <span>+</span> ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"faq":return function(e){var t;const n=(null==(t=e.data)?void 0:t.items)||[];return`\n    <div class="editor-section">\n      <h4>ã‚ˆãã‚ã‚‹è³ªå•</h4>\n      <div id="editor-faq-list" class="editor-items-list">\n        ${n.map((e,t)=>Et(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-faq" class="btn-add-item">\n        <span>+</span> Q&Aã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"custom":return function(t){var n,o,i,a,l,s,r,c,d,u,m,p;const y=(null==(n=t.layout)?void 0:n.variant)||"text-only",v=!!(null==(o=t.data)?void 0:o.button),f={"text-only":'\n      <div class="layout-preview text-only">\n        <div class="preview-text-block">\n          <div class="preview-line"></div>\n          <div class="preview-line medium"></div>\n          <div class="preview-line short"></div>\n        </div>\n      </div>\n    ',"image-only":'\n      <div class="layout-preview image-only">\n        <div class="preview-image-block">\n          <span class="preview-image-icon">ğŸ–¼ï¸</span>\n        </div>\n      </div>\n    ',"text-left-image-right":'\n      <div class="layout-preview text-left-image-right">\n        <div class="preview-text-block">\n          <div class="preview-line"></div>\n          <div class="preview-line medium"></div>\n          <div class="preview-line short"></div>\n        </div>\n        <div class="preview-image-block"></div>\n      </div>\n    ',"text-right-image-left":'\n      <div class="layout-preview text-right-image-left">\n        <div class="preview-text-block">\n          <div class="preview-line"></div>\n          <div class="preview-line medium"></div>\n          <div class="preview-line short"></div>\n        </div>\n        <div class="preview-image-block"></div>\n      </div>\n    ',"centered-with-button":'\n      <div class="layout-preview centered-with-button">\n        <div class="preview-text-block">\n          <div class="preview-line"></div>\n          <div class="preview-line short"></div>\n        </div>\n        <div class="preview-button"></div>\n      </div>\n    ',"full-width-banner":'\n      <div class="layout-preview full-width-banner">\n        <div class="preview-overlay">\n          <div class="preview-line" style="width:50%"></div>\n          <div class="preview-line short" style="width:30%"></div>\n        </div>\n      </div>\n    '};return`\n    <div class="editor-section">\n      <h4>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</h4>\n      <p class="form-hint" style="margin-bottom:12px;">è¡¨ç¤ºå½¢å¼ã‚’é¸æŠã—ã¦ãã ã•ã„</p>\n      <div class="layout-card-selector">\n        ${Object.entries(I).map(([e,t])=>`\n          <label class="layout-card">\n            <input type="radio" name="custom-variant" value="${e}" ${y===e?"checked":""}>\n            <div class="layout-card-content">\n              ${f[e]||""}\n              <div class="layout-card-label">\n                <span class="layout-card-name">${t.name}</span>\n                <span class="layout-check">\n                  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>\n                </span>\n              </div>\n            </div>\n          </label>\n        `).join("")}\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h4>\n      <div class="form-group">\n        <label for="editor-custom-title">ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-custom-title" value="${e((null==(i=t.data)?void 0:i.title)||"")}" placeholder="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›">\n      </div>\n      <div class="form-group">\n        <label>æœ¬æ–‡</label>\n        <div class="rich-editor-container">\n          <div class="rich-editor-toolbar">\n            <button type="button" class="toolbar-btn" data-command="bold" title="å¤ªå­— (Ctrl+B)">\n              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"/></svg>\n            </button>\n            <button type="button" class="toolbar-btn" data-command="italic" title="æ–œä½“ (Ctrl+I)">\n              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"/></svg>\n            </button>\n            <span class="toolbar-divider"></span>\n            <button type="button" class="toolbar-btn" data-command="removeFormat" title="æ›¸å¼ã‚’ã‚¯ãƒªã‚¢">\n              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3.27 5L2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21 18 19.73 3.55 5.27 3.27 5zM6 5v.18L8.82 8h2.4l-.72 1.68 2.1 2.1L14.21 8H20V5H6z"/></svg>\n            </button>\n            <span class="toolbar-hint">é¸æŠã—ã¦ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</span>\n          </div>\n          <div id="editor-custom-content" class="rich-editor-content" contenteditable="true" data-placeholder="æœ¬æ–‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...">${(null==(a=t.data)?void 0:a.content)||""}</div>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <div class="image-section-card" id="custom-image-field">\n        <div class="section-label">\n          <span class="section-label-icon">ğŸ–¼ï¸</span>\n          <span>ç”»åƒ</span>\n        </div>\n        <div id="custom-image-uploader-container" data-current-url="${e((null==(l=t.data)?void 0:l.image)||"")}"></div>\n        <input type="hidden" id="editor-custom-image" value="${e((null==(s=t.data)?void 0:s.image)||"")}">\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <div class="button-section-card">\n        <div class="section-label">\n          <span class="section-label-icon">ğŸ”˜</span>\n          <span>ãƒœã‚¿ãƒ³</span>\n        </div>\n        <div class="button-toggle-row">\n          <div class="toggle-label">\n            <span class="toggle-label-icon">ğŸ‘†</span>\n            <span>ãƒœã‚¿ãƒ³ã‚’è¿½åŠ </span>\n          </div>\n          <label class="toggle-switch">\n            <input type="checkbox" id="editor-custom-has-button" ${v?"checked":""}>\n            <span class="toggle-slider"></span>\n          </label>\n        </div>\n        <div id="button-fields" class="button-fields" style="${v?"":"display:none"}">\n          <div class="form-group">\n            <label for="editor-button-text">ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</label>\n            <input type="text" id="editor-button-text" value="${e((null==(c=null==(r=t.data)?void 0:r.button)?void 0:c.text)||"")}" placeholder="ä¾‹: è©³ã—ãè¦‹ã‚‹">\n          </div>\n          <div class="form-group">\n            <label for="editor-button-url">ãƒªãƒ³ã‚¯å…ˆURL</label>\n            <input type="text" id="editor-button-url" value="${e((null==(u=null==(d=t.data)?void 0:d.button)?void 0:u.url)||"#")}" placeholder="https://...">\n          </div>\n          <div class="button-preview" id="button-preview">\n            <div class="button-preview-label">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>\n            <span class="preview-btn">${e((null==(p=null==(m=t.data)?void 0:m.button)?void 0:p.text)||"ãƒœã‚¿ãƒ³")}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}(t);case"gallery":return function(t){var n,o,i,a,l,s,r,c;const d=(null==(n=t.data)?void 0:n.images)||[];return`\n    <div class="editor-section">\n      <h4>è¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-gallery-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n          <input type="text" id="editor-gallery-title" value="${e((null==(o=t.data)?void 0:o.sectionTitle)||"")}">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-gallery-columns">ã‚«ãƒ©ãƒ æ•°</label>\n          <select id="editor-gallery-columns">\n            <option value="2" ${2===(null==(i=t.layout)?void 0:i.columns)?"selected":""}>2åˆ—</option>\n            <option value="3" ${3===(null==(a=t.layout)?void 0:a.columns)?"selected":""}>3åˆ—</option>\n            <option value="4" ${4===(null==(l=t.layout)?void 0:l.columns)?"selected":""}>4åˆ—</option>\n          </select>\n        </div>\n        <div class="form-group">\n          <label for="editor-gallery-style">ã‚¹ã‚¿ã‚¤ãƒ«</label>\n          <select id="editor-gallery-style">\n            <option value="grid" ${"grid"===(null==(s=t.layout)?void 0:s.style)?"selected":""}>ã‚°ãƒªãƒƒãƒ‰</option>\n            <option value="masonry" ${"masonry"===(null==(r=t.layout)?void 0:r.style)?"selected":""}>ãƒ¡ã‚¤ã‚½ãƒ³ãƒªãƒ¼</option>\n            <option value="slider" ${"slider"===(null==(c=t.layout)?void 0:c.style)?"selected":""}>ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ç”»åƒä¸€è¦§</h4>\n      <div id="editor-gallery-list" class="editor-items-list gallery-items">\n        ${d.map((e,t)=>wt(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-gallery-image" class="btn-add-item">\n        <span>+</span> ç”»åƒã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"testimonial":return function(t){var n,o,i,a,l;const s=(null==(n=t.data)?void 0:n.testimonials)||[];return`\n    <div class="editor-section">\n      <h4>è¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-testimonial-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n          <input type="text" id="editor-testimonial-title" value="${e((null==(o=t.data)?void 0:o.sectionTitle)||"ç¤¾å“¡ã®å£°")}">\n        </div>\n        <div class="form-group">\n          <label for="editor-testimonial-style">ã‚¹ã‚¿ã‚¤ãƒ«</label>\n          <select id="editor-testimonial-style">\n            <option value="cards" ${"cards"===(null==(i=t.layout)?void 0:i.style)?"selected":""}>ã‚«ãƒ¼ãƒ‰</option>\n            <option value="list" ${"list"===(null==(a=t.layout)?void 0:a.style)?"selected":""}>ãƒªã‚¹ãƒˆ</option>\n            <option value="slider" ${"slider"===(null==(l=t.layout)?void 0:l.style)?"selected":""}>ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ç¤¾å“¡ä¸€è¦§</h4>\n      <div id="editor-testimonial-list" class="editor-items-list">\n        ${s.map((e,t)=>It(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-testimonial" class="btn-add-item">\n        <span>+</span> ç¤¾å“¡ã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"carousel":return console.log("[renderSectionEditorContent] Rendering carousel editor"),function(t){var n,o,i,a,l,s;const r=(null==(n=t.data)?void 0:n.images)||[],c=!1!==(null==(o=t.data)?void 0:o.autoPlay),d=(null==(i=t.data)?void 0:i.interval)||5e3;return`\n    <div class="editor-section">\n      <h4>è¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-carousel-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n          <input type="text" id="editor-carousel-title" value="${e((null==(a=t.data)?void 0:a.sectionTitle)||"")}">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-carousel-autoplay" ${c?"checked":""}>\n            è‡ªå‹•å†ç”Ÿ\n          </label>\n        </div>\n        <div class="form-group">\n          <label for="editor-carousel-interval">åˆ‡æ›¿é–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰</label>\n          <input type="number" id="editor-carousel-interval" value="${d}" min="1000" step="500">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-carousel-dots" ${!1!==(null==(l=t.layout)?void 0:l.showDots)?"checked":""}>\n            ãƒ‰ãƒƒãƒˆè¡¨ç¤º\n          </label>\n        </div>\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-carousel-arrows" ${!1!==(null==(s=t.layout)?void 0:s.showArrows)?"checked":""}>\n            çŸ¢å°è¡¨ç¤º\n          </label>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ç”»åƒä¸€è¦§ ${r.length>0?`<span style="font-weight:normal;color:#6b7280;font-size:13px;">(${r.length}æš)</span>`:""}</h4>\n      ${0===r.length?'\n        <div class="carousel-empty-state">\n          <div class="carousel-empty-icon">ğŸ–¼ï¸</div>\n          <div class="carousel-empty-title">ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“</div>\n          <div class="carousel-empty-desc">ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰ç”»åƒã‚’è¿½åŠ ã—ã¦ãã ã•ã„</div>\n        </div>\n      ':""}\n      <div id="editor-carousel-list" class="editor-items-list carousel-items">\n        ${r.map((e,t)=>xt(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-carousel-image" class="btn-add-item">\n        <span>+</span> ç”»åƒã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"video":return console.log("[renderSectionEditorContent] Rendering video editor"),function(t){var n,o,i,a,l,s;const r=(null==(n=t.data)?void 0:n.videoUrl)||"",c=(null==(o=t.data)?void 0:o.videoType)||"youtube",d=(null==(i=t.data)?void 0:i.description)||"",u=(null==(a=t.layout)?void 0:a.aspectRatio)||"16:9",m=(null==(l=t.layout)?void 0:l.fullWidth)||!1;return`\n    <div class="editor-section">\n      <h4>å‹•ç”»è¨­å®š</h4>\n      <div class="form-group">\n        <label for="editor-video-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-video-title" value="${e((null==(s=t.data)?void 0:s.sectionTitle)||"")}">\n      </div>\n      <div class="form-group">\n        <label for="editor-video-url">å‹•ç”»URL</label>\n        <input type="url" id="editor-video-url" value="${e(r)}" placeholder="https://www.youtube.com/watch?v=xxxxx">\n        <p class="form-hint">YouTube, Vimeo, ã¾ãŸã¯ç›´æ¥å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®URLã‚’å…¥åŠ›</p>\n      </div>\n      <div class="form-group">\n        <label for="editor-video-type">å‹•ç”»ã‚¿ã‚¤ãƒ—</label>\n        <select id="editor-video-type">\n          <option value="youtube" ${"youtube"===c?"selected":""}>YouTube</option>\n          <option value="vimeo" ${"vimeo"===c?"selected":""}>Vimeo</option>\n          <option value="tiktok" ${"tiktok"===c?"selected":""}>TikTok</option>\n          <option value="direct" ${"direct"===c?"selected":""}>ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆMP4ç­‰ï¼‰</option>\n          <option value="iframe" ${"iframe"===c?"selected":""}>ãã®ä»–ï¼ˆiframeï¼‰</option>\n        </select>\n      </div>\n      <div class="form-group">\n        <label for="editor-video-description">èª¬æ˜æ–‡ï¼ˆä»»æ„ï¼‰</label>\n        <textarea id="editor-video-description" rows="2" placeholder="å‹•ç”»ã®èª¬æ˜æ–‡">${e(d)}</textarea>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>è¡¨ç¤ºè¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-video-aspect">ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”</label>\n          <select id="editor-video-aspect">\n            <option value="16:9" ${"16:9"===u?"selected":""}>16:9ï¼ˆæ¨ªé•·ï¼‰</option>\n            <option value="4:3" ${"4:3"===u?"selected":""}>4:3ï¼ˆæ¨™æº–ï¼‰</option>\n            <option value="1:1" ${"1:1"===u?"selected":""}>1:1ï¼ˆæ­£æ–¹å½¢ï¼‰</option>\n            <option value="9:16" ${"9:16"===u?"selected":""}>9:16ï¼ˆç¸¦é•·ï¼‰</option>\n          </select>\n        </div>\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-video-fullwidth" ${m?"checked":""}>\n            å…¨å¹…è¡¨ç¤º\n          </label>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h4>\n      <div id="editor-video-preview" class="video-preview">\n        ${r?$t(r,c):'<p class="preview-empty">URLã‚’å…¥åŠ›ã™ã‚‹ã¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>'}\n      </div>\n    </div>\n  `}(t);case"jobs":case"details":case"apply":return function(e){const t=w[e.type];return`\n    <div class="editor-section">\n      <p class="editor-info">\n        ã€Œ${(null==t?void 0:t.name)||e.type}ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ã‚„æ±‚äººãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚<br>\n        è¡¨ç¤º/éè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆã¨ä¸¦ã³é †ã®å¤‰æ›´ã®ã¿å¯èƒ½ã§ã™ã€‚\n      </p>\n    </div>\n  `}(t);default:return console.log("[renderSectionEditorContent] Unknown type, returning default"),"<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ç·¨é›†ã§ãã¾ã›ã‚“</p>"}}(Qe);console.log("[openSectionEditor] Editor HTML length:",null==s?void 0:s.length),i.innerHTML=s,function(){tt={},function(){const e=document.getElementById("hero-image-uploader-container");if(!e)return;const t=e.dataset.currentUrl||"",n=document.getElementById("editor-hero-image"),o=(null==et?void 0:et())||"default",i=p({id:"hero-image-uploader",label:"",currentUrl:t,uploadFn:e=>y(e,o),onUpload:e=>{n&&(n.value=e),Qe&&(Qe.data.image=e),St()}});e.innerHTML="",e.appendChild(i),tt.hero=i}(),function(){const e=document.getElementById("custom-image-uploader-container");if(!e)return;const t=e.dataset.currentUrl||"",n=document.getElementById("editor-custom-image"),o=(null==et?void 0:et())||"default",i=p({id:"custom-image-uploader",label:"",currentUrl:t,uploadFn:e=>y(e,o),onUpload:e=>{n&&(n.value=e),Qe&&(Qe.data.image=e),St()}});e.innerHTML="",e.appendChild(i),tt.custom=i}(),function(){const e=document.getElementById("editor-gallery-list");if(!e)return;const t=(null==et?void 0:et())||"default";e.querySelectorAll(".gallery-item").forEach((e,n)=>{const o=e.querySelector(".gallery-image-uploader-container");if(!o)return;const i=o.dataset.currentUrl||"",a=e.querySelector(".gallery-url"),l=p({id:`gallery-image-uploader-${n}`,label:"",currentUrl:i,uploadFn:e=>y(e,t),onUpload:e=>{a&&(a.value=e),St()}});o.innerHTML="",o.appendChild(l),tt[`gallery-${n}`]=l})}();const e=document.getElementById("editor-add-point");e&&e.addEventListener("click",()=>{const e=document.getElementById("editor-points-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",bt({title:"",description:""},t)),Ct()});const t=document.getElementById("editor-add-faq");t&&t.addEventListener("click",()=>{const e=document.getElementById("editor-faq-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",Et({question:"",answer:""},t)),Ct()});const n=document.getElementById("editor-add-gallery-image");n&&n.addEventListener("click",()=>{const e=document.getElementById("editor-gallery-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",wt("",t)),Ct(),function(e){const t=document.getElementById("editor-gallery-list");if(!t)return;const n=t.querySelectorAll(".gallery-item")[e];if(!n)return;const o=n.querySelector(".gallery-image-uploader-container");if(!o)return;const i=o.dataset.currentUrl||"",a=n.querySelector(".gallery-url"),l=(null==et?void 0:et())||"default",s=p({id:`gallery-image-uploader-${e}`,label:"",currentUrl:i,uploadFn:e=>y(e,l),onUpload:e=>{a&&(a.value=e),St()}});o.innerHTML="",o.appendChild(s),tt[`gallery-${e}`]=s}(t)});const o=document.getElementById("editor-add-testimonial");o&&o.addEventListener("click",()=>{const e=document.getElementById("editor-testimonial-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",It({name:"",role:"",quote:""},t)),Ct()});const i=document.getElementById("editor-add-carousel-image");i&&i.addEventListener("click",()=>{const e=document.getElementById("editor-carousel-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",xt("",t)),Ct(),function(e){const t=document.getElementById("editor-carousel-list");if(!t)return;const n=t.querySelectorAll(".carousel-item")[e];if(!n)return;const o=n.querySelector(".carousel-image-uploader-container");if(!o)return;const i=o.dataset.currentUrl||"",a=n.querySelector(".carousel-url"),l=(null==et?void 0:et())||"default",s=p({id:`carousel-image-uploader-${e}`,label:"",currentUrl:i,uploadFn:e=>y(e,l),onUpload:e=>{a&&(a.value=e),St()}});o.innerHTML="",o.appendChild(s),tt[`carousel-${e}`]=s}(t)});!function(){const e=document.getElementById("editor-carousel-list");if(!e)return;const t=(null==et?void 0:et())||"default";e.querySelectorAll(".carousel-item").forEach((e,n)=>{const o=e.querySelector(".carousel-image-uploader-container");if(!o)return;const i=o.dataset.currentUrl||"",a=e.querySelector(".carousel-url"),l=p({id:`carousel-image-uploader-${n}`,label:"",currentUrl:i,uploadFn:e=>y(e,t),onUpload:e=>{a&&(a.value=e),St()}});o.innerHTML="",o.appendChild(l),tt[`carousel-${n}`]=l})}();const a=document.getElementById("editor-video-url"),l=document.getElementById("editor-video-type");a&&a.addEventListener("input",()=>{Lt()});l&&l.addEventListener("change",()=>{Lt()});const s=document.getElementById("editor-custom-has-button");s&&s.addEventListener("change",()=>{const e=document.getElementById("button-fields");e&&(e.style.display=s.checked?"":"none")});const r=document.getElementById("editor-button-text");r&&r.addEventListener("input",()=>{const e=document.querySelector("#button-preview .preview-btn");e&&(e.textContent=r.value||"ãƒœã‚¿ãƒ³")});document.querySelectorAll(".rich-editor-toolbar .toolbar-btn").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.dataset.command;if(n){document.execCommand(n,!1,null);const e=document.getElementById("editor-custom-content");e&&e.focus()}})}),document.querySelectorAll('input[name="custom-variant"]').forEach(e=>{e.addEventListener("change",()=>{document.querySelectorAll(".variant-option").forEach(e=>{e.classList.toggle("selected",e.querySelector("input").checked)})})}),Ct()}(),n.style.display="flex"}function gt(){const e=document.getElementById("section-editor-modal");e&&(e.style.display="none"),Qe=null}function ht(){Qe&&(!function(){var e,t,n,o,i,a,l,s,r,c,d,u,m,p,y,v,f,g,h,b,E,w,I,x,$,C,S;if(!Qe)return;switch(Qe.type){case"hero":Qe.data.title=(null==(e=document.getElementById("editor-hero-title"))?void 0:e.value)||"",Qe.data.subtitle=(null==(t=document.getElementById("editor-hero-subtitle"))?void 0:t.value)||"",Qe.data.image=(null==(n=document.getElementById("editor-hero-image"))?void 0:n.value)||"";break;case"points":Qe.layout.columns=parseInt((null==(o=document.getElementById("editor-points-columns"))?void 0:o.value)||"3"),Qe.data.points=function(){const e=[];return document.querySelectorAll("#editor-points-list .editor-item").forEach((t,n)=>{var o,i;const a=(null==(o=t.querySelector(".point-title"))?void 0:o.value)||"",l=(null==(i=t.querySelector(".point-desc"))?void 0:i.value)||"";(a||l)&&e.push({id:`p${n+1}`,title:a,description:l})}),e}();break;case"faq":Qe.data.items=function(){const e=[];return document.querySelectorAll("#editor-faq-list .editor-item").forEach((t,n)=>{var o,i;const a=(null==(o=t.querySelector(".faq-question"))?void 0:o.value)||"",l=(null==(i=t.querySelector(".faq-answer"))?void 0:i.value)||"";a&&l&&e.push({id:`faq-${n+1}`,question:a,answer:l})}),e}();break;case"custom":Qe.layout.variant=(null==(i=document.querySelector('input[name="custom-variant"]:checked'))?void 0:i.value)||"text-only",Qe.data.title=(null==(a=document.getElementById("editor-custom-title"))?void 0:a.value)||"",Qe.data.content=(null==(l=document.getElementById("editor-custom-content"))?void 0:l.innerHTML)||"",Qe.data.image=(null==(s=document.getElementById("editor-custom-image"))?void 0:s.value)||"";const L=null==(r=document.getElementById("editor-custom-has-button"))?void 0:r.checked;Qe.data.button=L?{text:(null==(c=document.getElementById("editor-button-text"))?void 0:c.value)||"",url:(null==(d=document.getElementById("editor-button-url"))?void 0:d.value)||"#",style:"primary"}:null;break;case"gallery":Qe.layout.columns=parseInt((null==(u=document.getElementById("editor-gallery-columns"))?void 0:u.value)||"3"),Qe.layout.style=(null==(m=document.getElementById("editor-gallery-style"))?void 0:m.value)||"grid",Qe.data.sectionTitle=(null==(p=document.getElementById("editor-gallery-title"))?void 0:p.value)||"",Qe.data.images=function(){const e=[];return document.querySelectorAll("#editor-gallery-list .editor-item").forEach(t=>{var n,o;const i=(null==(n=t.querySelector(".gallery-url"))?void 0:n.value)||"",a=(null==(o=t.querySelector(".gallery-caption"))?void 0:o.value)||"";i&&e.push({url:i,caption:a})}),e}();break;case"testimonial":Qe.layout.style=(null==(y=document.getElementById("editor-testimonial-style"))?void 0:y.value)||"cards",Qe.data.sectionTitle=(null==(v=document.getElementById("editor-testimonial-title"))?void 0:v.value)||"ç¤¾å“¡ã®å£°",Qe.data.testimonials=function(){const e=[];return document.querySelectorAll("#editor-testimonial-list .editor-item").forEach(t=>{var n,o,i,a;const l=(null==(n=t.querySelector(".testimonial-name"))?void 0:n.value)||"",s=(null==(o=t.querySelector(".testimonial-role"))?void 0:o.value)||"",r=(null==(i=t.querySelector(".testimonial-quote"))?void 0:i.value)||"",c=(null==(a=t.querySelector(".testimonial-avatar"))?void 0:a.value)||"";(l||r)&&e.push({name:l,role:s,quote:r,avatar:c})}),e}();break;case"carousel":Qe.data.sectionTitle=(null==(f=document.getElementById("editor-carousel-title"))?void 0:f.value)||"",Qe.data.autoPlay=(null==(g=document.getElementById("editor-carousel-autoplay"))?void 0:g.checked)??!0,Qe.data.interval=parseInt((null==(h=document.getElementById("editor-carousel-interval"))?void 0:h.value)||"5000"),Qe.layout.showDots=(null==(b=document.getElementById("editor-carousel-dots"))?void 0:b.checked)??!0,Qe.layout.showArrows=(null==(E=document.getElementById("editor-carousel-arrows"))?void 0:E.checked)??!0,Qe.data.images=function(){const e=[];return document.querySelectorAll("#editor-carousel-list .editor-item").forEach(t=>{var n,o,i;const a=(null==(n=t.querySelector(".carousel-url"))?void 0:n.value)||"",l=(null==(o=t.querySelector(".carousel-caption"))?void 0:o.value)||"",s=(null==(i=t.querySelector(".carousel-alt"))?void 0:i.value)||"";a&&e.push({url:a,caption:l,alt:s})}),e}();break;case"video":Qe.data.sectionTitle=(null==(w=document.getElementById("editor-video-title"))?void 0:w.value)||"",Qe.data.videoUrl=(null==(I=document.getElementById("editor-video-url"))?void 0:I.value)||"",Qe.data.videoType=(null==(x=document.getElementById("editor-video-type"))?void 0:x.value)||"youtube",Qe.data.description=(null==($=document.getElementById("editor-video-description"))?void 0:$.value)||"",Qe.layout.aspectRatio=(null==(C=document.getElementById("editor-video-aspect"))?void 0:C.value)||"16:9",Qe.layout.fullWidth=(null==(S=document.getElementById("editor-video-fullwidth"))?void 0:S.checked)||!1}}(),at(),St(),gt())}function bt(t,n){return`\n    <div class="editor-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>ãƒã‚¤ãƒ³ãƒˆ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" class="point-title" value="${e(t.title||"")}">\n      </div>\n      <div class="form-group">\n        <label>èª¬æ˜</label>\n        <textarea class="point-desc" rows="2">${e(t.description||"")}</textarea>\n      </div>\n    </div>\n  `}function Et(t,n){return`\n    <div class="editor-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>Q&A ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>è³ªå•</label>\n        <input type="text" class="faq-question" value="${e(t.question||"")}">\n      </div>\n      <div class="form-group">\n        <label>å›ç­”</label>\n        <textarea class="faq-answer" rows="3">${e(t.answer||"")}</textarea>\n      </div>\n    </div>\n  `}function wt(t,n){const o="string"==typeof t?t:t.url,i="object"==typeof t?t.caption:"";return`\n    <div class="editor-item gallery-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>ç”»åƒ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>ç”»åƒ</label>\n        <div class="gallery-image-uploader-container" data-current-url="${e(o||"")}"></div>\n        <input type="hidden" class="gallery-url" value="${e(o||"")}">\n      </div>\n      <div class="form-group">\n        <label>ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="gallery-caption" value="${e(i||"")}">\n      </div>\n    </div>\n  `}function It(t,n){return`\n    <div class="editor-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>ç¤¾å“¡ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label>åå‰</label>\n          <input type="text" class="testimonial-name" value="${e(t.name||"")}">\n        </div>\n        <div class="form-group">\n          <label>å½¹è·ãƒ»éƒ¨ç½²</label>\n          <input type="text" class="testimonial-role" value="${e(t.role||"")}">\n        </div>\n      </div>\n      <div class="form-group">\n        <label>ã‚³ãƒ¡ãƒ³ãƒˆ</label>\n        <textarea class="testimonial-quote" rows="3">${e(t.quote||"")}</textarea>\n      </div>\n      <div class="form-group">\n        <label>å†™çœŸURLï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="testimonial-avatar" value="${e(t.avatar||"")}">\n      </div>\n    </div>\n  `}function xt(t,n){const o="string"==typeof t?t:t.url,i="object"==typeof t?t.caption:"",a="object"==typeof t?t.alt:"";return`\n    <div class="editor-item carousel-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span class="item-number">${n+1}</span>\n        <span style="flex:1;">ç”»åƒ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>ç”»åƒ</label>\n        <div class="carousel-image-uploader-container" data-current-url="${e(o||"")}"></div>\n        <input type="hidden" class="carousel-url" value="${e(o||"")}">\n      </div>\n      <div class="form-group">\n        <label>ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="carousel-caption" value="${e(i||"")}" placeholder="ç”»åƒã®èª¬æ˜æ–‡">\n      </div>\n      <div class="form-group">\n        <label>ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="carousel-alt" value="${e(a||"")}" placeholder="ç”»åƒãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã®ãƒ†ã‚­ã‚¹ãƒˆ">\n      </div>\n    </div>\n  `}function $t(t,n){if(!t)return"";if("youtube"===n||t.includes("youtube.com")||t.includes("youtu.be")){const n=function(e){let t=e.match(/[?&]v=([^&]+)/);return t?t[1]:(t=e.match(/youtu\.be\/([^?&]+)/),t?t[1]:(t=e.match(/youtube\.com\/embed\/([^?&]+)/),t?t[1]:(t=e.match(/youtube\.com\/shorts\/([^?&]+)/),t?t[1]:null)))}(t);if(n)return`\n        <div class="video-preview-card video-preview-youtube">\n          <div class="video-preview-icon">â–¶ï¸</div>\n          <div class="video-preview-info">\n            <span class="video-preview-type">YouTube</span>\n            <span class="video-preview-id">ID: ${e(n)}</span>\n          </div>\n        </div>\n      `}return"vimeo"===n||t.includes("vimeo.com")?`\n      <div class="video-preview-card video-preview-vimeo">\n        <div class="video-preview-icon">â–¶ï¸</div>\n        <div class="video-preview-info">\n          <span class="video-preview-type">Vimeo</span>\n          <span class="video-preview-url">${e(t.substring(0,50))}...</span>\n        </div>\n      </div>\n    `:"tiktok"===n||t.includes("tiktok.com")?`\n      <div class="video-preview-card video-preview-tiktok">\n        <div class="video-preview-icon">ğŸµ</div>\n        <div class="video-preview-info">\n          <span class="video-preview-type">TikTok</span>\n          <span class="video-preview-url">${e(t.substring(0,50))}...</span>\n        </div>\n      </div>\n    `:`\n    <div class="video-preview-card video-preview-other">\n      <div class="video-preview-icon">ğŸ¬</div>\n      <div class="video-preview-info">\n        <span class="video-preview-type">å‹•ç”»</span>\n        <span class="video-preview-url">${e(t.substring(0,50))}${t.length>50?"...":""}</span>\n      </div>\n    </div>\n  `}function Ct(){document.querySelectorAll(".btn-remove-item").forEach(e=>{e.onclick=e=>{const t=e.target.closest(".editor-item");if(t){t.remove();const e=t.parentElement||document.querySelector(".editor-items-list");e&&e.querySelectorAll(".editor-item").forEach((e,t)=>{e.dataset.index=t;const n=e.querySelector(".editor-item-header span:nth-child(2)");n&&(n.textContent=n.textContent.replace(/\d+/,t+1))})}}})}function St(){"function"==typeof Xe&&Xe()}function Lt(){const e=document.getElementById("editor-video-preview"),t=document.getElementById("editor-video-url"),n=document.getElementById("editor-video-type");if(!e||!t)return;const o=t.value.trim(),i=(null==n?void 0:n.value)||"youtube";e.innerHTML=o?$t(o,i):'<p class="preview-empty">URLã‚’å…¥åŠ›ã™ã‚‹ã¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>'}const Bt={modern:{primary:"#0984e3",accent:"#74b9ff",bg:"#f8fafc",text:"#2d3436"},athome:{primary:"#e67e22",accent:"#f39c12",bg:"#fef9f3",text:"#5d4037"},cute:{primary:"#ff8fa3",accent:"#fab1a0",bg:"#fff5f7",text:"#6d4c41"},trust:{primary:"#0077c2",accent:"#4ea8de",bg:"#f0f8ff",text:"#1a2a3a"},kenchiku:{primary:"#f39c12",accent:"#e67e22",bg:"#f5f5f5",text:"#2c3e50"}};let qt=null;let At=!1,Tt=[],kt=null,Dt=[],jt=null,Mt=null;function Pt(t){const n=document.getElementById("lp-company-grid");n&&(0!==t.length?(n.innerHTML=t.map(t=>{const n=(t.company||t.companyDomain||"?").charAt(0).toUpperCase();return`\n      <div class="lp-company-card" data-domain="${e(t.companyDomain)}">\n        <div class="lp-company-icon">${e(n)}</div>\n        <div class="lp-company-name">${e(t.company||t.companyDomain)}</div>\n        <div class="lp-company-domain">${e(t.companyDomain)}</div>\n      </div>\n    `}).join(""),n.querySelectorAll(".lp-company-card").forEach(e=>{e.addEventListener("click",async()=>{const t=e.dataset.domain;jt=t,n.querySelectorAll(".lp-company-card").forEach(e=>e.classList.remove("selected")),e.classList.add("selected"),await Ut(t);const o=document.getElementById("lp-company-select-group"),i=document.getElementById("lp-job-select-group");o&&(o.style.display="none"),i&&(i.style.display="block"),Nt("job");const a=document.getElementById("lp-selected-company-name");if(a){const e=Dt.find(e=>e.companyDomain===t);a.textContent=`${(null==e?void 0:e.company)||t} ã®æ±‚äºº`}})})):n.innerHTML='<div class="lp-no-results"><p>è©²å½“ã™ã‚‹ä¼šç¤¾ãŒã‚ã‚Šã¾ã›ã‚“</p></div>')}function Nt(e){const t=document.querySelectorAll(".lp-step"),n=["company","job","edit"],o=n.indexOf(e);t.forEach(e=>{const t=e.dataset.step,i=n.indexOf(t);e.classList.remove("active","completed"),i<o?e.classList.add("completed"):i===o&&e.classList.add("active")})}async function Ut(t){const n=document.getElementById("lp-job-grid"),o=document.getElementById("lp-job-select"),i=Dt.find(e=>e.companyDomain===t);if(i){n&&(n.innerHTML='<div class="lp-loading-placeholder">æ±‚äººã‚’èª­ã¿è¾¼ã¿ä¸­...</div>');try{a();const l=await m(t);if(!l.success)return console.warn(`[LPè¨­å®š] Firestoreæ±‚äººèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${l.error}`),void(n&&(n.innerHTML='<div class="lp-no-results"><p>æ±‚äººãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p></div>'));const s=(l.jobs||[]).map(e=>({id:`${t}_${e.id}`,jobId:e.id,title:e.title||"(ã‚¿ã‚¤ãƒˆãƒ«ãªã—)",company:i.company,companyDomain:t,manageSheetUrl:i.manageSheetUrl,rawData:e}));if(Tt=s,function(t){const n=document.getElementById("lp-job-grid");if(!n)return;if(0===t.length)return void(n.innerHTML='<div class="lp-no-results"><p>ã“ã®ä¼šç¤¾ã«ã¯æ±‚äººãŒã‚ã‚Šã¾ã›ã‚“</p></div>');n.innerHTML=t.map(t=>`\n    <div class="lp-job-card" data-job-id="${e(t.id)}">\n      <div class="lp-job-title">${e(t.title)}</div>\n      <div class="lp-job-id">ID: ${e(t.jobId)}</div>\n      <div class="lp-job-actions">\n        <button type="button" class="lp-job-action-btn primary lp-select-job-btn">LPè¨­å®šã‚’ç·¨é›†</button>\n        <a href="lp.html?j=${encodeURIComponent(t.id)}" target="_blank" class="lp-job-action-btn secondary">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</a>\n      </div>\n    </div>\n  `).join(""),n.querySelectorAll(".lp-select-job-btn").forEach(e=>{e.addEventListener("click",async t=>{t.stopPropagation();const o=e.closest(".lp-job-card"),i=o.dataset.jobId;n.querySelectorAll(".lp-job-card").forEach(e=>e.classList.remove("selected")),o.classList.add("selected");const a=document.getElementById("lp-job-select");a&&(a.value=i),await Ft(i),Nt("edit")})})}(s),o){let t='<option value="">-- æ±‚äººã‚’é¸æŠ --</option>';for(const n of s)t+=`<option value="${e(n.id)}">${e(n.title)}</option>`;o.innerHTML=t}}catch(l){console.warn(`[LPè¨­å®š] Firestoreæ±‚äººèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${t}`,l),n&&(n.innerHTML='<div class="lp-no-results"><p>æ±‚äººãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p></div>')}}else console.warn(`[LPè¨­å®š] ä¼šç¤¾ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${t}`)}async function _t(){return async function(){const e=document.getElementById("lp-company-select-group"),t=document.getElementById("lp-job-select-group"),n=document.getElementById("lp-selection-steps");let o=Pe();if(o&&0!==o.length||(await Ne(),o=Pe()),Dt=o.filter(e=>e.companyDomain&&(!0===e.showCompany||"â—‹"===e.showCompany||"â—¯"===e.showCompany)),ce()){e&&(e.style.display="block"),t&&(t.style.display="none"),n&&(n.style.display="flex"),Pt(Dt);const o=document.getElementById("lp-company-search");o&&o.addEventListener("input",e=>{const t=e.target.value.toLowerCase().trim();Pt(t?Dt.filter(e=>{var n,o;return(null==(n=e.company)?void 0:n.toLowerCase().includes(t))||(null==(o=e.companyDomain)?void 0:o.toLowerCase().includes(t))}):Dt)});const i=document.getElementById("lp-back-to-companies");i&&!i.hasAttribute("data-listener-attached")&&(i.addEventListener("click",()=>{e&&(e.style.display="block"),t&&(t.style.display="none");const n=document.getElementById("lp-editor");n&&(n.style.display="none"),Nt("company")}),i.setAttribute("data-listener-attached","true"))}else{const o=re();e&&(e.style.display="none"),n&&(n.style.display="none");const i=document.getElementById("lp-back-to-companies");i&&(i.style.display="none"),o?(jt=o,await Ut(o),t&&(t.style.display="block")):(console.warn("[LPè¨­å®š] ä¼šç¤¾ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"),t&&(t.style.display="none"))}}()}function Ot(e){const t=document.getElementById("lp-editor");if(!t)return;t.querySelectorAll("input, select, textarea, button").forEach(t=>{t.disabled=e});const n=document.getElementById("btn-save-lp-settings"),o=document.getElementById("btn-reset-lp-settings");n&&(n.disabled=e),o&&(o.disabled=e);const i=t.querySelector(".lp-loading-overlay");if(e){if(!i){const e=document.createElement("div");e.className="lp-loading-overlay",e.innerHTML='<div class="loading-spinner"></div><p>èª­ã¿è¾¼ã¿ä¸­...</p>',t.style.position="relative",t.appendChild(e)}}else null==i||i.remove()}async function Ft(e){const t=document.getElementById("lp-editor"),n=document.getElementById("lp-preview-btn"),o=document.getElementById("lp-edit-mode-btn");if(!e)return t&&(t.style.display="none"),void(kt=null);if(kt=Tt.find(t=>t.id===e),!kt)return void(t&&(t.style.display="none"));t&&(t.style.display="block"),Ot(!0);const i=kt.id;n&&(n.href=`lp.html?j=${encodeURIComponent(i)}`),o&&(o.href=`lp.html?j=${encodeURIComponent(i)}&edit`),yn(),sn((null==kt?void 0:kt.companyDomain)||jt);const l=document.querySelector('input[name="design-pattern"][value="standard"]');l&&(l.checked=!0);try{const t=(null==kt?void 0:kt.companyDomain)||jt;console.log("[LPè¨­å®š] Firestoreã‹ã‚‰èª­ã¿è¾¼ã¿:",t,e),a();const n=await u(t,e);if(n.success&&n.settings&&Object.keys(n.settings).length>0){!function(e){Rt("lp-hero-title",e.heroTitle),Rt("lp-hero-subtitle",e.heroSubtitle),Rt("lp-hero-image",e.heroImage);const t=[];for(let a=1;a<=6;a++){const n=e[`pointTitle${a}`]||"",o=e[`pointDesc${a}`]||"";(n||o)&&t.push({title:n,desc:o})}Qt(t.length>0?t:[{title:"",desc:""},{title:"",desc:""},{title:"",desc:""}]),Rt("lp-cta-text",e.ctaText||"ä»Šã™ãå¿œå‹Ÿã™ã‚‹"),Rt("lp-faq",e.faq);const n=function(e){if(!e)return[{question:"",answer:""}];const t=[],n=e.replace(/\\n/g,"\n").split(/\|\||[\n\r]+/).filter(e=>e.trim());for(const o of n){const e=o.match(/Q[:ï¼š](.+?)\|A[:ï¼š](.+)/i);e&&t.push({question:e[1].trim(),answer:e[2].trim()})}return t.length>0?t:[{question:"",answer:""}]}(e.faq);if(cn(n),e.designPattern){const t=document.querySelector(`input[name="design-pattern"][value="${e.designPattern}"]`);t&&(t.checked=!0)}e.sectionOrder&&function(e){const t=document.getElementById("lp-section-order");if(!t||!e)return;const n=e.split(",").map(e=>e.trim()).filter(e=>e);if(0===n.length)return;const o=Array.from(t.querySelectorAll(".section-order-item")),i={};o.forEach(e=>{i[e.dataset.section]=e}),n.forEach(e=>{const n=i[e];n&&t.appendChild(n)})}(e.sectionOrder);e.sectionVisibility&&function(e){if(!e)return;try{const t=JSON.parse(e);["points","jobs","details","faq"].forEach(e=>{if(void 0!==t[e]){const n=document.getElementById(`section-${e}-visible`);n&&(n.checked=t[e])}})}catch(t){console.error("ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤ºçŠ¶æ…‹ã®ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼:",t)}}(e.sectionVisibility);Rt("lp-tiktok-pixel",e.tiktokPixelId),Rt("lp-google-ads-id",e.googleAdsId),Rt("lp-google-ads-label",e.googleAdsLabel),Rt("lp-meta-pixel",e.metaPixelId),Rt("lp-line-tag",e.lineTagId),Rt("lp-clarity",e.clarityProjectId),Rt("lp-ogp-title",e.ogpTitle),Rt("lp-ogp-description",e.ogpDescription),Rt("lp-ogp-image",e.ogpImage);const o=document.getElementById("lp-show-video-button"),i=document.getElementById("video-url-group");o&&(o.checked="true"===String(e.showVideoButton).toLowerCase()||!0===e.showVideoButton,i&&(i.style.display=o.checked?"block":"none"));Rt("lp-video-url",e.videoUrl),Ht({primary:e.customPrimary||"",accent:e.customAccent||"",bg:e.customBg||"",text:e.customText||""}),vn(e.heroImage||""),ln(e.heroImage||""),Zt(),ot(e),at(),Wt()}(n.settings),console.log("[LPè¨­å®š] Firestoreã‹ã‚‰è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ")}else console.log("[LPè¨­å®š] Firestoreã«è¨­å®šãŒã‚ã‚Šã¾ã›ã‚“ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤º"),pn();Je([{selector:"#lp-hero-title",maxLength:40},{selector:"#lp-hero-subtitle",maxLength:80},{selector:"#lp-cta-button-text",maxLength:20},{selector:"#lp-ogp-title",maxLength:60},{selector:"#lp-ogp-description",maxLength:160}]),Ge("#lp-editor",["lp-hero-title"]),Ke("lp-autosave-indicator")}catch(s){console.log("[LPè¨­å®š] èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",s)}finally{Ot(!1)}pn(),Wt()}function Rt(e,t){const n=document.getElementById(e);n&&(n.value=t||"")}function Ht(e){["primary","accent","bg","text"].forEach(t=>{const n=document.getElementById(`lp-custom-${t}`),o=document.getElementById(`lp-custom-${t}-text`),i=e[t]||"";n&&(n.value=i||("bg"===t?"#ffffff":"text"===t?"#1f2937":"#000000")),o&&(o.value=i)})}function Vt(){var e;const t=(null==(e=document.querySelector('input[name="lp-layout-style"]:checked'))?void 0:e.value)||"modern",n=Bt[t]||Bt.modern;["primary","accent","bg","text"].forEach(e=>{const t=document.getElementById(`lp-custom-${e}`),o=document.getElementById(`lp-custom-${e}-text`);t&&(t.value=n[e]||"#000000"),o&&(o.value="")})}function Jt(){["primary","accent","bg","text"].forEach(e=>{const t=document.getElementById(`lp-custom-${e}`),n=document.getElementById(`lp-custom-${e}-text`);t&&n&&(t.addEventListener("input",()=>{n.value=t.value,bn()}),n.addEventListener("input",()=>{const e=n.value;/^#[0-9A-Fa-f]{6}$/.test(e)&&(t.value=e),bn()}))});const e=document.getElementById("lp-reset-colors");e&&e.addEventListener("click",()=>{Vt(),bn()})}function Yt(){var e,t,n,o,i;const a=(null==(e=document.querySelector('input[name="lp-layout-style"]:checked'))?void 0:e.value)||"modern",l=Bt[a]||Bt.modern;return{primary:(null==(t=document.getElementById("lp-custom-primary-text"))?void 0:t.value)||l.primary,accent:(null==(n=document.getElementById("lp-custom-accent-text"))?void 0:n.value)||l.accent,bg:(null==(o=document.getElementById("lp-custom-bg-text"))?void 0:o.value)||l.bg,text:(null==(i=document.getElementById("lp-custom-text-text"))?void 0:i.value)||l.text}}let Kt=!1;const Gt={"lp-hero-title":".lp-hero","lp-hero-subtitle":".lp-hero","lp-hero-image":".lp-hero","lp-cta-text":".lp-apply","lp-video-url":".lp-hero","lp-show-video-button":".lp-hero","lp-custom-primary":".lp-hero","lp-custom-accent":".lp-hero","lp-custom-bg":".lp-hero","lp-custom-text":".lp-hero"};function zt(e){const t=document.getElementById("lp-preview-frame");if(t&&t.contentDocument)try{const n=t.contentDocument.querySelector(e);n&&n.scrollIntoView({behavior:"smooth",block:"start"})}catch(n){}}function Wt(){if(Kt)return void xn();if(!document.getElementById("lp-preview-container"))return;["lp-hero-title","lp-hero-subtitle","lp-hero-image","lp-cta-text","lp-faq","lp-tiktok-pixel","lp-google-ads-id","lp-google-ads-label","lp-meta-pixel","lp-line-tag","lp-clarity","lp-ogp-title","lp-ogp-description","lp-ogp-image","lp-video-url"].forEach(e=>{const t=document.getElementById(e);t&&t.addEventListener("input",()=>bn())}),document.querySelectorAll('input[name="design-pattern"]').forEach(e=>{e.addEventListener("change",()=>bn())});const e=document.getElementById("lp-show-video-button");e&&e.addEventListener("change",()=>bn()),document.querySelectorAll('input[name="lp-layout-style"]').forEach(e=>{e.addEventListener("change",()=>bn())}),Jt(),function(){Object.entries(Gt).forEach(([e,t])=>{const n=document.getElementById(e);n&&n.addEventListener("focus",()=>zt(t))});const e=document.getElementById("point-inputs-container");e&&e.addEventListener("focusin",e=>{e.target.matches(".point-title, .point-desc")&&zt(".lp-points")});const t=document.getElementById("faq-list");t&&t.addEventListener("focusin",e=>{e.target.matches(".faq-question-input, .faq-answer-input")&&zt(".lp-faq")});const n=document.getElementById("lp-custom-sections-list");n&&n.addEventListener("focusin",e=>{const t=e.target.closest(".custom-section-item");if(t){const e=t.dataset.sectionId;e&&zt(`[data-section-id="${e}"], .lp-custom-section`)}});const o=document.getElementById("lp-sections-list");o&&o.addEventListener("click",e=>{const t=e.target.closest(".section-item");if(t){const e={hero:".lp-hero",heroCta:".lp-hero-cta",points:".lp-points",jobs:".lp-jobs",details:".lp-details",faq:".lp-faq",apply:".lp-apply-section"}[t.dataset.sectionType];e&&zt(e)}})}(),Kt=!0,xn()}function Zt(){At||(nt(xn,{getCompanyDomain:()=>(null==kt?void 0:kt.companyDomain)||null}),At=!0)}function Qt(t=[{title:"",desc:""},{title:"",desc:""},{title:"",desc:""}]){const n=document.getElementById("point-inputs-container");n&&(n.innerHTML=t.map((t,n)=>`\n    <div class="point-input-group" data-point-index="${n}">\n      <label>ãƒã‚¤ãƒ³ãƒˆ${n+1}</label>\n      <input type="text" class="point-title" placeholder="ã‚¿ã‚¤ãƒˆãƒ«" value="${e(t.title||"")}">\n      <input type="text" class="point-desc" placeholder="èª¬æ˜æ–‡" value="${e(t.desc||"")}">\n      <button type="button" class="btn-remove-point" title="å‰Šé™¤">&times;</button>\n    </div>\n  `).join(""),n.querySelectorAll(".btn-remove-point").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.closest(".point-input-group");t&&n.children.length>1&&(t.remove(),Xt(),en(),bn())})}),n.querySelectorAll("input").forEach(e=>{e.addEventListener("input",()=>bn())}),en())}function Xt(){const e=document.getElementById("point-inputs-container");e&&e.querySelectorAll(".point-input-group").forEach((e,t)=>{e.dataset.pointIndex=t;const n=e.querySelector("label");n&&(n.textContent=`ãƒã‚¤ãƒ³ãƒˆ${t+1}`)})}function en(){const e=document.getElementById("point-inputs-container"),t=document.getElementById("btn-add-point");if(!e||!t)return;const n=e.children.length;t.disabled=n>=6}function tn(){const e=document.getElementById("point-inputs-container");if(!e)return;const t=e.children.length;if(t>=6)return;const n=t,o=document.createElement("div");o.className="point-input-group",o.dataset.pointIndex=n,o.innerHTML=`\n    <label>ãƒã‚¤ãƒ³ãƒˆ${n+1}</label>\n    <input type="text" class="point-title" placeholder="ã‚¿ã‚¤ãƒˆãƒ«" value="">\n    <input type="text" class="point-desc" placeholder="èª¬æ˜æ–‡" value="">\n    <button type="button" class="btn-remove-point" title="å‰Šé™¤">&times;</button>\n  `,o.querySelector(".btn-remove-point").addEventListener("click",()=>{e.children.length>1&&(o.remove(),Xt(),en(),bn())}),o.querySelectorAll("input").forEach(e=>{e.addEventListener("input",()=>bn())}),e.appendChild(o),en(),o.querySelector(".point-title").focus()}function nn(){const e=document.getElementById("point-inputs-container");if(!e)return[];const t=[];return e.querySelectorAll(".point-input-group").forEach(e=>{var n,o;const i=(null==(n=e.querySelector(".point-title"))?void 0:n.value)||"",a=(null==(o=e.querySelector(".point-desc"))?void 0:o.value)||"";t.push({title:i,desc:a})}),t}function on(){const e=document.getElementById("btn-add-point");e&&e.addEventListener("click",tn),Qt()}function an(){const e=document.getElementById("lp-show-video-button"),t=document.getElementById("video-url-group");e&&t&&e.addEventListener("change",()=>{t.style.display=e.checked?"block":"none"})}function ln(t){const n=document.getElementById("lp-hero-image-preview");n&&(t?(n.innerHTML=`<img src="${e(t)}" alt="ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" style="max-width: 200px; max-height: 120px; object-fit: cover; border-radius: 8px;">`,n.style.display="block"):(n.innerHTML="",n.style.display="none"))}function sn(e){let n=document.getElementById("btn-upload-hero-image"),o=document.getElementById("lp-hero-image");const i=document.getElementById("lp-hero-image-preview");if(!n||!o)return;const a=n.cloneNode(!0);n.parentNode.replaceChild(a,n),n=a,o.addEventListener("input",()=>{ln(o.value)}),o.value&&ln(o.value),n.addEventListener("click",async()=>{const a=e||jt;if(a)try{const e=await v({accept:"image/png,image/jpeg,image/webp"});n.disabled=!0,n.innerHTML='<span class="upload-spinner"></span> ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...',i&&(i.classList.add("uploading"),i.innerHTML='<div class="upload-spinner"></div>',i.style.display="block");const l=Date.now(),s=await y(e,a),r=s.includes("?")?`${s}&t=${l}`:`${s}?t=${l}`;o.value=r,o.dispatchEvent(new Event("input",{bubbles:!0})),ln(r),vn(r),t("ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ","success")}catch(l){console.error("[LPSettings] ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:",l),"ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ"!==l.message&&t("ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ: "+l.message,"error"),ln(o.value)}finally{n.disabled=!1,n.innerHTML='<span class="upload-icon">ğŸ“·</span> ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',i&&i.classList.remove("uploading")}else t("ä¼šç¤¾æƒ…å ±ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“","error")})}function rn(){const e=document.getElementById("btn-add-faq");e&&e.addEventListener("click",dn),cn([{question:"",answer:""}])}function cn(t=[{question:"",answer:""}]){const n=document.getElementById("faq-list");n&&(n.innerHTML=t.map((t,n)=>`\n    <div class="faq-item" data-index="${n}">\n      <div class="faq-item-header">\n        <span class="faq-item-number">Q${n+1}</span>\n        <div class="faq-item-actions">\n          <button type="button" class="faq-action-btn delete" data-index="${n}" title="å‰Šé™¤">\n            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>\n          </button>\n        </div>\n      </div>\n      <div class="faq-fields">\n        <div class="faq-field">\n          <label>\n            <span class="faq-label-icon q">Q</span>\n            è³ªå•\n          </label>\n          <input type="text" class="faq-question-input" value="${e(t.question)}" placeholder="ä¾‹: æœªçµŒé¨“ã§ã‚‚å¿œå‹Ÿã§ãã¾ã™ã‹ï¼Ÿ">\n        </div>\n        <div class="faq-field">\n          <label>\n            <span class="faq-label-icon a">A</span>\n            å›ç­”\n          </label>\n          <textarea class="faq-answer-input" rows="2" placeholder="ä¾‹: ã¯ã„ã€æœªçµŒé¨“ã®æ–¹ã‚‚å¤§æ­“è¿ã§ã™ã€‚ä¸å¯§ã«æŒ‡å°ã„ãŸã—ã¾ã™ã€‚">${e(t.answer)}</textarea>\n        </div>\n      </div>\n    </div>\n  `).join(""),n.querySelectorAll(".faq-action-btn.delete").forEach(e=>{e.addEventListener("click",()=>{!function(e){const t=un();t.length<=1?cn([{question:"",answer:""}]):(t.splice(e,1),cn(t));mn(),bn()}(parseInt(e.dataset.index))})}),n.querySelectorAll(".faq-question-input, .faq-answer-input").forEach(e=>{e.addEventListener("input",()=>{mn(),function(){const e=un(),t=e.some(e=>e.question.trim()||e.answer.trim());t&&function(e,t){const n=We.find(t=>t.type===e);n&&n.visible!==t&&(n.visible=t,at(),St())}("faq",!0)}(),bn()})}),mn())}function dn(){const e=un();e.push({question:"",answer:""}),cn(e),mn(),bn(),setTimeout(()=>{const e=document.querySelector(".faq-item:last-child .faq-question-input");e&&e.focus()},100)}function un(){const e=document.getElementById("faq-list");if(!e)return[];const t=[];return e.querySelectorAll(".faq-item").forEach(e=>{var n,o,i,a;const l=(null==(o=null==(n=e.querySelector(".faq-question-input"))?void 0:n.value)?void 0:o.trim())||"",s=(null==(a=null==(i=e.querySelector(".faq-answer-input"))?void 0:i.value)?void 0:a.trim())||"";t.push({question:l,answer:s})}),t}function mn(){const e=un(),t=document.getElementById("lp-faq");if(t){const n=e.filter(e=>e.question||e.answer).map(e=>`Q:${e.question}|A:${e.answer}`).join("\n");t.value=n}}function pn(){["lp-hero-title","lp-hero-subtitle","lp-hero-image","lp-faq","lp-tiktok-pixel","lp-google-ads-id","lp-google-ads-label","lp-ogp-title","lp-ogp-description","lp-ogp-image","lp-video-url"].forEach(e=>Rt(e,"")),Rt("lp-cta-text","ä»Šã™ãå¿œå‹Ÿã™ã‚‹");const e=document.getElementById("lp-show-video-button"),t=document.getElementById("video-url-group");e&&(e.checked=!1),t&&(t.style.display="none"),Qt(),cn([{question:"",answer:""}]);const n=document.querySelector('input[name="design-pattern"][value="standard"]');n&&(n.checked=!0),Vt(),vn(""),Zt(),ot({}),at()}function yn(){const t=document.getElementById("hero-image-presets");t&&(t.innerHTML=c.map(t=>`\n    <div class="hero-image-preset" data-url="${e(t.url)}" title="${e(t.name)}">\n      <img src="${e(t.thumbnail)}" alt="${e(t.name)}" loading="lazy">\n      <span class="preset-name">${e(t.name)}</span>\n      <span class="preset-check">âœ“</span>\n    </div>\n  `).join(""),t.querySelectorAll(".hero-image-preset").forEach(e=>{e.addEventListener("click",()=>{!function(e){const t=document.getElementById("lp-hero-image");t&&(t.value=e,t.dispatchEvent(new Event("input",{bubbles:!0})));vn(e)}(e.dataset.url)})}))}function vn(e){const t=document.getElementById("hero-image-presets");t&&t.querySelectorAll(".hero-image-preset").forEach(t=>{const n=t.dataset.url,o=(null==e?void 0:e.split("?")[0])||"",i=(null==n?void 0:n.split("?")[0])||"";o&&i&&o===i?t.classList.add("selected"):t.classList.remove("selected")})}async function fn(){var e,n,o,i,l,s,r,c,u,m,p,y,v,f,g,h,b,E,w,I,x,$,C,S,L,B,q,A;console.log("[LPä¿å­˜] saveLPSettings é–‹å§‹");const T=null==(e=document.getElementById("lp-job-select"))?void 0:e.value;if(console.log("[LPä¿å­˜] jobId:",T),!T)return t("æ±‚äººã‚’é¸æŠã—ã¦ãã ã•ã„","error"),void console.log("[LPä¿å­˜] jobIdãŒãªã„ãŸã‚ä¸­æ–­");const k=kt||Tt.find(e=>e.id===T);if(console.log("[LPä¿å­˜] jobData:",k),!k)return t("æ±‚äººãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“","error"),void console.log("[LPä¿å­˜] jobDataãŒãªã„ãŸã‚ä¸­æ–­");const D=nn(),j=(null==(n=document.querySelector('input[name="lp-layout-style"]:checked'))?void 0:n.value)||"modern",M={jobId:T,companyDomain:k.companyDomain,company:k.company,jobTitle:k.title,designPattern:(null==(o=document.querySelector('input[name="design-pattern"]:checked'))?void 0:o.value)||"modern",layoutStyle:j,heroTitle:(null==(i=document.getElementById("lp-hero-title"))?void 0:i.value)||"",heroSubtitle:(null==(l=document.getElementById("lp-hero-subtitle"))?void 0:l.value)||"",heroImage:(null==(s=document.getElementById("lp-hero-image"))?void 0:s.value)||"",ctaText:(null==(r=document.getElementById("lp-cta-text"))?void 0:r.value)||"",faq:(null==(c=document.getElementById("lp-faq"))?void 0:c.value)||"",sectionOrder:gn().join(","),sectionVisibility:JSON.stringify(hn())};for(let t=0;t<6;t++)M[`pointTitle${t+1}`]=(null==(u=D[t])?void 0:u.title)||"",M[`pointDesc${t+1}`]=(null==(m=D[t])?void 0:m.desc)||"";M.tiktokPixelId=(null==(p=document.getElementById("lp-tiktok-pixel"))?void 0:p.value)||"",M.googleAdsId=(null==(y=document.getElementById("lp-google-ads-id"))?void 0:y.value)||"",M.googleAdsLabel=(null==(v=document.getElementById("lp-google-ads-label"))?void 0:v.value)||"",M.metaPixelId=(null==(f=document.getElementById("lp-meta-pixel"))?void 0:f.value)||"",M.lineTagId=(null==(g=document.getElementById("lp-line-tag"))?void 0:g.value)||"",M.clarityProjectId=(null==(h=document.getElementById("lp-clarity"))?void 0:h.value)||"",M.ogpTitle=(null==(b=document.getElementById("lp-ogp-title"))?void 0:b.value)||"",M.ogpDescription=(null==(E=document.getElementById("lp-ogp-description"))?void 0:E.value)||"",M.ogpImage=(null==(w=document.getElementById("lp-ogp-image"))?void 0:w.value)||"",Yt(),M.customPrimary=(null==(I=document.getElementById("lp-custom-primary-text"))?void 0:I.value)||"",M.customAccent=(null==(x=document.getElementById("lp-custom-accent-text"))?void 0:x.value)||"",M.customBg=(null==($=document.getElementById("lp-custom-bg-text"))?void 0:$.value)||"",M.customText=(null==(C=document.getElementById("lp-custom-text-text"))?void 0:C.value)||"";const P=it();if(P){M.lpContent=JSON.stringify(P);const e=null==(S=P.sections)?void 0:S.find(e=>"heroCta"===e.type);(null==e?void 0:e.data)?(M.showVideoButton=e.data.showVideoButton?"true":"false",M.videoUrl=e.data.videoUrl||""):(M.showVideoButton=(null==(L=document.getElementById("lp-show-video-button"))?void 0:L.checked)?"true":"false",M.videoUrl=(null==(B=document.getElementById("lp-video-url"))?void 0:B.value)||"")}else M.showVideoButton=(null==(q=document.getElementById("lp-show-video-button"))?void 0:q.checked)?"true":"false",M.videoUrl=(null==(A=document.getElementById("lp-video-url"))?void 0:A.value)||"";console.log("[LPä¿å­˜] é€ä¿¡ã™ã‚‹è¨­å®š:",M),console.log("[LPä¿å­˜] layoutStyle:",M.layoutStyle),console.log("[LPä¿å­˜] faq:",M.faq),console.log("[LPä¿å­˜] lpContent:",M.lpContent?"ã‚ã‚Š":"ãªã—"),console.log("[LPä¿å­˜] showVideoButton:",M.showVideoButton),console.log("[LPä¿å­˜] videoUrl:",M.videoUrl);try{const e=document.getElementById("btn-save-lp-settings");e&&(e.disabled=!0,e.textContent="ä¿å­˜ä¸­..."),a();const n=await d(M.companyDomain,T,M);if(e&&(e.disabled=!1,e.textContent="LPè¨­å®šã‚’ä¿å­˜"),!n.success)return void t("Firestoreã¸ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: "+(n.error||"ä¸æ˜ãªã‚¨ãƒ©ãƒ¼"),"error");(M.showVideoButton||M.videoUrl)&&await async function(e,t,n,o){console.log("[LPè¨­å®š] å‹•ç”»è¨­å®šã®æ±‚äººã‚·ãƒ¼ãƒˆåŒæœŸï¼ˆæœªå®Ÿè£…ï¼‰:",{jobId:e,showVideoButton:t,videoUrl:n,companyDomain:(null==o?void 0:o.companyDomain)||jt})}(T,M.showVideoButton,M.videoUrl,k),localStorage.removeItem(`lp_settings_${T}`),t("LPè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ","success")}catch(N){console.error("Firestoreä¿å­˜ã‚¨ãƒ©ãƒ¼:",N),t("Firestoreã¸ã®ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: "+N.message,"error")}}function gn(){var e;const t=it();return(null==(e=null==t?void 0:t.sections)?void 0:e.length)>0?t.sections.slice().sort((e,t)=>(e.order||0)-(t.order||0)).map(e=>e.type):["hero","points","jobs","details","faq","apply"]}function hn(){var e;const t=it();if((null==(e=null==t?void 0:t.sections)?void 0:e.length)>0){const e={};return t.sections.forEach(t=>{e[t.type]=!1!==t.visible}),e}return{hero:!0,points:!0,jobs:!0,details:!0,faq:!0,apply:!0}}function bn(){qt&&clearTimeout(qt),qt=setTimeout(()=>{xn()},300)}function En(){xn()}function wn(){}let In=null;async function xn(){const e=document.getElementById("lp-preview-frame"),t=document.getElementById("lp-preview-container");if(!e||!t)return;const n=jt;if(!n)return;const o=await async function(){if(Mt)return console.log("[LP Preview] lp.css ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨:",Mt.length,"æ–‡å­—"),Mt;try{console.log("[LP Preview] lp.css fetché–‹å§‹...");const e=await fetch("/css/lp.css");e.ok?(Mt=await e.text(),console.log("[LP Preview] lp.css fetchæˆåŠŸ:",Mt.length,"æ–‡å­—")):console.warn("[LP Preview] lp.css fetchå¤±æ•—:",e.status)}catch(e){console.warn("[LP Preview] lp.cssèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",e)}return Mt||""}(),i=Pe(),a=function(e,t,n=null,o=""){const i=t.layoutStyle||"modern",a=Bt[i]||Bt.modern,l={primary:t.customPrimary||a.primary,accent:t.customAccent||a.accent,bg:t.customBg||a.bg,text:t.customText||a.text},s=`\n    --lp-primary: ${l.primary};\n    --lp-accent: ${l.accent};\n    --lp-bg: ${l.bg};\n    --lp-text: ${l.text};\n  `,r=n?[n]:[],{html:c,patternClass:d,layoutClass:u}=$n.renderToHtml(e,r,t);return`\n<!DOCTYPE html>\n<html lang="ja">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">\n  <style>\n    /* lp.css ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŸ‹ã‚è¾¼ã¿ */\n    ${o}\n    /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ« */\n    \n    /* åŸºæœ¬ãƒªã‚»ãƒƒãƒˆ */\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: 'Noto Sans JP', sans-serif; }\n  \n  </style>\n</head>\n<body class="lp-body ${d} ${u}" style="${s}">\n  <div id="lp-content" class="${u}">\n    ${c}\n  </div>\n</body>\n</html>\n  `}((null==i?void 0:i.find(e=>e.companyDomain===n))||{company:n,companyDomain:n},function(){var e,t,n,o,i,a,l,s,r;const c=nn(),d=(null==(e=document.querySelector('input[name="lp-layout-style"]:checked'))?void 0:e.value)||"modern",u=Yt(),m=it(),p={designPattern:(null==(t=document.querySelector('input[name="design-pattern"]:checked'))?void 0:t.value)||"modern",layoutStyle:d,heroTitle:(null==(n=document.getElementById("lp-hero-title"))?void 0:n.value)||"",heroSubtitle:(null==(o=document.getElementById("lp-hero-subtitle"))?void 0:o.value)||"",heroImage:(null==(i=document.getElementById("lp-hero-image"))?void 0:i.value)||"",ctaText:(null==(a=document.getElementById("lp-cta-text"))?void 0:a.value)||"ä»Šã™ãå¿œå‹Ÿã™ã‚‹",faq:(null==(l=document.getElementById("lp-faq"))?void 0:l.value)||"",sectionOrder:gn().join(","),sectionVisibility:JSON.stringify(hn()),customPrimary:u.primary,customAccent:u.accent,customBg:u.bg,customText:u.text,lpContent:m};for(let y=0;y<6;y++)p[`pointTitle${y+1}`]=(null==(s=c[y])?void 0:s.title)||"",p[`pointDesc${y+1}`]=(null==(r=c[y])?void 0:r.desc)||"";return p}(),(null==kt?void 0:kt.rawData)||kt||null,o);In&&URL.revokeObjectURL(In);const l=new Blob([a],{type:"text/html"});In=URL.createObjectURL(l),e.src=In}const $n=new L;function Cn(){const e=document.getElementById("lp-section-order");if(!e)return;let t=null,n=null;e.querySelectorAll(".section-order-item").forEach(o=>{o.setAttribute("draggable","true"),o.addEventListener("dragstart",e=>{t=o,o.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",""),setTimeout(()=>{o.style.opacity="0.4"},0)}),o.addEventListener("dragend",()=>{o.classList.remove("dragging"),o.style.opacity="",t=null,e.querySelectorAll(".section-order-item").forEach(e=>{e.classList.remove("drag-over")}),xn(),o.style.animation="none",o.offsetHeight,o.style.animation="sortableDropped 0.3s ease"}),o.addEventListener("dragover",n=>{if(n.preventDefault(),n.dataTransfer.dropEffect="move",!t||t===o)return;const i=Sn(e,n.clientY);e.querySelectorAll(".section-order-item").forEach(e=>{e.classList.remove("drag-over")}),i&&i!==t&&i.classList.add("drag-over"),null==i?e.appendChild(t):e.insertBefore(t,i)}),o.addEventListener("dragleave",()=>{o.classList.remove("drag-over")}),o.addEventListener("touchstart",e=>{e.touches[0].clientY,n=o,o.classList.add("dragging")},{passive:!0}),o.addEventListener("touchmove",t=>{if(!n)return;const o=t.touches[0].clientY,i=Sn(e,o);null==i?e.appendChild(n):i!==n&&e.insertBefore(n,i)},{passive:!0}),o.addEventListener("touchend",()=>{n&&(n.classList.remove("dragging"),xn()),n=null})})}function Sn(e,t){return[...e.querySelectorAll(".section-order-item:not(.dragging)")].reduce((e,n)=>{const o=n.getBoundingClientRect(),i=t-o.top-o.height/2;return i<0&&i>e.offset?{offset:i,element:n}:e},{offset:Number.NEGATIVE_INFINITY}).element}function Ln(){Kt=!1,At=!1}function Bn(e){if(!(!0===e.visible||"true"===e.visible||"TRUE"===e.visible||!0===e.isVisible||"true"===e.isVisible))return"draft";if(e.publishEndDate){const t=new Date(e.publishEndDate),n=new Date;if(n.setHours(0,0,0,0),t<n)return"expired"}return"active"}function qn(e){return{active:"å…¬é–‹ä¸­",draft:"éå…¬é–‹",expired:"æ²è¼‰çµ‚äº†"}[e]||e}function An(e){return{active:"status-active",draft:"status-draft",expired:"status-expired"}[e]||""}function Tn(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function kn(e,t="edit-job"){const n=(e,n)=>{const o=document.getElementById(`${t}-${e}`);o&&(o.value=n||"")};n("title",e.title),n("employment-type",e.employmentType),n("location",e.location),n("access",e.access),n("salary",e.monthlySalary),n("bonus",e.totalBonus),n("order",e.order),n("type",e.jobType),n("features",e.features),n("badges",e.badges),n("description",e.jobDescription),n("requirements",e.requirements),n("benefits",e.benefits),n("hours",e.workingHours),n("holidays",e.holidays),n("start-date",Tn(e.publishStartDate)),n("end-date",Tn(e.publishEndDate));const o=document.getElementById(`${t}-visible`);o&&(o.checked="true"===e.visible||"TRUE"===e.visible||!0===e.visible)}function Dn(e="edit-job"){["title","employment-type","location","access","salary","bonus","order","type","features","badges","description","requirements","benefits","hours","holidays","start-date","end-date"].forEach(t=>{const n=document.getElementById(`${e}-${t}`);n&&(n.value="")});const t=document.getElementById(`${e}-visible`);t&&(t.checked=!0)}const jn="L-SET",Mn="https://rikueko.com",Pn="L-SET",Nn="https://rikueko.com";function Un(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function _n(e){return e?e.replace(/<[^>]*>/g,"").trim():""}function On(e){if(!e)return{prefecture:"",city:"",country:"JP"};const t=e.match(/^(.+?[éƒ½é“åºœçœŒ])/),n=t?t[1]:"",o=e.match(/[éƒ½é“åºœçœŒ](.+?[å¸‚åŒºç”ºæ‘])/);return{prefecture:n,city:o?o[1]:e.replace(n,"").trim(),country:"JP"}}function Fn(e){if(!e)return{min:null,max:null,currency:"JPY",period:"MONTH"};const t=String(e);let n=0;const o=t.match(/(\d+(?:\.\d+)?)\s*ä¸‡/);if(o)n=1e4*parseFloat(o[1]);else{const e=t.match(/(\d{1,3}(?:,\d{3})*|\d+)/);e&&(n=parseInt(e[1].replace(/,/g,"")))}return{min:n,max:n,currency:"JPY",period:"MONTH"}}function Rn(e){if(!e)return"FULL_TIME";return{"æ­£ç¤¾å“¡":"FULL_TIME","ãƒ•ãƒ«ã‚¿ã‚¤ãƒ ":"FULL_TIME","ãƒ‘ãƒ¼ãƒˆ":"PART_TIME","ãƒ‘ãƒ¼ãƒˆã‚¿ã‚¤ãƒ ":"PART_TIME","ã‚¢ãƒ«ãƒã‚¤ãƒˆ":"PART_TIME","å¥‘ç´„ç¤¾å“¡":"CONTRACTOR","å¥‘ç´„":"CONTRACTOR","æ´¾é£":"TEMPORARY","æ´¾é£ç¤¾å“¡":"TEMPORARY","ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³":"INTERN","æœŸé–“å·¥":"CONTRACTOR","æœŸé–“å¾“æ¥­å“¡":"CONTRACTOR"}[e]||"FULL_TIME"}function Hn(e){return e.companyDomain&&e.id?`${Mn}/job-detail.html?company=${encodeURIComponent(e.companyDomain)}&job=${encodeURIComponent(e.id)}`:e.companyDomain?`${Mn}/lp.html?company=${encodeURIComponent(e.companyDomain)}`:Mn}function Vn(e){const t=(new Date).toISOString();let n=`<?xml version="1.0" encoding="UTF-8"?>\n<source>\n  <publisher>${Un(Pn)}</publisher>\n  <publisherurl>${Un(Nn)}</publisherurl>\n  <lastBuildDate>${t}</lastBuildDate>\n`;return e.forEach(e=>{if(!e.title)return;const t=On(e.location||e.companyAddress);Fn(e.monthlySalary);const o=Hn(e),i=_n(e.jobDescription||e.description||"");n+=`\n  <job>\n    <title><![CDATA[${e.title}]]></title>\n    <date>${e.publishStartDate||(new Date).toISOString().split("T")[0]}</date>\n    <referencenumber>${Un(e.id||"")}</referencenumber>\n    <url><![CDATA[${o}]]></url>\n    <company><![CDATA[${e.company||""}]]></company>\n    <city><![CDATA[${t.city}]]></city>\n    <state><![CDATA[${t.prefecture}]]></state>\n    <country>${t.country}</country>\n    <postalcode></postalcode>\n    <description><![CDATA[${i}]]></description>\n    <salary><![CDATA[${e.monthlySalary||""}]]></salary>\n    <jobtype>${Rn(e.employmentType)}</jobtype>\n    <category><![CDATA[${e.jobType||"ãã®ä»–"}]]></category>\n    <experience><![CDATA[${e.requirements||"æœªçµŒé¨“æ­“è¿"}]]></experience>\n  </job>`}),n+="\n</source>",n}function Jn(e){const t=e.map(e=>{if(!e.title)return null;const t=On(e.location||e.companyAddress),n=Fn(e.monthlySalary),o=Hn(e),i=_n(e.jobDescription||e.description||e.title),a={"@context":"https://schema.org/","@type":"JobPosting",title:e.title,description:i,identifier:{"@type":"PropertyValue",name:e.company||jn,value:e.id||""},datePosted:e.publishStartDate||(new Date).toISOString().split("T")[0],hiringOrganization:{"@type":"Organization",name:e.company||"",sameAs:o},jobLocation:{"@type":"Place",address:{"@type":"PostalAddress",addressLocality:t.city,addressRegion:t.prefecture,addressCountry:t.country}},employmentType:Rn(e.employmentType)};return n.min&&(a.baseSalary={"@type":"MonetaryAmount",currency:n.currency,value:{"@type":"QuantitativeValue",value:n.min,unitText:n.period}}),e.publishEndDate&&(a.validThrough=e.publishEndDate),a}).filter(Boolean);return JSON.stringify(t,null,2)}function Yn(e){const t=(new Date).toISOString();let n=`<?xml version="1.0" encoding="UTF-8"?>\n<jobs xmlns="http://www.jobbox.com/schema/jobs">\n  <publisher>${Un(Pn)}</publisher>\n  <publisherUrl>${Un(Nn)}</publisherUrl>\n  <lastUpdate>${t}</lastUpdate>\n`;return e.forEach(e=>{if(!e.title)return;const t=On(e.location||e.companyAddress),o=Fn(e.monthlySalary),i=Hn(e),a=_n(e.jobDescription||e.description||"");n+=`\n  <job>\n    <id>${Un(e.id||"")}</id>\n    <title><![CDATA[${e.title}]]></title>\n    <company><![CDATA[${e.company||""}]]></company>\n    <url><![CDATA[${i}]]></url>\n    <location>\n      <prefecture>${Un(t.prefecture)}</prefecture>\n      <city>${Un(t.city)}</city>\n      <country>${t.country}</country>\n    </location>\n    <description><![CDATA[${a}]]></description>\n    <salary>\n      <type>monthly</type>\n      <min>${o.min||""}</min>\n      <max>${o.max||""}</max>\n      <currency>${o.currency}</currency>\n      <text><![CDATA[${e.monthlySalary||""}]]></text>\n    </salary>\n    <employmentType>${Un(e.employmentType||"æ­£ç¤¾å“¡")}</employmentType>\n    <requirements><![CDATA[${e.requirements||""}]]></requirements>\n    <benefits><![CDATA[${e.benefits||""}]]></benefits>\n    <workingHours><![CDATA[${e.workingHours||""}]]></workingHours>\n    <holidays><![CDATA[${e.holidays||""}]]></holidays>\n    <datePosted>${e.publishStartDate||(new Date).toISOString().split("T")[0]}</datePosted>\n    <validThrough>${e.publishEndDate||""}</validThrough>\n  </job>`}),n+="\n</jobs>",n}function Kn(e){const t=e=>{if(null==e)return"";const t=String(e).replace(/"/g,'""');return t.includes(",")||t.includes('"')||t.includes("\n")?`"${t}"`:t};let n=["id","ã‚¿ã‚¤ãƒˆãƒ«","ä¼šç¤¾å","å‹¤å‹™åœ°","éƒ½é“åºœçœŒ","å¸‚åŒºç”ºæ‘","æœˆå","ç‰¹å…¸ç·é¡","é›‡ç”¨å½¢æ…‹","ä»•äº‹å†…å®¹","å¿œå‹Ÿè³‡æ ¼","å¾…é‡","å‹¤å‹™æ™‚é–“","ä¼‘æ—¥","æ²è¼‰é–‹å§‹æ—¥","æ²è¼‰çµ‚äº†æ—¥","URL"].join(",")+"\n";return e.forEach(e=>{const o=On(e.location||e.companyAddress),i=Hn(e),a=[e.id||"",e.title||"",e.company||"",e.location||e.companyAddress||"",o.prefecture,o.city,e.monthlySalary||"",e.totalBonus||"",e.employmentType||"",_n(e.jobDescription||""),e.requirements||"",e.benefits||"",e.workingHours||"",e.holidays||"",e.publishStartDate||"",e.publishEndDate||"",i];n+=a.map(t).join(",")+"\n"}),n}async function Gn(){try{const e=await f();if(!e)throw new Error("ä¼šç¤¾ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");const t=[];for(const n of e){if(!g(n))continue;const e=await h(n.jobsSheet);e&&e.forEach(e=>{"false"!==e.visible&&"FALSE"!==e.visible&&b(e)&&(e.company=n.company,e.companyDomain=n.companyDomain,e.companyAddress=e.location||n.companyAddress||"",t.push(e))})}return console.log(`[JobFeedGenerator] ${t.length}ä»¶ã®æ±‚äººã‚’å–å¾—ã—ã¾ã—ãŸ`),{jobs:t,indeedXml:Vn(t),googleJsonLd:Jn(t),jobBoxXml:Yn(t),csv:Kn(t)}}catch(e){throw console.error("[JobFeedGenerator] ãƒ•ã‚£ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼:",e),e}}function zn(e,t,n){const o=new Blob([e],{type:n}),i=URL.createObjectURL(o),a=document.createElement("a");a.href=i,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}async function Wn(){zn((await Gn()).indeedXml,"indeed-feed.xml","application/xml")}async function Zn(){zn((await Gn()).googleJsonLd,"google-jobs.json","application/json")}async function Qn(){zn((await Gn()).jobBoxXml,"jobbox-feed.xml","application/xml")}async function Xn(){zn((await Gn()).csv,"jobs-feed.csv","text/csv;charset=utf-8")}let eo=null,to=null,no=null,oo=[],io=null,ao=!1,lo=null,so={},ro={search:"",status:"",area:""},co=[],uo=!1,mo=!1,po=!1,yo=null;function vo(e,t,n){eo=e,to=t,no=n}function fo(e){no=e}function go(e){oo=e}function ho(e){io=e}function bo(e){ao=e}function Eo(e){}function wo(e){lo=e}function Io(e){}function xo(e){so=e}function $o(){ro={search:"",status:"",area:""}}function Co(e){co=e}function So(e){}function Lo(e){uo=e}function Bo(e){mo=e}function qo(){return po}function Ao(){po=!0}function To(){po=!1}function ko(){return yo&&yo.abort(),yo=new AbortController,yo}function Do(){yo=null}let jo=null,Mo=null,Po={};async function No(e){jo=e;const t=document.getElementById("company-name");Mo=(null==t?void 0:t.textContent)||"";const n=document.getElementById("recruit-page-url");n&&(n.textContent=`/company-recruit.html?id=${e}`),A(e),T(e),k(),D(e),j(e),M(),P(),N(),Uo(!0);try{Po=await V(e)||{},Object.keys(Po).length>0?U(Po,Mo):_(Mo),O(),function(){var e,t;const n=document.getElementById("btn-save-recruit-settings");n&&(n.replaceWith(n.cloneNode(!0)),null==(e=document.getElementById("btn-save-recruit-settings"))||e.addEventListener("click",async()=>{await F(jo,e=>{Po=e;const t=document.getElementById("recruit-save-message");t&&(t.style.display="block",setTimeout(()=>{t.style.display="none"},3e3))})}));const o=document.getElementById("btn-reset-recruit-settings");o&&(o.replaceWith(o.cloneNode(!0)),null==(t=document.getElementById("btn-reset-recruit-settings"))||t.addEventListener("click",()=>{R(Po,Mo),H()}))}()}finally{Uo(!1)}}function Uo(e){const t=document.getElementById("section-recruit-settings");if(!t)return;t.querySelectorAll("input, select, textarea, button").forEach(t=>{t.disabled=e});const n=document.getElementById("btn-save-recruit-settings"),o=document.getElementById("btn-reset-recruit-settings");n&&(n.disabled=e),o&&(o.disabled=e);const i=t.querySelector(".recruit-loading-overlay");if(e){if(!i){const e=document.createElement("div");e.className="recruit-loading-overlay",e.innerHTML='<div class="loading-spinner"></div><p>èª­ã¿è¾¼ã¿ä¸­...</p>',t.style.position="relative",t.appendChild(e)}}else null==i||i.remove()}function _o(t){const{containerId:n,checkboxName:o,checkedFeatures:i,selectedDisplayed:a=[],onWarning:l=e=>alert(e)}=t,s=document.getElementById(n);s&&(0!==i.length?(s.innerHTML=i.map(t=>{const n=a.includes(t);return`\n      <label class="displayed-feature-item ${n?"selected":""}" data-feature="${e(t)}">\n        <input type="checkbox" name="${o}" value="${e(t)}" ${n?"checked":""}>\n        <span class="displayed-feature-label">${e(t)}</span>\n        <span class="displayed-feature-badge">${n?"è¡¨ç¤ºä¸­":""}</span>\n      </label>\n    `}).join(""),function(e){const{containerId:t,onWarning:n=e=>alert(e)}=e,o=document.querySelectorAll(`#${t} input[type="checkbox"]`);o.forEach(e=>{e.addEventListener("change",()=>{if(document.querySelectorAll(`#${t} input[type="checkbox"]:checked`).length>3)return e.checked=!1,void n("è¡¨ç¤ºã™ã‚‹ç‰¹å¾´ã¯æœ€å¤§3ã¤ã¾ã§ã§ã™");const o=e.closest(".displayed-feature-item"),i=o.querySelector(".displayed-feature-badge");e.checked?(o.classList.add("selected"),i.textContent="è¡¨ç¤ºä¸­"):(o.classList.remove("selected"),i.textContent="")})})}({containerId:n,onWarning:l})):s.innerHTML='<div class="displayed-features-empty">ä¸Šè¨˜ã‹ã‚‰ç‰¹å¾´ã‚’é¸æŠã™ã‚‹ã¨ã€ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>')}function Oo(e){const{featuresGridId:t,displayedContainerId:n,checkboxName:o,onWarning:i=e=>alert(e)}=e;document.querySelectorAll(`#${t} input[type="checkbox"]`).forEach(e=>{e.addEventListener("change",()=>{const e=Array.from(document.querySelectorAll(`#${t} input[type="checkbox"]:checked`)).map(e=>e.value),a=Array.from(document.querySelectorAll(`#${n} input[type="checkbox"]:checked`)).map(e=>e.value).filter(t=>e.includes(t));_o({containerId:n,checkboxName:o,checkedFeatures:e,selectedDisplayed:a,onWarning:i})})})}export{En as $,to as A,_o as B,An as C,qn as D,de as E,Ne as F,_e as G,_t as H,yn as I,fn as J,Ft as K,ge as L,Wn as M,Zn as N,Qn as O,Xn as P,me as Q,he as R,pe as S,ue as T,ye as U,fe as V,be as W,xn as X,Cn as Y,bn as Z,wn as _,re as a,He as a0,Re as a1,Fe as a2,Oe as a3,Ue as a4,Ie as a5,xe as a6,Q as a7,ee as a8,$e as a9,ke as aA,Le as aB,Eo as aC,wo as aD,lo as aE,nt as aF,Jt as aG,Vt as aH,vn as aI,ot as aJ,mo as aK,no as aL,Co as aM,So as aN,co as aO,sn as aP,Ht as aQ,ln as aR,Pe as aS,fo as aT,Bo as aU,qo as aV,uo as aW,Ao as aX,To as aY,Ce as aZ,ne as aa,te as ab,ae as ac,oe as ad,on as ae,rn as af,an as ag,se as ah,Ee as ai,we as aj,ie as ak,Ln as al,ao as am,io as an,ho as ao,bo as ap,ko as aq,Do as ar,Tn as as,so as at,Ae as au,xo as av,Be as aw,qe as ax,Io as ay,Te as az,Ye as b,Ke as c,Ve as d,Bn as e,Lo as f,le as g,$o as h,ce as i,vo as j,ro as k,Dn as l,Ge as m,eo as n,go as o,oo as p,kn as q,De as r,Je as s,No as t,Kn as u,Yn as v,Jn as w,Vn as x,zn as y,Oo as z};
