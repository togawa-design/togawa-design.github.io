import"./modulepreload-polyfill-YP0FEG5d.js";import{e as n,t as e}from"./utils-DCR9QUau.js";import{g as o,b as s,c as a,f as t,i,d as r,e as l,h as c}from"./jobs-loader-CbBJAmIK.js";import{J as d}from"./index-D_r1cfQj.js";import{a as p}from"./index-DPyR-BYm.js";import{i as h}from"./layout-B-DCeEu1.js";async function b(n){try{const s=await t();if(!s||0===s.length)return void(n.innerHTML='\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">求人している会社一覧</h1>\n          <p class="jobs-page-description">現在、掲載中の求人はありません</p>\n        </div>\n        <div class="jobs-error">\n          <p>求人情報が見つかりませんでした。</p>\n          <a href="/" class="btn-more">トップページに戻る</a>\n        </div>\n      ');const c=s.filter(n=>i(n)).sort((n,e)=>(parseInt(n.order)||999)-(parseInt(e.order)||999));if(0===c.length)return void(n.innerHTML='\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">求人している会社一覧</h1>\n          <p class="jobs-page-description">現在、掲載中の求人はありません</p>\n        </div>\n        <div class="jobs-error">\n          <p>求人情報が見つかりませんでした。</p>\n          <a href="/" class="btn-more">トップページに戻る</a>\n        </div>\n      ');const p=await Promise.all(c.map(async n=>{if(n._displayTotalBonus="",n._displayMonthlySalary=n.monthlySalary||"",n.jobsSheet&&n.jobsSheet.trim()){const e=await r(n.jobsSheet.trim());if(e&&e.length>0){const o=e.filter(n=>"false"!==n.visible&&"FALSE"!==n.visible).filter(n=>a(n)).sort((n,e)=>(parseInt(n.order)||999)-(parseInt(e.order)||999));if(o.length>0){const e=o[0];n._displayTotalBonus=e.totalBonus||"";const s=l(o);s&&(n._displayMonthlySalary=s)}}}return n}));n.innerHTML=`\n      <div class="jobs-page-header">\n        <h1 class="jobs-page-title">求人している会社一覧</h1>\n        <p class="jobs-page-description">${p.length}社の会社が見つかりました</p>\n      </div>\n      <div class="jobs-grid jobs-page-grid">\n        ${p.map(n=>d({job:n})).join("")}\n      </div>\n    `,o=p.length,e("view_jobs_page",{job_count:o,page_location:window.location.href,page_title:document.title})}catch(s){console.error("求人の取得エラー:",s),n.innerHTML='\n      <div class="jobs-error">\n        <p>データの取得に失敗しました。</p>\n        <button onclick="location.reload()">再読み込み</button>\n      </div>\n    '}var o}async function j(t,i,r){try{let l=[],c="";if("keyword"===i?(l=await o(r),c=`「${r}」の検索結果`):"occupation"===i&&(l=await s(r),c=`職種「${r}」の検索結果`),l=l.filter(n=>"false"!==n.visible&&"FALSE"!==n.visible&&a(n)),0===l.length)return void(t.innerHTML=`\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">${n(c)}</h1>\n          <p class="jobs-page-description">該当する求人が見つかりませんでした</p>\n        </div>\n        <div class="jobs-error">\n          <p>条件に一致する求人はありません。</p>\n          <a href="jobs.html" class="btn-more">すべての求人を見る</a>\n        </div>\n      `);t.innerHTML=`\n      <div class="jobs-page-header">\n        <h1 class="jobs-page-title">${n(c)}</h1>\n        <p class="jobs-page-description">${l.length}件の求人が見つかりました</p>\n        <a href="jobs.html" class="filter-clear-link">フィルターを解除</a>\n      </div>\n      <div class="jobs-grid jobs-page-grid">\n        ${l.map(n=>d({job:n,showCompanyName:!0})).join("")}\n      </div>\n    `,e("view_filtered_jobs",{filter_type:i,filter_value:r,result_count:l.length})}catch(l){console.error("フィルタリング求人の取得エラー:",l),t.innerHTML='\n      <div class="jobs-error">\n        <p>データの取得に失敗しました。</p>\n        <button onclick="location.reload()">再読み込み</button>\n      </div>\n    '}}async function g(){const e=document.getElementById("jobs-page-container");if(!e)return;const o=new URLSearchParams(window.location.search),s=o.get("keyword"),a=o.get("occupation");s?await j(e,"keyword",s):a?await j(e,"occupation",a):await b(e),await async function(){const e=document.getElementById("jobs-locations-container");if(e)try{const o=await c();if(!o||0===o.length){const n=document.getElementById("jobs-locations");return void(n&&(n.style.display="none"))}const s=o.slice(0,8);e.innerHTML=`\n      <div class="other-locations-grid">\n        ${s.map(e=>`\n          <a href="location.html?prefecture=${encodeURIComponent(e.prefecture)}" class="other-location-card">\n            <span class="other-location-name">${n(e.prefecture)}</span>\n            <span class="other-location-count">${e.count}件の求人</span>\n          </a>\n        `).join("")}\n      </div>\n      <div class="other-locations-more">\n        <a href="location.html" class="btn-more">すべてのエリアを見る</a>\n      </div>\n    `}catch(o){console.error("勤務地リストの取得エラー:",o),e.innerHTML="<p>データの取得に失敗しました</p>"}}(),p(),h()}document.addEventListener("DOMContentLoaded",()=>{g()});
