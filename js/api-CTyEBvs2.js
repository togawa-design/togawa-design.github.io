import{i as e,o as t,j as n,e as r}from"./firestore-service-N2MxWdK_.js";const o={},s=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in o)return;o[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,n&&s.setAttribute("nonce",n),document.head.appendChild(s),t?new Promise((t,n)=>{s.addEventListener("load",t),s.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},a=r.gasApiUrl,i=new Map;async function c(n){if(!n)return null;const r=Date.now(),o=i.get(n);if(o&&r-o.timestamp<3e5)return o.data;try{e();const o=await t(n);if(o.success&&o.settings&&Object.keys(o.settings).length>0)return i.set(n,{data:o.settings,timestamp:r}),o.settings}catch(s){console.log("[RecruitSettings] Firestore読み込みエラー:",s)}return(null==o?void 0:o.data)||null}async function l(t){try{e();const r=await n(t.companyDomain,t);if(!r.success)throw new Error(r.error||"保存に失敗しました");return t.companyDomain&&i.set(t.companyDomain,{data:t,timestamp:Date.now()}),r}catch(l){throw console.error("[RecruitSettings] Firestore保存エラー:",l),l}const r=btoa(unescape(encodeURIComponent(JSON.stringify({action:"updateRecruitSettings",settings:t})))),o=`${a}?action=post&data=${encodeURIComponent(r)}`,s=await fetch(o,{method:"GET",redirect:"follow"}),c=await s.json();if(!c.success)throw new Error(c.message||c.error||"保存に失敗しました");return t.companyDomain&&i.set(t.companyDomain,{data:t,timestamp:Date.now()}),c}export{s as _,c as l,l as s};
