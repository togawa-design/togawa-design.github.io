import{e}from"./utils-DCR9QUau.js";const t="https://asia-northeast1-generated-area-484613-e3-90bd4.cloudfunctions.net";async function n(e,n){const a=new URLSearchParams({companyDomain:e,companyUserId:n}),i=await fetch(`${t}/getCalendarIntegration?${a}`);if(!i.ok){const e=await i.json();throw new Error(e.error||"é€£æºæƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")}return i.json()}function a(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function i(e){return["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"][e.getDay()]}const s={apiKey:"AIzaSyB3eXZoFkXOwnHxPvaHiWO7csmZK4KGqAQ",authDomain:"generated-area-484613-e3-90bd4.firebaseapp.com",projectId:"generated-area-484613-e3-90bd4"};let l=null,o=null,c=[],r=[],d=1;let u=null,p=[],v={},m=[],g={},f=null,y=null,h="";function w(e){return document.getElementById(h+e)}const b={new:"æ–°è¦",contacted:"é€£çµ¡æ¸ˆã¿",interviewing:"é¢æ¥èª¿æ•´ä¸­",interviewed:"é¢æ¥æ¸ˆã¿",hired:"æ¡ç”¨",joined:"å…¥ç¤¾",pending:"ä¿ç•™",ng:"NG",rejected:"ä¸æ¡ç”¨",withdrawn:"è¾é€€"},$={apply:"å¿œå‹Ÿ",line:"LINEç›¸è«‡",consult:"ãŠå•ã„åˆã‚ã›"},L={immediate:"ã™ãã«ã§ã‚‚","within-week":"1é€±é–“ä»¥å†…","within-month":"1ãƒ¶æœˆä»¥å†…","within-2months":"2ãƒ¶æœˆä»¥å†…",undecided:"æœªå®šãƒ»ç›¸è«‡ã—ãŸã„"},D={first_contact:{subject:"åˆå›é€£çµ¡",body:"{applicantName}æ§˜\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã«ã”å¿œå‹Ÿã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\n\nã”å¿œå‹Ÿå†…å®¹ã‚’ç¢ºèªã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚\nã¤ãã¾ã—ã¦ã¯ã€ä¸€åº¦ãŠé›»è©±ã«ã¦ãŠè©±ã‚’ã•ã›ã¦ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚\n\nã”éƒ½åˆã®è‰¯ã„æ—¥æ™‚ã‚’ã„ãã¤ã‹ãŠçŸ¥ã‚‰ã›ã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\nï¼ˆå¹³æ—¥10:00ã€œ18:00ã®é–“ã§ãŠé¡˜ã„ã§ãã¾ã™ã¨å¹¸ã„ã§ã™ï¼‰\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},schedule_interview:{subject:"é¢æ¥æ—¥ç¨‹èª¿æ•´",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¢æ¥ã®æ—¥ç¨‹èª¿æ•´ã«ã¤ã„ã¦ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚\n\nä¸‹è¨˜ã®æ—¥ç¨‹ã§ã”éƒ½åˆã®è‰¯ã„æ—¥æ™‚ã¯ã”ã–ã„ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\n\nã€å€™è£œæ—¥ã€‘\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\n\nä¸Šè¨˜ä»¥å¤–ã§ã‚‚ã”èª¿æ•´å¯èƒ½ã§ã™ã®ã§ã€ã”å¸Œæœ›ã®æ—¥æ™‚ãŒã”ã–ã„ã¾ã—ãŸã‚‰ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚\n\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},interview_reminder:{subject:"é¢æ¥ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¢æ¥æ—¥ç¨‹ã®ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’ãŠé€ã‚Šã„ãŸã—ã¾ã™ã€‚\n\nã€é¢æ¥æ—¥æ™‚ã€‘â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nã€å ´æ‰€ã€‘ã€’â—¯â—¯â—¯-â—¯â—¯â—¯â—¯ â—¯â—¯çœŒâ—¯â—¯å¸‚â—¯â—¯\nã€æŒã¡ç‰©ã€‘å±¥æ­´æ›¸ã€ç­†è¨˜ç”¨å…·\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nå½“æ—¥ãŠä¼šã„ã§ãã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚"},document_request:{subject:"æ›¸é¡æå‡ºä¾é ¼",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¸è€ƒã‚’é€²ã‚ã‚‹ã«ã‚ãŸã‚Šã€ä¸‹è¨˜ã®æ›¸é¡ã‚’ã”æå‡ºã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\n\nã€æå‡ºæ›¸é¡ã€‘\nãƒ»å±¥æ­´æ›¸ï¼ˆå†™çœŸè²¼ä»˜ï¼‰\nãƒ»è·å‹™çµŒæ­´æ›¸\n\nã€æå‡ºæ–¹æ³•ã€‘\nãƒã‚¤ãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã«ã¦ã”é€ä»˜ãã ã•ã„ã€‚\n\nã€æå‡ºæœŸé™ã€‘\nâ—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰ã¾ã§\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},result_pending:{subject:"é¸è€ƒçµæœå¾…ã¡",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nå…ˆæ—¥ã¯é¢æ¥ã«ãŠè¶Šã—ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\nç¾åœ¨ã€ç¤¾å†…ã«ã¦é¸è€ƒã‚’é€²ã‚ã¦ãŠã‚Šã¾ã™ã€‚\nçµæœã«ã¤ãã¾ã—ã¦ã¯ã€â—¯æœˆâ—¯æ—¥é ƒã¾ã§ã«ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãäºˆå®šã§ã™ã€‚\n\nä»Šã—ã°ã‚‰ããŠå¾…ã¡ã„ãŸã ã‘ã¾ã™ã‚ˆã†ãŠé¡˜ã„ç”³ã—ä¸Šã’ã¾ã™ã€‚"},offer:{subject:"å†…å®šé€šçŸ¥",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã®é¸è€ƒã«ã”å‚åŠ ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\næ…é‡ã«æ¤œè¨ã•ã›ã¦ã„ãŸã ã„ãŸçµæœã€{applicantName}æ§˜ã‚’æ¡ç”¨ã•ã›ã¦ã„ãŸã ãã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚\n\nã¤ãã¾ã—ã¦ã¯ã€å…¥ç¤¾ã«é–¢ã™ã‚‹è©³ç´°ã«ã¤ã„ã¦ã”èª¬æ˜ã•ã›ã¦ã„ãŸã ããŸãã€\nãŠé›»è©±ã«ã¦ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\n{applicantName}æ§˜ã¨ä¸€ç·’ã«åƒã‘ã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚"},rejection:{subject:"ä¸æ¡ç”¨é€šçŸ¥",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã«ã”å¿œå‹Ÿã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\næ…é‡ã«æ¤œè¨ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸãŒã€èª ã«æ®‹å¿µãªãŒã‚‰ä»Šå›ã¯ã”æœŸå¾…ã«æ²¿ãˆãªã„çµæœã¨ãªã‚Šã¾ã—ãŸã€‚\n\nã”å¿œå‹Ÿã„ãŸã ã„ãŸã“ã¨ã«å¿ƒã‚ˆã‚Šæ„Ÿè¬ç”³ã—ä¸Šã’ã¾ã™ã¨ã¨ã‚‚ã«ã€\n{applicantName}æ§˜ã®ä»Šå¾Œã®ã”æ´»èºã‚’ãŠç¥ˆã‚Šç”³ã—ä¸Šã’ã¾ã™ã€‚"}};function E(){return firebase.apps.length||firebase.initializeApp(s),firebase.firestore()}async function k(){try{const e=E(),t=await e.collection("company_users").where("companyDomain","==",l).where("isActive","==",!0).get();return m=[],t.forEach(e=>{m.push({id:e.id,...e.data()})}),await async function(){g={};for(const t of m)try{const e=await n(l,t.id);e.integration&&(g[t.id]=e.integration)}catch(e){console.log(`No calendar integration for user ${t.id}`)}}(),m}catch(e){return console.error("Failed to load company users:",e),[]}}function S(e){const t=document.querySelector(".applicants-content"),n=w("settings-section"),a=w("page-title"),i=document.querySelector(".header-actions");if("settings"===e){t&&(t.style.display="none"),n&&(n.style.display="block"),a&&(a.textContent="è¨­å®š"),i&&(i.style.display="none"),document.querySelectorAll(".sidebar-nav li").forEach(e=>{e.classList.remove("active")});const e=document.getElementById("nav-settings");e&&e.closest("li").classList.add("active"),x()}else{t&&(t.style.display="flex"),n&&(n.style.display="none"),a&&(a.textContent="å¿œå‹Ÿè€…ä¸€è¦§"),i&&(i.style.display="flex"),document.querySelectorAll(".sidebar-nav li").forEach(e=>{e.classList.remove("active")});const e=document.querySelector('[data-section="applicants"]');e&&e.closest("li").classList.add("active")}}function x(){const a=w("calendar-integrations-list");a&&(0!==m.length?(a.innerHTML=m.map(t=>{const n=g[t.id],a=n&&n.isActive;return`\n      <div class="calendar-integration-item" data-user-id="${e(t.id)}">\n        <div class="calendar-integration-info">\n          <div class="calendar-integration-icon">ğŸ‘¤</div>\n          <div class="calendar-integration-details">\n            <h4>${e(t.name||t.username)}</h4>\n            <p>${a?e(n.googleEmail):"æœªé€£æº"}</p>\n          </div>\n        </div>\n        <div class="calendar-integration-actions">\n          ${a?`<span class="calendar-status connected">é€£æºä¸­</span>\n               <button class="btn-disconnect-calendar" data-user-id="${e(t.id)}">è§£é™¤</button>`:`<button class="btn-connect-calendar" data-user-id="${e(t.id)}" data-user-name="${e(t.name||t.username)}">\n                 <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"/></svg>\n                 Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«é€£æº\n               </button>`}\n        </div>\n      </div>\n    `}).join(""),a.querySelectorAll(".btn-connect-calendar").forEach(e=>{e.addEventListener("click",()=>{!async function(e,a){try{const i=await async function(e,n,a){const i=await fetch(`${t}/initiateCalendarAuth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyDomain:e,companyUserId:n,staffName:a})});if(!i.ok){const e=await i.json();throw new Error(e.error||"èªè¨¼URLã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")}return i.json()}(l,e,a);window.open(i.authUrl,"calendar-auth","width=600,height=700");let s=0;const o=10,c=setInterval(async()=>{s++;try{const t=await n(l,e);t.integration&&t.integration.isActive&&(clearInterval(c),g[e]=t.integration,x(),alert("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºãŒå®Œäº†ã—ã¾ã—ãŸ"))}catch(t){}s>=o&&clearInterval(c)},3e3)}catch(i){console.error("Failed to initiate calendar auth:",i),alert("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ: "+i.message)}}(e.dataset.userId,e.dataset.userName)})}),a.querySelectorAll(".btn-disconnect-calendar").forEach(e=>{e.addEventListener("click",()=>{!async function(e){if(!confirm("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ"))return;try{await async function(e,n){const a=await fetch(`${t}/revokeCalendarAuth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyDomain:e,companyUserId:n})});if(!a.ok){const e=await a.json();throw new Error(e.error||"é€£æºè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ")}return a.json()}(l,e),delete g[e],x(),alert("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã‚’è§£é™¤ã—ã¾ã—ãŸ")}catch(n){console.error("Failed to revoke calendar auth:",n),alert("é€£æºè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: "+n.message)}}(e.dataset.userId)})})):a.innerHTML='<p class="no-data">æ‹…å½“è€…ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>ç®¡ç†ç”»é¢ã‹ã‚‰æ‹…å½“è€…ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚</p>')}async function A(){if(!u)return;const t=w("interview-modal");if(!t)return;const n=w("interview-staff");n&&(n.innerHTML='<option value="">æ‹…å½“è€…ã‚’é¸æŠ...</option>'+m.map(t=>{const n=g[t.id],a=(null==n?void 0:n.isActive)?" (ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºæ¸ˆ)":"";return`<option value="${e(t.id)}" data-has-calendar="${(null==n?void 0:n.isActive)?"true":"false"}">${e(t.name||t.username)}${a}</option>`}).join("")),y=null,f=function(e){const t=new Date(e),n=t.getDay(),a=t.getDate()-n+(0===n?-6:1);return t.setDate(a),t.setHours(0,0,0,0),t}(new Date),w("availability-section").style.display="none",w("selected-slot-section").style.display="none",w("manual-datetime-section").style.display="block",w("calendar-status-hint").textContent="",t.style.display="flex"}function T(){const e=w("interview-modal");e&&(e.style.display="none")}async function j(){var e;const t=w("interview-staff"),n=t.options[t.selectedIndex],a="true"===(null==(e=null==n?void 0:n.dataset)?void 0:e.hasCalendar),i=t.value,s=w("availability-section"),l=w("manual-datetime-section"),o=w("calendar-status-hint");if(!i)return s.style.display="none",l.style.display="block",void(o.textContent="");a?(s.style.display="block",l.style.display="none",o.textContent="æ‹…å½“è€…ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰ç©ºãæ™‚é–“ã‚’å–å¾—ã—ã¾ã™",o.style.color="#10b981",await C(i)):(s.style.display="none",l.style.display="block",o.textContent="ã“ã®æ‹…å½“è€…ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœªé€£æºã§ã™ã€‚æ‰‹å‹•ã§æ—¥æ™‚ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",o.style.color="#f59e0b")}async function C(n){const s=w("availability-grid");if(s){s.innerHTML='<div class="loading-message">ç©ºãæ™‚é–“ã‚’å–å¾—ä¸­...</div>';try{const s=new Date(f);s.setDate(s.getDate()+6);const o=a(f),c=a(s),r=await async function(e,n,a,i){const s=new URLSearchParams({companyDomain:e,companyUserId:n,startDate:a,endDate:i}),l=await fetch(`${t}/getCalendarAvailability?${s}`);if(!l.ok){const e=await l.json();throw new Error(e.error||"ç©ºãæ™‚é–“ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")}return l.json()}(l,n,o,c);!function(t){const n=w("availability-grid");if(!n)return;const s={},l=[];for(let e=0;e<5;e++){const t=new Date(f);t.setDate(t.getDate()+e);const n=a(t);l.push({date:t,dateStr:n}),s[n]=[]}t.forEach(e=>{const t=e.start.split("T")[0];s[t]&&s[t].push(e)}),n.innerHTML=l.map(({date:t,dateStr:n})=>{const a=s[n]||[];return`\n      <div class="availability-day">\n        <div class="availability-day-header">\n          <span class="day-name">${i(t)}</span>\n          <span class="day-date">${`${t.getMonth()+1}/${t.getDate()}`}</span>\n        </div>\n        <div class="availability-slots">\n          ${a.length>0?a.map(t=>{const n=new Date(t.start),a=`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`,i=t.start;return`<button class="slot-btn ${y===i?"selected":""}" data-slot="${e(i)}">${a}</button>`}).join(""):'<p class="no-slots">ç©ºããªã—</p>'}\n        </div>\n      </div>\n    `}).join(""),n.querySelectorAll(".slot-btn").forEach(e=>{e.addEventListener("click",()=>{!function(e){y=e,document.querySelectorAll(".slot-btn").forEach(t=>{t.classList.toggle("selected",t.dataset.slot===e)});const t=w("selected-slot-section"),n=w("selected-slot");if(t&&n){const a=new Date(e),s=i(a),l=`${a.getFullYear()}å¹´${a.getMonth()+1}æœˆ${a.getDate()}æ—¥(${s})`,o=`${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`;n.textContent=`${l} ${o}`,t.style.display="block"}}(e.dataset.slot)})})}(r.availableSlots||[]),function(){const e=w("week-label");if(!e||!f)return;const t=new Date(f);t.setDate(t.getDate()+6);const n=`${f.getMonth()+1}/${f.getDate()}`,a=`${t.getMonth()+1}/${t.getDate()}`;e.textContent=`${f.getFullYear()}å¹´ ${n} - ${a}`}()}catch(o){console.error("Failed to load availability:",o),s.innerHTML='<div class="empty-message">ç©ºãæ™‚é–“ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</div>'}}}function M(){f.setDate(f.getDate()-7);const e=w("interview-staff");(null==e?void 0:e.value)&&C(e.value)}function I(){f.setDate(f.getDate()+7);const e=w("interview-staff");(null==e?void 0:e.value)&&C(e.value)}async function H(){var e,n,a,i,s,o,r,d;const p=w("interview-staff"),v=null==p?void 0:p.value;if(!v)return void alert("æ‹…å½“è€…ã‚’é¸æŠã—ã¦ãã ã•ã„");const g=p.options[p.selectedIndex];let f;if("true"===(null==(e=null==g?void 0:g.dataset)?void 0:e.hasCalendar)&&y)f=new Date(y);else{const e=w("interview-datetime");if(!(null==e?void 0:e.value))return void alert("é¢è«‡æ—¥æ™‚ã‚’é¸æŠã—ã¦ãã ã•ã„");f=new Date(e.value)}const h=parseInt((null==(n=w("interview-duration"))?void 0:n.value)||"60"),b=(null==(a=document.querySelector('input[name="meeting-type"]:checked'))?void 0:a.value)||"in_person",$=(null==(i=w("interview-location"))?void 0:i.value)||"",L=[];(null==(s=w("send-reminder-1day"))?void 0:s.checked)&&L.push({offsetMinutes:1440,sendTime:"10:00"}),(null==(o=w("send-reminder-1hour"))?void 0:o.checked)&&L.push({offsetMinutes:60});const D=c.find(e=>e.id===u);if(!D)return;const k=m.find(e=>e.id===v),S=w("interview-modal-save");S&&(S.disabled=!0,S.textContent="ç™»éŒ²ä¸­...");try{const e=await async function(e){const n=await fetch(`${t}/createCalendarEvent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const e=await n.json();throw new Error(e.error||"ã‚¤ãƒ™ãƒ³ãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}return n.json()}({companyDomain:l,companyUserId:v,applicationId:u,applicantName:D.applicantName||(null==(r=D.applicant)?void 0:r.name)||"å¿œå‹Ÿè€…",applicantEmail:D.applicantEmail||(null==(d=D.applicant)?void 0:d.email)||"",staffName:(null==k?void 0:k.name)||(null==k?void 0:k.username)||"æ‹…å½“è€…",scheduledAt:f.toISOString(),durationMinutes:h,meetingType:b,location:$,reminders:L}),n=E();await n.collection("applications").doc(u).update({status:"interviewing",interviewId:e.interviewId,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const a=c.findIndex(e=>e.id===u);-1!==a&&(c[a].status="interviewing",c[a].interviewId=e.interviewId),T(),Y(u),P(),B(),alert("é¢è«‡ã‚’ç™»éŒ²ã—ã¾ã—ãŸã€‚æ‹…å½“è€…ã®Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«äºˆå®šãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚")}catch(x){console.error("Failed to save interview:",x),alert("é¢è«‡ã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: "+x.message)}finally{S&&(S.disabled=!1,S.textContent="é¢è«‡ã‚’ç™»éŒ²")}}async function N(){try{const e=E().collection("settings").doc(l||"global"),t=await e.get();p=t.exists&&t.data().assignees?t.data().assignees:[],F()}catch(e){console.error("Failed to load assignees:",e),p=[]}}function F(){const t=w("detail-assignee");if(t){const n=t.value;t.innerHTML='<option value="">æœªå‰²å½“</option>'+p.map(t=>`<option value="${e(t)}">${e(t)}</option>`).join(""),t.value=n}}async function q(){var e;const t=w("new-assignee-name"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(n)if(p.includes(n))alert("ã“ã®æ‹…å½“è€…ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™");else try{const e=E().collection("settings").doc(l||"global");p.push(n),await e.set({assignees:p,updatedAt:firebase.firestore.FieldValue.serverTimestamp()},{merge:!0}),F(),R();const t=w("detail-assignee");t&&(t.value=n)}catch(a){console.error("Failed to add assignee:",a),alert("æ‹…å½“è€…ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}else alert("æ‹…å½“è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")}function U(){const e=w("assignee-modal"),t=w("new-assignee-name");e&&(e.style.display="flex"),t&&(t.value="",t.focus())}function R(){const e=w("assignee-modal");e&&(e.style.display="none")}async function O(){const e=w("applicants-list");e&&(e.innerHTML='<div class="loading-message">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>');try{let e=E().collection("applications");l&&(e=e.where("companyDomain","==",l)),e=e.orderBy("createdAt","desc");const t=await e.get();c=[],t.forEach(e=>{c.push({id:e.id,...e.data()})}),v={},c.forEach(e=>{var t,n;const a=e.applicantPhone||(null==(t=e.applicant)?void 0:t.phone),i=e.applicantEmail||(null==(n=e.applicant)?void 0:n.email);if(a){const t=a.replace(/[-\s]/g,"");v[t]||(v[t]=[]),v[t].push(e)}if(i){const t=i.toLowerCase().trim();v[t]||(v[t]=[]),v[t].push(e)}}),P(),B()}catch(t){console.error("Failed to load applicants:",t),e&&(e.innerHTML='<div class="empty-message">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>')}}function P(){var e,t,n,a;const i=(null==(e=w("filter-status"))?void 0:e.value)||"",s=(null==(t=w("filter-type"))?void 0:t.value)||"",l=(null==(a=null==(n=w("filter-search"))?void 0:n.value)?void 0:a.toLowerCase())||"";r=c.filter(e=>{var t;if(i&&(e.status||"new")!==i)return!1;if(s&&e.type!==s)return!1;if(l){const n=(e.jobTitle||"").toLowerCase(),a=(e.applicantName||(null==(t=e.applicant)?void 0:t.name)||"").toLowerCase();if(!n.includes(l)&&!a.includes(l))return!1}return!0}),d=1,_(),V()}function B(){const e=c.length,t=c.filter(e=>!e.status||"new"===e.status).length,n=c.filter(e=>["contacted","interviewing","interviewed","pending"].includes(e.status)).length,a=c.filter(e=>["hired","joined","ng","rejected","withdrawn"].includes(e.status)).length,i=w("stat-total"),s=w("stat-new"),l=w("stat-progress"),o=w("stat-complete");i&&(i.textContent=e),s&&(s.textContent=t),l&&(l.textContent=n),o&&(o.textContent=a)}function _(){const t=w("applicants-list");if(!t)return;if(0===r.length)return void(t.innerHTML='<div class="empty-message">å¿œå‹Ÿãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>');const n=20*(d-1),a=n+20,i=r.slice(n,a);t.innerHTML=i.map(t=>{var n,a;const i=W((null==(n=t.createdAt)?void 0:n.toDate)?t.createdAt.toDate():new Date(t.timestamp||t.createdAt)),s=t.status||"new",l=$[t.type]||t.type||"-",o=b[s]||s,c=t.applicantName||(null==(a=t.applicant)?void 0:a.name)||"-",r=u===t.id;let d="type-apply";"line"===t.type&&(d="type-line"),"consult"===t.type&&(d="type-consult");const p=function(e){var t,n,a;const i=e.applicantPhone||(null==(t=e.applicant)?void 0:t.phone),s=e.applicantEmail||(null==(n=e.applicant)?void 0:n.email);let l=[];if(i){const e=i.replace(/[-\s]/g,""),t=v[e]||[];l=l.concat(t)}if(s){const e=s.toLowerCase().trim(),t=v[e]||[];l=l.concat(t)}const o=[...new Map(l.map(e=>[e.id,e])).values()].filter(t=>t.id!==e.id),c=(null==(a=e.createdAt)?void 0:a.toDate)?e.createdAt.toDate():new Date(e.timestamp||e.createdAt),r=o.filter(e=>{var t;return((null==(t=e.createdAt)?void 0:t.toDate)?e.createdAt.toDate():new Date(e.timestamp||e.createdAt))<c});return{isReapply:r.length>0,hasNgHistory:r.some(e=>"ng"===e.status||"rejected"===e.status),previousApps:r}}(t);let m="";return p.hasNgHistory?m+='<span class="duplicate-badge badge-ng-history">NGå±¥æ­´</span>':p.isReapply&&(m+='<span class="duplicate-badge badge-reapply">å†å¿œå‹Ÿ</span>'),`\n      <div class="applicant-card ${r?"selected":""}" data-id="${e(t.id)}">\n        <div class="applicant-card-main">\n          <div class="applicant-card-header">\n            <span class="applicant-card-name">${e(c)}</span>\n            <span class="applicant-card-type ${d}">${e(l)}</span>\n            ${m}\n          </div>\n          <div class="applicant-card-job">${e(t.jobTitle||"-")}</div>\n          <div class="applicant-card-meta">\n            <span>${e(i)}</span>\n            ${t.assignee?`<span>æ‹…å½“: ${e(t.assignee)}</span>`:""}\n          </div>\n        </div>\n        <div class="applicant-card-status">\n          <span class="status-badge status-${e(s)}">${e(o)}</span>\n        </div>\n      </div>\n    `}).join(""),t.querySelectorAll(".applicant-card").forEach(e=>{e.addEventListener("click",()=>{Y(e.dataset.id)})})}function V(){const e=w("pagination");if(!e)return;const t=Math.ceil(r.length/20);if(t<=1)return void(e.innerHTML="");let n="";n+=`<button class="page-btn" ${1===d?"disabled":""} data-page="${d-1}">å‰ã¸</button>`;for(let a=1;a<=t;a++)1===a||a===t||a>=d-2&&a<=d+2?n+=`<button class="page-btn ${a===d?"active":""}" data-page="${a}">${a}</button>`:a!==d-3&&a!==d+3||(n+='<span class="page-ellipsis">...</span>');n+=`<button class="page-btn" ${d===t?"disabled":""} data-page="${d+1}">æ¬¡ã¸</button>`,e.innerHTML=n,e.querySelectorAll(".page-btn").forEach(e=>{e.addEventListener("click",()=>{e.disabled||(d=parseInt(e.dataset.page),_(),V())})})}function Y(t){var n,a,s,l,o,r,d;const p=c.find(e=>e.id===t);if(!p)return;u=t,document.querySelectorAll(".applicant-card").forEach(e=>{e.classList.toggle("selected",e.dataset.id===t)});const v=w("detail-empty"),m=w("detail-content");v&&(v.style.display="none"),m&&(m.style.display="flex");const g=p.applicantName||(null==(n=p.applicant)?void 0:n.name)||"-",f=p.applicantPhone||(null==(a=p.applicant)?void 0:a.phone)||"-",y=p.applicantEmail||(null==(s=p.applicant)?void 0:s.email)||"-",h=(null==(l=p.applicant)?void 0:l.age)||"-",b=(null==(o=p.applicant)?void 0:o.address)||"-",D=(null==(r=p.applicant)?void 0:r.startDate)||"-";w("detail-name").textContent=g,w("detail-job-title").textContent=p.jobTitle||"-",w("detail-phone").textContent=f,w("detail-email").textContent=y,w("detail-age").textContent=h,w("detail-address").textContent=b,w("detail-start-date").textContent=L[D]||D;const k=(null==(d=p.createdAt)?void 0:d.toDate)?p.createdAt.toDate():new Date(p.timestamp||p.createdAt);w("detail-datetime").textContent=W(k,!0),w("detail-type").textContent=$[p.type]||p.type||"-",w("detail-source").textContent=ee(p.source);const S=p.status||"new";document.querySelectorAll(".status-btn").forEach(e=>{e.classList.toggle("active",e.dataset.status===S)});const x=w("detail-assignee");x&&(x.value=p.assignee||"");const A=w("detail-notes");A&&(A.value=p.notes||""),J(p.history||[]),K(t),async function(t){var n;const a=w("interview-info");if(!a)return;const s=c.find(e=>e.id===t);if(null==s?void 0:s.interviewId)try{const t=E(),l=await t.collection("interviews").doc(s.interviewId).get();if(!l.exists)return void(a.innerHTML='<p class="no-data">é¢è«‡ã¯è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>');const o=l.data(),c=(null==(n=o.scheduledAt)?void 0:n.toDate)?o.scheduledAt.toDate():new Date(o.scheduledAt),r=i(c),d={in_person:"å¯¾é¢",online:"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³",phone:"é›»è©±"};a.innerHTML=`\n      <div class="interview-scheduled">\n        <h4>é¢è«‡äºˆå®š</h4>\n        <p><strong>æ—¥æ™‚:</strong> ${c.getFullYear()}å¹´${c.getMonth()+1}æœˆ${c.getDate()}æ—¥(${r}) ${String(c.getHours()).padStart(2,"0")}:${String(c.getMinutes()).padStart(2,"0")}</p>\n        <p><strong>æ‹…å½“è€…:</strong> ${e(o.staffName||"-")}</p>\n        <p><strong>å½¢å¼:</strong> ${d[o.meetingType]||o.meetingType}</p>\n        ${o.location?`<p><strong>å ´æ‰€:</strong> ${e(o.location)}</p>`:""}\n      </div>\n    `}catch(l){console.error("Failed to load interview info:",l),a.innerHTML='<p class="no-data">é¢è«‡æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</p>'}else a.innerHTML='<p class="no-data">é¢è«‡ã¯è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>'}(t)}function G(){u=null,document.querySelectorAll(".applicant-card").forEach(e=>{e.classList.remove("selected")});const e=w("detail-empty"),t=w("detail-content");e&&(e.style.display="flex"),t&&(t.style.display="none")}async function K(t){const n=w("messages-container");if(n){n.innerHTML='<p class="no-data">èª­ã¿è¾¼ã¿ä¸­...</p>';try{const n=E(),a=await n.collection("messages").where("applicationId","==",t).orderBy("createdAt","asc").get(),i=[];a.forEach(e=>{i.push({id:e.id,...e.data()})}),function(t){const n=w("messages-container");if(!n)return;if(!t||0===t.length)return void(n.innerHTML='<p class="no-data">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚ã‚Šã¾ã›ã‚“</p>');n.innerHTML=t.map(t=>{var n;const a=(null==(n=t.createdAt)?void 0:n.toDate)?t.createdAt.toDate():new Date(t.createdAt),i="company"===t.from;return`\n      <div class="message-item ${i?"message-company":"message-applicant"}">\n        <div class="message-header">\n          <span class="message-sender">${e(i?"ä¼šç¤¾":"å¿œå‹Ÿè€…")}</span>\n          <span class="message-date">${W(a,!0)}</span>\n        </div>\n        <div class="message-content">${e(t.content).replace(/\n/g,"<br>")}</div>\n      </div>\n    `}).join(""),n.scrollTop=n.scrollHeight}(i)}catch(a){console.error("Failed to load messages:",a),n.innerHTML='<p class="no-data">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p>'}}}async function z(){var e;if(!u)return;const t=w("new-message-text"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(!n)return void alert("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");const a=w("btn-send-message");a&&(a.disabled=!0,a.textContent="é€ä¿¡ä¸­...");try{const e=E(),a=c.find(e=>e.id===u);await e.collection("messages").add({applicationId:u,companyDomain:(null==a?void 0:a.companyDomain)||l,from:"company",content:n,read:!1,createdAt:firebase.firestore.FieldValue.serverTimestamp()}),t.value="",await K(u)}catch(i){console.error("Failed to send message:",i),alert("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ: "+i.message)}finally{a&&(a.disabled=!1,a.textContent="é€ä¿¡")}}function J(t){const n=w("detail-history");n&&(t&&0!==t.length?n.innerHTML=t.map(t=>{var n;return`\n      <div class="history-item">\n        <div class="history-date">${W((null==(n=t.date)?void 0:n.toDate)?t.date.toDate():new Date(t.date),!0)}</div>\n        <div class="history-text">${e(t.text)}</div>\n      </div>\n    `}).join(""):n.innerHTML='<p class="no-data">å¯¾å¿œå±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“</p>')}async function X(){var e,t;if(!u)return;const n=(null==(e=w("detail-notes"))?void 0:e.value)||"",a=(null==(t=w("detail-assignee"))?void 0:t.value)||"",i=w("btn-save-notes");i&&(i.disabled=!0,i.textContent="ä¿å­˜ä¸­...");try{const e=E();await e.collection("applications").doc(u).update({notes:n,assignee:a,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const t=c.findIndex(e=>e.id===u);-1!==t&&(c[t].notes=n,c[t].assignee=a),_()}catch(s){console.error("Failed to save notes:",s),alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{i&&(i.disabled=!1,i.textContent="ä¿å­˜")}}async function Z(){var e;if(!u)return;const t=w("new-history-text"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(n)try{const e=E(),a=c.find(e=>e.id===u),i=(null==a?void 0:a.history)||[];i.push({date:new Date,text:n}),await e.collection("applications").doc(u).update({history:i,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const s=c.findIndex(e=>e.id===u);-1!==s&&(c[s].history=i),J(i),t.value=""}catch(a){console.error("Failed to add history:",a),alert("å±¥æ­´ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}else alert("å¯¾å¿œå†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")}function Q(){if(0===r.length)return void alert("ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");const e=r.map(e=>{var t,n,a,i,s,l,o;const c=(null==(t=e.createdAt)?void 0:t.toDate)?e.createdAt.toDate():new Date(e.timestamp||e.createdAt),r=e.applicantName||(null==(n=e.applicant)?void 0:n.name)||"",d=e.applicantPhone||(null==(a=e.applicant)?void 0:a.phone)||"",u=e.applicantEmail||(null==(i=e.applicant)?void 0:i.email)||"",p=(null==(s=e.applicant)?void 0:s.age)||"",v=(null==(l=e.applicant)?void 0:l.address)||"",m=(null==(o=e.applicant)?void 0:o.startDate)||"";return[W(c,!0),$[e.type]||e.type||"",r,d,u,p,v,L[m]||m,e.jobTitle||"",ee(e.source),b[e.status||"new"],e.assignee||"",(e.notes||"").replace(/"/g,'""')]}),t=[["æ—¥æ™‚","ç¨®åˆ¥","å¿œå‹Ÿè€…å","é›»è©±ç•ªå·","ãƒ¡ãƒ¼ãƒ«","å¹´é½¢","ç¾ä½æ‰€","å¸Œæœ›å‹¤å‹™é–‹å§‹æ—¥","æ±‚äººã‚¿ã‚¤ãƒˆãƒ«","æµå…¥å…ƒ","ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹","æ‹…å½“è€…","ãƒ¡ãƒ¢"].join(","),...e.map(e=>e.map(e=>`"${e}"`).join(","))].join("\n"),n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=`applicants-${l||"all"}-${function(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}${n}${a}`}(new Date)}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}function W(e,t=!1){if(!e||isNaN(e.getTime()))return"-";const n=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");if(!t)return`${n}/${a}/${i}`;return`${n}/${a}/${i} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}function ee(e){if(!e||"direct"===e)return"ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹";try{const t=new URL(e).hostname;return t.includes("google")?"Googleæ¤œç´¢":t.includes("yahoo")?"Yahoo!æ¤œç´¢":t.includes("tiktok")?"TikTokåºƒå‘Š":t.includes("instagram")||t.includes("fb")||t.includes("facebook")?"Metaåºƒå‘Š":t.includes("twitter")||t.includes("x.com")?"X(Twitter)":t.includes("line")?"LINE":t}catch{return e||"ä¸æ˜"}}function te(){var e,t,n,a,i,s,l,o,r,d,p,v,m,g,f,y,h,b,$,L,k,x,C,N,F,_,V,Y,K,J;let W;null==(e=w("btn-refresh"))||e.addEventListener("click",O),null==(t=w("btn-refresh-applicants"))||t.addEventListener("click",O),null==(n=w("btn-export-csv"))||n.addEventListener("click",Q),null==(a=w("filter-status"))||a.addEventListener("change",P),null==(i=w("filter-type"))||i.addEventListener("change",P),null==(s=w("filter-search"))||s.addEventListener("input",()=>{clearTimeout(W),W=setTimeout(P,300)}),null==(l=w("btn-close-detail"))||l.addEventListener("click",G),document.querySelectorAll(".status-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.status;t&&async function(e){if(u)try{const t=E();await t.collection("applications").doc(u).update({status:e,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const n=c.findIndex(e=>e.id===u);-1!==n&&(c[n].status=e),document.querySelectorAll(".status-btn").forEach(t=>{t.classList.toggle("active",t.dataset.status===e)}),P(),B()}catch(t){console.error("Failed to update status:",t),alert("ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ")}}(t)})}),null==(o=w("btn-save-notes"))||o.addEventListener("click",X),null==(r=w("btn-add-history"))||r.addEventListener("click",Z),null==(d=w("new-history-text"))||d.addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),Z())}),null==(p=w("btn-send-message"))||p.addEventListener("click",z),null==(v=w("new-message-text"))||v.addEventListener("keydown",e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),z())}),null==(m=w("message-template-select"))||m.addEventListener("change",e=>{!function(e){var t;if(!e)return;const n=D[e];if(!n)return;const a=c.find(e=>e.id===u);if(!a)return;const i=a.applicantName||(null==(t=a.applicant)?void 0:t.name)||"ãŠå®¢æ§˜",s=a.jobTitle||"æ±‚äºº";let l=n.body.replace(/{applicantName}/g,i).replace(/{jobTitle}/g,s);const o=w("new-message-text");o&&(o.value=l,o.focus());const r=w("message-template-select");r&&(r.value="")}(e.target.value)}),null==(g=w("btn-add-assignee"))||g.addEventListener("click",U),null==(f=w("assignee-modal-close"))||f.addEventListener("click",R),null==(y=w("assignee-modal-cancel"))||y.addEventListener("click",R),null==(h=w("assignee-modal-save"))||h.addEventListener("click",q),null==(b=w("assignee-modal"))||b.addEventListener("click",e=>{e.target.classList.contains("modal-overlay")&&R()}),null==($=w("new-assignee-name"))||$.addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),q())}),null==(L=document.getElementById("nav-settings"))||L.addEventListener("click",e=>{e.preventDefault(),S("settings")}),null==(k=w("btn-back-to-applicants"))||k.addEventListener("click",()=>{S("applicants")}),null==(x=w("btn-schedule-interview"))||x.addEventListener("click",A),null==(C=w("interview-modal-close"))||C.addEventListener("click",T),null==(N=w("interview-modal-cancel"))||N.addEventListener("click",T),null==(F=w("interview-modal-save"))||F.addEventListener("click",H),null==(_=w("interview-modal"))||_.addEventListener("click",e=>{e.target.classList.contains("modal-overlay")&&T()}),null==(V=w("interview-staff"))||V.addEventListener("change",j),null==(Y=w("btn-prev-week"))||Y.addEventListener("click",M),null==(K=w("btn-next-week"))||K.addEventListener("click",I),null==(J=w("btn-save-reminder-settings"))||J.addEventListener("click",ne)}async function ne(){var e,t,n;try{const a=E(),i={reminder1Day:(null==(e=w("reminder-1day"))?void 0:e.checked)||!1,reminder1DayTime:(null==(t=w("reminder-1day-time"))?void 0:t.value)||"10:00",reminder1Hour:(null==(n=w("reminder-1hour"))?void 0:n.checked)||!1,updatedAt:firebase.firestore.FieldValue.serverTimestamp()};await a.collection("settings").doc(l||"global").set({reminderSettings:i},{merge:!0}),alert("ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ")}catch(a){console.error("Failed to save reminder settings:",a),alert("è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}}async function ae(){const e=new URLSearchParams(window.location.search);l=e.get("domain"),o=e.get("company")?decodeURIComponent(e.get("company")):null;const t=w("company-name");t&&(t.textContent=o||l||"å…¨ä¼šç¤¾"),te(),await N(),await k(),await O(),"undefined"!=typeof window&&(window.ApplicantsManager={loadApplicantsData:O,applyFilters:P,exportCsv:Q,showSection:S})}async function ie(e,t,n=""){l=e,o=t,h=n,te(),await N(),await k(),await O()}export{ae as a,ie as i};
