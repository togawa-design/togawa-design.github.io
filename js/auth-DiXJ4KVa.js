import{e,b as t}from"./utils-DCR9QUau.js";import{c as n,b as o,s as a}from"./image-uploader-gAKnoYUY.js";import{p as i,f as l,i as s,d as r,c}from"./jobs-loader-CbBJAmIK.js";import{D as d,S as u,C as p,c as m,b as y,d as v,g}from"./LPEditor-DhYOL23n.js";import{c as f,g as b,r as h,d as E,i as $,a as I,s as w,p as x,e as S,f as q,h as L,b as T,u as B}from"./core-WpNCZy-k.js";import{l as k}from"./api-B1sZYcOA.js";const A="admin",j="company",D={credentials:{username:"admin",password:"receco2025"},sessionKey:"rikueco_admin_session",userRoleKey:"rikueco_user_role",userCompanyKey:"rikueco_user_company",gaPropertyId:"G-E1XC94EG05",gaApiKey:"AIzaSyAIC2WGg5dnvMh6TO4sivpbk4HtpYw4tbo",apiEndpoint:"https://asia-northeast1-generated-area-484613-e3.cloudfunctions.net/getAnalyticsData",firebaseConfig:{apiKey:"AIzaSyB3eXZoFkXOwnHxPvaHiWO7csmZK4KGqAQ",authDomain:"generated-area-484613-e3-90bd4.firebaseapp.com",projectId:"generated-area-484613-e3-90bd4"}},C="1NVIDV3OiXbNrVI7EFdRrU2Ggn8dx7Q0rSnvJ6uaWvX0",P="ä¼šç¤¾ä¸€è¦§",U="https://script.google.com/macros/s/AKfycbxj6CqSfY7jq04uDXURhewD_BAKx3csLKBpl1hdRBdNg-R-E6IuoaZGje22Gr9WYWY2/exec";function M(e){return{standard:"ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰",modern:"ãƒ¢ãƒ€ãƒ³",classic:"ã‚¯ãƒ©ã‚·ãƒƒã‚¯",minimal:"ãƒŸãƒ‹ãƒãƒ«",colorful:"ã‚«ãƒ©ãƒ•ãƒ«"}[e]||"ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰"}const R=[{id:"teamwork-1",name:"ãƒãƒ¼ãƒ ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°",url:"https://images.unsplash.com/photo-1521737604893-d14cc237f11d?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1521737604893-d14cc237f11d?w=400&q=60"},{id:"teamwork-2",name:"ã‚ªãƒ•ã‚£ã‚¹ãƒ¯ãƒ¼ã‚¯",url:"https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=400&q=60"},{id:"teamwork-3",name:"ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",url:"https://images.unsplash.com/photo-1600880292203-757bb62b4baf?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1600880292203-757bb62b4baf?w=400&q=60"},{id:"teamwork-4",name:"ãƒ“ã‚¸ãƒã‚¹æ¡æ‰‹",url:"https://images.unsplash.com/photo-1521791136064-7986c2920216?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1521791136064-7986c2920216?w=400&q=60"},{id:"teamwork-5",name:"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—",url:"https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?w=400&q=60"},{id:"work-1",name:"è£½é€ ãƒ©ã‚¤ãƒ³",url:"https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=400&q=60"},{id:"work-2",name:"å€‰åº«ä½œæ¥­",url:"https://images.unsplash.com/photo-1553413077-190dd305871c?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1553413077-190dd305871c?w=400&q=60"},{id:"work-3",name:"å»ºè¨­ç¾å ´",url:"https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=400&q=60"},{id:"work-4",name:"å·¥å ´ä½œæ¥­",url:"https://images.unsplash.com/photo-1573164713988-8665fc963095?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1573164713988-8665fc963095?w=400&q=60"},{id:"work-5",name:"ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯",url:"https://images.unsplash.com/photo-1529156069898-49953e39b3ac?w=1920&q=80",thumbnail:"https://images.unsplash.com/photo-1529156069898-49953e39b3ac?w=400&q=60"}];let N=null,O=null,H=null,_=null,F=null,V=null;function K(){"undefined"!=typeof firebase&&(firebase.apps.length||firebase.initializeApp(D.firebaseConfig),N=firebase.auth(),O=firebase.firestore(),N.onAuthStateChanged(async e=>{if(e){H=e;try{_=await e.getIdToken(),console.log("[Admin] Firebase ID token obtained"),await J(e.uid,e.email);if(sessionStorage.getItem(D.sessionKey)){const t=new CustomEvent("authReady",{detail:{user:e,idToken:_,userRole:F,userCompanyDomain:V}});document.dispatchEvent(t)}}catch(t){console.error("[Admin] Failed to get ID token:",t)}}else H=null,_=null,F=null,V=null}))}async function J(e,t){if(O)try{const n=await O.collection("admin_users").doc(e).get();if(n.exists){const e=n.data();F=e.role||j,V=e.companyDomain||null,sessionStorage.setItem(D.userRoleKey,F),V&&sessionStorage.setItem(D.userCompanyKey,V),console.log("[Admin] User role loaded:",F,V)}else{const e=await O.collection("admin_users").where("email","==",t).limit(1).get();if(e.empty)F=null,V=null,console.log("[Admin] User not registered in admin_users");else{const t=e.docs[0].data();F=t.role||j,V=t.companyDomain||null,sessionStorage.setItem(D.userRoleKey,F),V&&sessionStorage.setItem(D.userCompanyKey,V),console.log("[Admin] User role loaded by email:",F,V)}}}catch(n){console.error("[Admin] Failed to load user role:",n)}}function z(){return!!sessionStorage.getItem(D.sessionKey)}function G(e,t){return e===D.credentials.username&&t===D.credentials.password?(sessionStorage.setItem(D.sessionKey,"authenticated"),sessionStorage.setItem(D.userRoleKey,A),F=A,V=null,{success:!0,role:A}):{success:!1,error:"ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"}}async function Y(e,t){if(!O)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{const o=await O.collection("company_users").where("username","==",e).limit(1).get();if(o.empty)return{success:!1,error:"ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"};const a=o.docs[0],i=a.data();if(!1===i.isActive)return{success:!1,error:"ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™"};if(i.password!==t)return{success:!1,error:"ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"};const l=i.companyDomain;sessionStorage.setItem(D.sessionKey,"authenticated"),sessionStorage.setItem(D.userRoleKey,j),sessionStorage.setItem(D.userCompanyKey,l),sessionStorage.setItem("auth_method","company"),sessionStorage.setItem("company_user_id",e),F=j,V=l;try{await O.collection("company_users").doc(a.id).update({lastLogin:firebase.firestore.FieldValue.serverTimestamp()})}catch(n){console.warn("Failed to update last login:",n)}return{success:!0,role:j,companyDomain:l,companyName:i.companyName||l,userName:i.name||e,userId:a.id}}catch(o){return console.error("Company login error:",o),{success:!1,error:"ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: "+o.message}}}async function Q(){if(!N)return{success:!1,error:"Firebaseèªè¨¼ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{const e=new firebase.auth.GoogleAuthProvider,t=await N.signInWithPopup(e);return H=t.user,_=await t.user.getIdToken(),await J(t.user.uid,t.user.email),F?(sessionStorage.setItem(D.sessionKey,"authenticated"),sessionStorage.setItem("auth_method","google"),{success:!0,user:H,idToken:_,role:F,companyDomain:V}):(await N.signOut(),{success:!1,error:"ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç®¡ç†ç”»é¢ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚"})}catch(e){return console.error("Google login error:",e),{success:!1,error:"Googleãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: "+e.message}}}function X(){sessionStorage.removeItem(D.sessionKey),sessionStorage.removeItem(D.userRoleKey),sessionStorage.removeItem(D.userCompanyKey),sessionStorage.removeItem("auth_method"),sessionStorage.removeItem("company_user_id"),F=null,V=null,N&&N.signOut()}function W(){return _}function Z(){return F||sessionStorage.getItem(D.userRoleKey)}function ee(){return V||sessionStorage.getItem(D.userCompanyKey)}function te(){return Z()===A}async function ne(e,t,n,o=""){if(!te())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!O)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{if(!(await O.collection("company_users").where("username","==",e).where("companyDomain","==",n).get()).empty)return{success:!1,error:"ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™"};return{success:!0,id:(await O.collection("company_users").add({username:e,password:t,companyDomain:n,name:o,createdAt:firebase.firestore.FieldValue.serverTimestamp()})).id}}catch(a){return console.error("Failed to add company user:",a),{success:!1,error:a.message}}}async function oe(){if(!O||!te())return[];try{return(await O.collection("company_users").orderBy("createdAt","desc").get()).docs.map(e=>{var t,n,o,a;return{id:e.id,...e.data(),password:void 0,createdAt:(null==(n=null==(t=e.data().createdAt)?void 0:t.toDate)?void 0:n.call(t))||null,lastLogin:(null==(a=null==(o=e.data().lastLogin)?void 0:o.toDate)?void 0:a.call(o))||null}})}catch(e){return console.error("Failed to get all company users:",e),[]}}async function ae(e,t){if(!te())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!O)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{const n={...t};return delete n.id,await O.collection("company_users").doc(e).update({...n,updatedAt:firebase.firestore.FieldValue.serverTimestamp()}),{success:!0}}catch(n){return console.error("Failed to update company user:",n),{success:!1,error:n.message}}}async function ie(e){if(!te())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!O)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{return await O.collection("company_users").doc(e).delete(),{success:!0}}catch(t){return console.error("Failed to delete company user:",t),{success:!1,error:t.message}}}async function le(e,t){if(!te())return{success:!1,error:"æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"};if(!O)return{success:!1,error:"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{return await O.collection("company_users").doc(e).update({password:t,passwordResetAt:firebase.firestore.FieldValue.serverTimestamp()}),{success:!0}}catch(n){return console.error("Failed to reset password:",n),{success:!1,error:n.message}}}function se(e=12){const t="abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789!@#$%";let n="";for(let o=0;o<e;o++)n+=t.charAt(Math.floor(62*Math.random()));return n}function re(e){return`${e}_user_${Math.random().toString(36).substring(2,6)}`}async function ce(e){if(!O)return!1;try{return!(await O.collection("company_users").where("companyDomain","==",e).limit(1).get()).empty}catch(t){return console.error("Failed to check company user:",t),!1}}async function de(e,t={},n=null){const o=`https://asia-northeast1-generated-area-484613-e3.cloudfunctions.net/getAnalyticsData?${new URLSearchParams({type:e,...t}).toString()}`,a={};n&&(a.Authorization=`Bearer ${n}`);const i=await fetch(o,{headers:a});if(!i.ok)throw new Error(`API Error: ${i.status}`);const l=await i.json();if(!l.success)throw new Error(l.error||"Unknown API error");return l.data}async function ue(e,t=null){return de("overview",{days:e},t)}async function pe(e,t=null){return de("traffic",{days:e},t)}async function me(e,t,n=null){return de("company-detail",{domain:e,days:t},n)}function ye(e){if(!e||e<=0)return"-";const t=Math.round(e);if(t>=3600){return`${Math.floor(t/3600)}æ™‚é–“${Math.floor(t%3600/60)}åˆ†`}if(t>=60){return`${Math.floor(t/60)}åˆ†${t%60}ç§’`}return`${t}ç§’`}function ve(e){if(!e)return"ãã®ä»–";const t=e.toLowerCase();return"mobile"===t||t.includes("mobile")?"ãƒ¢ãƒã‚¤ãƒ«":"desktop"===t||t.includes("desktop")?"ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—":"tablet"===t||t.includes("tablet")?"ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ":e}function ge(t,n,o){var a;const i=function(e,t){const n=(null==e?void 0:e.male)||0,o=n+((null==e?void 0:e.female)||0),a=document.getElementById(t.maleBar),i=document.getElementById(t.femaleBar),l=document.getElementById(t.malePercent),s=document.getElementById(t.femalePercent);if(o>0){const e=Math.round(n/o*100),t=100-e;return a&&(a.style.width=`${e}%`),i&&(i.style.width=`${t}%`),l&&(l.textContent=`${e}%`),s&&(s.textContent=`${t}%`),!0}return a&&(a.style.width="50%"),i&&(i.style.width="50%"),l&&(l.textContent="-"),s&&(s.textContent="-"),!1}(t,{maleBar:o.maleBarId,femaleBar:o.femaleBarId,malePercent:o.malePercentId,femalePercent:o.femalePercentId}),l=function(t,n){const o=document.getElementById(n);if(!o)return!1;const a=Object.entries(t||{}).filter(([e])=>"(not set)"!==e);if(a.length>0&&a.some(([,e])=>e>0)){const t=Math.max(...a.map(([,e])=>e));return o.innerHTML=a.map(([n,o])=>`\n        <div class="age-bar-wrapper">\n          <span class="age-bar-value">${o}</span>\n          <div class="age-bar" style="height: ${t>0?Math.max(10,o/t*80):10}px;"></div>\n          <span class="age-bar-label">${e(n)}</span>\n        </div>\n      `).join(""),!0}return o.innerHTML="",!1}(n,o.ageContainerId),s=o.insufficientDataId||"demographics-insufficient-data";let r=document.getElementById(s);if(i||l)r&&(r.style.display="none");else{if(!r){const e=null==(a=document.getElementById(o.ageContainerId))?void 0:a.closest(".demographics-grid");e&&(r=document.createElement("div"),r.id=s,r.className="demographics-insufficient-notice",r.innerHTML='\n          <p>ã‚¢ã‚¯ã‚»ã‚¹æ•°ãŒå°‘ãªã„ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã§ãã¾ã›ã‚“ã€‚</p>\n          <p class="notice-sub">Google Analyticsã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã«ã‚ˆã‚Šã€ä¸€å®šä»¥ä¸Šã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…è¦ã§ã™ã€‚</p>\n        ',e.parentElement.insertBefore(r,e))}r&&(r.style.display="block")}}function fe(e){const t=e.replace(/"/g,"").trim();return{"ä¼šç¤¾å":"company",company:"company","ä¼šç¤¾ãƒ‰ãƒ¡ã‚¤ãƒ³":"companyDomain",companyDomain:"companyDomain",company_domain:"companyDomain","ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³":"designPattern",designPattern:"designPattern",design_pattern:"designPattern","è¡¨ç¤ºã™ã‚‹":"showCompany",showCompany:"showCompany",visible:"showCompany","ç”»åƒURL":"imageUrl",imageUrl:"imageUrl",image_url:"imageUrl","èª¬æ˜":"description",description:"description","ä¸¦ã³é †":"order",order:"order","ç®¡ç†ã‚·ãƒ¼ãƒˆ":"manageSheetUrl","ç®¡ç†ã‚·ãƒ¼ãƒˆURL":"manageSheetUrl",manageSheetUrl:"manageSheetUrl","æ±‚äººã‚·ãƒ¼ãƒˆ":"jobsSheet","æ±‚äººç®¡ç†ã‚·ãƒ¼ãƒˆ":"jobsSheet","æ±‚äººä¸€è¦§ã‚·ãƒ¼ãƒˆ":"jobsSheet",jobs_sheet:"jobsSheet",jobsSheet:"jobsSheet"}[t]||t}let be=[],he=!1;function Ee(){return be}async function $e(){const e=document.getElementById("company-manage-tbody");e&&(e.innerHTML='<tr><td colspan="6" class="loading-cell">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</td></tr>');try{const t=`https://docs.google.com/spreadsheets/d/${C}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(P)}`,n=await fetch(t);if(!n.ok)throw new Error("ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");let o=function(e){const t=e.split("\n"),n=i(t[0]||""),o=[];for(let a=1;a<t.length;a++){if(!t[a].trim())continue;const e=i(t[a]),l={};n.forEach((t,n)=>{const o=fe(t);l[o]=e[n]||""}),o.push(l)}return o}(await n.text());if(o=o.map(e=>{if(e.companyDomain){const n=localStorage.getItem(`company_data_${e.companyDomain}`);if(n)try{const t=JSON.parse(n);return{...e,...t}}catch(t){console.error("ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼:",t)}}return e}),be=o,e){if(0===o.length)return void(e.innerHTML='<tr><td colspan="6" class="loading-cell">ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>');qe()}}catch(t){console.error("ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",t),e&&(e.innerHTML='<tr><td colspan="6" class="loading-cell">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</td></tr>')}}function Ie(e){var t;const n=null==be?void 0:be.find(t=>t.companyDomain===e);n&&sessionStorage.setItem("editing_company_data",JSON.stringify(n)),(null==(t=window.AdminDashboard)?void 0:t.navigateToCompanyEdit)?window.AdminDashboard.navigateToCompanyEdit(e,"company-manage"):window.location.href=`company-edit.html?domain=${encodeURIComponent(e)}`}function we(){var e;(null==(e=window.AdminDashboard)?void 0:e.navigateToCompanyEdit)?window.AdminDashboard.navigateToCompanyEdit(null,"company-manage"):window.location.href="company-edit.html"}function xe(){const e=document.getElementById("company-modal");e&&(e.style.display="none"),he=!1}async function Se(){var e,t,n,o,a,i,l;const s=document.getElementById("edit-company-domain"),r=(null==s?void 0:s.value.trim().toLowerCase())||"",c={company:(null==(e=document.getElementById("edit-company-name"))?void 0:e.value.trim())||"",company_domain:r,companyDomain:r,designPattern:(null==(t=document.getElementById("edit-design-pattern"))?void 0:t.value)||"standard",imageUrl:(null==(n=document.getElementById("edit-image-url"))?void 0:n.value.trim())||"",order:(null==(o=document.getElementById("edit-order"))?void 0:o.value)||"",description:(null==(a=document.getElementById("edit-description"))?void 0:a.value.trim())||"",showCompany:(null==(i=document.getElementById("edit-show-company"))?void 0:i.checked)?"â—‹":"",visible:(null==(l=document.getElementById("edit-show-company"))?void 0:l.checked)?"â—‹":""};if(!c.company||!c.companyDomain)return void alert("ä¼šç¤¾åã¨ä¼šç¤¾ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯å¿…é ˆã§ã™");if(!/^[a-z0-9-]+$/.test(c.companyDomain))return void alert("ä¼šç¤¾ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯åŠè§’è‹±æ•°å­—ã¨ãƒã‚¤ãƒ•ãƒ³ã®ã¿ä½¿ç”¨ã§ãã¾ã™");if(he){if(null==be?void 0:be.find(e=>e.companyDomain===c.companyDomain))return void alert("ã“ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™")}const d=U;try{const e=document.getElementById("company-modal-save");e&&(e.disabled=!0,e.textContent="ä¿å­˜ä¸­...");const t=btoa(unescape(encodeURIComponent(JSON.stringify({action:"saveCompany",company:c})))),n=`${d}?action=post&data=${encodeURIComponent(t)}`,o=await fetch(n,{method:"GET",redirect:"follow"}),a=await o.json();if(e&&(e.disabled=!1,e.textContent="ä¿å­˜"),!a.success)return void alert("ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: "+(a.error||"ä¸æ˜ãªã‚¨ãƒ©ãƒ¼"));if(localStorage.removeItem(`company_data_${c.companyDomain}`),he)be.push(c);else{const e=be.findIndex(e=>e.companyDomain===c.companyDomain);-1!==e&&(be[e]=c)}xe(),qe(),alert(`ä¼šç¤¾æƒ…å ±ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜ã—ã¾ã—ãŸã€‚\n\nä¼šç¤¾å: ${c.company}\nãƒ‰ãƒ¡ã‚¤ãƒ³: ${c.companyDomain}`)}catch(u){console.error("GAS APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼:",u),alert("ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ã¾ã™ã€‚"),function(e){const t=`company_data_${e.companyDomain}`;if(localStorage.setItem(t,JSON.stringify(e)),he)be.push(e);else{const t=be.findIndex(t=>t.companyDomain===e.companyDomain);-1!==t&&(be[t]=e)}xe(),qe(),alert(`ä¼šç¤¾æƒ…å ±ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ã¾ã—ãŸã€‚\n\næ³¨æ„: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è‡ªå‹•ä¿å­˜ã™ã‚‹ã«ã¯ã€è¨­å®šç”»é¢ã§GAS API URLã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚\n\nä¼šç¤¾å: ${e.company}\nãƒ‰ãƒ¡ã‚¤ãƒ³: ${e.companyDomain}`)}(c)}}function qe(){const t=document.getElementById("company-manage-tbody");if(!t)return;const n=be||[];0!==n.length?(t.innerHTML=n.map(t=>`\n    <tr data-domain="${e(t.companyDomain||"")}">\n      <td>${e(t.company||"")}</td>\n      <td><code>${e(t.companyDomain||"")}</code></td>\n      <td><span class="badge ${t.designPattern||"standard"}">${M(t.designPattern||"standard")}</span></td>\n      <td>${"â—‹"===t.showCompany||"â—¯"===t.showCompany?'<span class="badge success">è¡¨ç¤º</span>':'<span class="badge">éè¡¨ç¤º</span>'}</td>\n      <td>\n        <div class="action-buttons">\n          <button class="btn-small btn-edit" data-action="edit" data-domain="${e(t.companyDomain||"")}">ç·¨é›†</button>\n          <button class="btn-small btn-primary" data-action="jobs" data-domain="${e(t.companyDomain||"")}">æ±‚äººç®¡ç†</button>\n          <button class="btn-small btn-secondary" data-action="recruit" data-domain="${e(t.companyDomain||"")}">æ¡ç”¨ãƒšãƒ¼ã‚¸ç¢ºèª</button>\n        </div>\n      </td>\n    </tr>\n  `).join(""),t.addEventListener("click",e=>{const t=e.target.closest("[data-action]");if(!t)return;const n=t.dataset.action,o=t.dataset.domain;"edit"===n?Ie(o):"jobs"===n?Le(o):"recruit"===n&&function(e){const t=null==be?void 0:be.find(t=>t.companyDomain===e),n=new CustomEvent("navigateToSection",{detail:{section:"recruit-settings",companyDomain:e,company:t}});document.dispatchEvent(n)}(o)})):t.innerHTML='<tr><td colspan="5" class="loading-cell">ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>'}function Le(e){var t;const n=null==be?void 0:be.find(t=>t.companyDomain===e);if(n)if(null==(t=window.AdminDashboard)?void 0:t.navigateToJobManage)window.AdminDashboard.navigateToJobManage(e,n.company||e,"company-manage");else{const t=new URLSearchParams;t.set("domain",e),t.set("company",n.company||e),n.manageSheetUrl&&t.set("sheetUrl",n.manageSheetUrl),window.location.href=`job-manage.html?${t.toString()}`}else alert("ä¼šç¤¾æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")}function Te(e){if(!e)return[];const t=[],n=e.replace(/\\n/g,"\n").split(/\|\||[\n\r]+/).filter(e=>e.trim());for(const o of n){const e=o.match(/Q[:ï¼š](.+?)(?=\|A[:ï¼š]|$)/i),n=o.match(/A[:ï¼š](.+)/i);e&&n&&t.push({id:`faq-${t.length+1}`,question:e[1].trim(),answer:n[1].trim()})}return t}let Be=[],ke={},Ae=null,je=null,De=null,Ce={};function Pe(e,t={}){je=e,De=t.getCompanyDomain||(()=>null),function(){const e=document.getElementById("btn-add-section");e&&e.addEventListener("click",Ne);const t=document.getElementById("btn-add-custom-section");t&&t.addEventListener("click",He);const n=document.getElementById("add-section-modal-close");n&&n.addEventListener("click",Oe);const o=document.getElementById("section-editor-close");o&&o.addEventListener("click",ze);const a=document.getElementById("section-editor-cancel");a&&a.addEventListener("click",ze);const i=document.getElementById("section-editor-save");i&&i.addEventListener("click",Ge);const l=document.getElementById("section-delete-btn");l&&l.addEventListener("click",()=>{Ae&&(Fe(Ae.id),ze())});const s=document.getElementById("lp-sections-list");s&&s.addEventListener("click",Re);document.querySelectorAll(".modal-overlay").forEach(e=>{e.addEventListener("click",t=>{t.target===e&&(e.style.display="none")})})}(),function(){const e=document.getElementById("template-selector-container");if(!e)return;const t=ke.layoutStyle||"default";e.innerHTML=function(e="default"){return`\n    <div class="lp-admin-layout-selector">\n      ${y.map(t=>{const n=e===t.id;return`\n      <div class="lp-admin-layout-option ${n?"selected":""}"\n           data-layout="${t.id}"\n           title="${t.description}">\n        <div class="lp-admin-layout-preview">\n          <span class="lp-admin-layout-preview-text">${t.preview}</span>\n        </div>\n        <div class="lp-admin-layout-info">\n          <span class="lp-admin-layout-name">${t.name}</span>\n          <span class="lp-admin-layout-desc">${t.description}</span>\n        </div>\n        ${n?'<span class="lp-admin-layout-check">âœ“</span>':""}\n      </div>\n    `}).join("")}\n    </div>\n  `}(t),function(e){e.querySelectorAll(".lp-admin-layout-option").forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.layout;e.querySelectorAll(".lp-admin-layout-option").forEach(e=>{e.classList.toggle("selected",e===t);const n=e.querySelector(".lp-admin-layout-check");if(e===t){if(!n){const t=document.createElement("span");t.className="lp-admin-layout-check",t.textContent="âœ“",e.appendChild(t)}}else n&&n.remove()}),ke.layoutStyle=n,je&&je()})})}(e)}()}function Ue(e){const t=function(e){var t;if(!e)return{version:"2.0",sections:[{id:"hero-1",type:"hero",order:0,visible:!0,data:{title:"",subtitle:"",image:""},layout:{}},{id:"points-1",type:"points",order:1,visible:!0,data:{sectionTitle:"ã“ã®æ±‚äººã®ãƒã‚¤ãƒ³ãƒˆ",points:[]},layout:{columns:3,style:"cards"}},{id:"jobs-1",type:"jobs",order:2,visible:!0,data:{sectionTitle:"å‹Ÿé›†ä¸­ã®æ±‚äºº"},layout:{}},{id:"details-1",type:"details",order:3,visible:!0,data:{sectionTitle:"å‹Ÿé›†è¦é …"},layout:{}},{id:"faq-1",type:"faq",order:4,visible:!0,data:{sectionTitle:"ã‚ˆãã‚ã‚‹è³ªå•",items:[]},layout:{style:"accordion"}},{id:"apply-1",type:"apply",order:5,visible:!0,data:{},layout:{}}],globalSettings:{designPattern:"standard",layoutStyle:"default",ctaText:"ä»Šã™ãå¿œå‹Ÿã™ã‚‹"}};if(e.lpContent){console.log("[migrateToV2Format] lpContent found, length:",e.lpContent.length);try{const n=JSON.parse(e.lpContent);if(console.log("[migrateToV2Format] Parsed lpContent, version:",n.version,"sections:",null==(t=n.sections)?void 0:t.length),"2.0"===n.version){if(e.faq){const t=Te(e.faq),o=n.sections.find(e=>"faq"===e.type);o&&(o.data=o.data||{},o.data.items=t,o.visible=t.length>0)}return console.log("[migrateToV2Format] Returning parsed v2 content with sections:",n.sections.map(e=>e.type)),n}}catch(s){console.error("[migrateToV2Format] JSON parse error:",s.message),console.log("[migrateToV2Format] lpContent value:",e.lpContent.substring(0,200))}}else console.log("[migrateToV2Format] No lpContent found, migrating from legacy format");const n=[];let o={points:!0,jobs:!0,details:!0,faq:!0};try{e.sectionVisibility&&(o={...o,...JSON.parse(e.sectionVisibility)})}catch(s){console.warn("sectionVisibility parse error:",s)}let a=d;if(e.sectionOrder){const t=e.sectionOrder.split(",").map(e=>e.trim()).filter(e=>e);if(t.length>0){const e=d.filter(e=>!t.includes(e));a=[...t,...e]}}n.push({id:"hero-1",type:"hero",order:a.indexOf("hero"),visible:!0,data:{title:e.heroTitle||"",subtitle:e.heroSubtitle||"",image:e.heroImage||""},layout:{}});const i=[];for(let r=1;r<=6;r++){const t=e[`pointTitle${r}`],n=e[`pointDesc${r}`];t&&i.push({id:`p${r}`,title:t,description:n||""})}n.push({id:"points-1",type:"points",order:a.indexOf("points"),visible:o.points,data:{sectionTitle:"ã“ã®æ±‚äººã®ãƒã‚¤ãƒ³ãƒˆ",points:i},layout:{columns:3,style:"cards"}}),n.push({id:"jobs-1",type:"jobs",order:a.indexOf("jobs"),visible:o.jobs,data:{sectionTitle:"å‹Ÿé›†ä¸­ã®æ±‚äºº"},layout:{}}),n.push({id:"details-1",type:"details",order:a.indexOf("details"),visible:o.details,data:{sectionTitle:"å‹Ÿé›†è¦é …"},layout:{}});const l=Te(e.faq);return n.push({id:"faq-1",type:"faq",order:a.indexOf("faq"),visible:o.faq&&l.length>0,data:{sectionTitle:"ã‚ˆãã‚ã‚‹è³ªå•",items:l},layout:{style:"accordion"}}),n.push({id:"apply-1",type:"apply",order:a.indexOf("apply"),visible:!0,data:{},layout:{}}),n.sort((e,t)=>e.order-t.order),{version:"2.0",sections:n,globalSettings:{designPattern:e.designPattern||"standard",layoutStyle:e.layoutStyle||"default",ctaText:e.ctaText||"ä»Šã™ãå¿œå‹Ÿã™ã‚‹",tiktokPixelId:e.tiktokPixelId||"",googleAdsId:e.googleAdsId||"",googleAdsLabel:e.googleAdsLabel||"",ogpTitle:e.ogpTitle||"",ogpDescription:e.ogpDescription||"",ogpImage:e.ogpImage||""}}}(e);Be=t.sections||[],ke=t.globalSettings||{},e.layoutStyle&&(ke.layoutStyle=e.layoutStyle),Me(),function(){const e=document.getElementById("template-selector-container");if(!e)return;const t=ke.layoutStyle||"default";e.querySelectorAll(".lp-admin-layout-option").forEach(e=>{const n=e.dataset.layout===t;e.classList.toggle("selected",n);let o=e.querySelector(".lp-admin-layout-check");if(n){if(!o){const t=document.createElement("span");t.className="lp-admin-layout-check",t.textContent="âœ“",e.appendChild(t)}}else o&&o.remove()})}()}function Me(){const t=document.getElementById("lp-sections-list");if(!t)return void console.log("[renderSectionsList] Container not found");const n=[...Be].sort((e,t)=>(e.order||0)-(t.order||0));console.log("[renderSectionsList] Rendering sections:",n.length,n.map(e=>e.type)),t.innerHTML=n.map(e=>function(e){var t,n;const o=u[e.type],a=null==o?void 0:o.required,i=!1!==e.visible,l="custom"===e.type&&(null==(t=e.layout)?void 0:t.variant)&&(null==(n=p[e.layout.variant])?void 0:n.name)||"";return`\n    <li class="section-item ${i?"":"hidden"}"\n        data-section-id="${e.id}"\n        data-type="${e.type}"\n        draggable="true">\n      <span class="section-drag-handle">â‹®â‹®</span>\n      <span class="section-icon">${(null==o?void 0:o.icon)||"ğŸ“„"}</span>\n      <div class="section-info">\n        <div class="section-name">${(null==o?void 0:o.name)||e.type}</div>\n        ${l?`<div class="section-type-label">${l}</div>`:""}\n      </div>\n      <div class="section-actions">\n        <button type="button" class="section-btn btn-edit" title="ç·¨é›†" data-section-id="${e.id}">\n          âœï¸\n        </button>\n        ${a?"":`\n          <button type="button" class="section-btn btn-duplicate" title="è¤‡è£½" data-section-id="${e.id}">\n            ğŸ“‹\n          </button>\n        `}\n        <button type="button" class="section-btn btn-visibility ${i?"":"hidden"}" title="${i?"éè¡¨ç¤ºã«ã™ã‚‹":"è¡¨ç¤ºã™ã‚‹"}" data-section-id="${e.id}">\n          ${i?"ğŸ‘ï¸":"ğŸ‘ï¸â€ğŸ—¨ï¸"}\n        </button>\n        ${a?"":`\n          <button type="button" class="section-btn btn-delete" title="å‰Šé™¤" data-section-id="${e.id}">\n            ğŸ—‘ï¸\n          </button>\n        `}\n      </div>\n    </li>\n  `}(e)).join(""),function(){const e=document.getElementById("lp-sections-list");if(!e)return;let t=null;e.querySelectorAll(".section-item").forEach(n=>{n.addEventListener("dragstart",e=>{t=n,n.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain","")}),n.addEventListener("dragend",()=>{n.classList.remove("dragging"),t=null,e.querySelectorAll(".section-item").forEach(e=>{e.classList.remove("drag-over")}),function(){const e=document.getElementById("lp-sections-list");if(!e)return;const t=e.querySelectorAll(".section-item");t.forEach((e,t)=>{const n=e.dataset.sectionId,o=Be.find(e=>e.id===n);o&&(o.order=t)})}(),nt()}),n.addEventListener("dragover",o=>{if(o.preventDefault(),o.dataTransfer.dropEffect="move",!t||t===n)return;const a=function(e,t){const n=[...e.querySelectorAll(".section-item:not(.dragging)")];return n.reduce((e,n)=>{const o=n.getBoundingClientRect(),a=t-o.top-o.height/2;return a<0&&a>(e.offset||Number.NEGATIVE_INFINITY)?{offset:a,element:n}:e},{offset:Number.NEGATIVE_INFINITY}).element||null}(e,o.clientY);e.querySelectorAll(".section-item").forEach(e=>{e.classList.remove("drag-over")}),a&&a!==t&&a.classList.add("drag-over"),null==a?e.appendChild(t):e.insertBefore(t,a)}),n.addEventListener("dragleave",()=>{n.classList.remove("drag-over")})})}(),function(){const t=document.getElementById("custom-sections-panel"),n=document.getElementById("custom-sections-list");if(!t||!n)return;const o=["hero","points","jobs","details","faq","apply"],a=Be.filter(e=>!o.includes(e.type)).sort((e,t)=>(e.order||0)-(t.order||0));a.length>0?(t.style.display="",n.innerHTML=a.map(t=>function(t){var n,o;const a=u[t.type],i=!1!==t.visible,l=(null==(n=t.data)?void 0:n.sectionTitle)||(null==(o=t.data)?void 0:o.title)||"",s=function(e){var t,n,o,a,i,l,s,r;switch(e.type){case"video":if(null==(t=e.data)?void 0:t.videoUrl){const t=e.data.videoUrl;return t.includes("youtube")||t.includes("youtu.be")?"YouTubeå‹•ç”»":t.includes("vimeo")?"Vimeoå‹•ç”»":t.includes("tiktok")?"TikTokå‹•ç”»":"å‹•ç”»URLè¨­å®šæ¸ˆã¿"}return"å‹•ç”»æœªè¨­å®š";case"carousel":const c=(null==(o=null==(n=e.data)?void 0:n.images)?void 0:o.length)||0;return c>0?`${c}æšã®ç”»åƒ`:"ç”»åƒæœªè¨­å®š";case"gallery":const d=(null==(i=null==(a=e.data)?void 0:a.images)?void 0:i.length)||0;return d>0?`${d}æšã®ç”»åƒ`:"ç”»åƒæœªè¨­å®š";case"testimonial":const u=(null==(s=null==(l=e.data)?void 0:l.testimonials)?void 0:s.length)||0;return u>0?`${u}äººã®å£°`:"æœªè¨­å®š";case"custom":const m=p[null==(r=e.layout)?void 0:r.variant];return(null==m?void 0:m.name)||"ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„";default:return""}}(t);return`\n    <div class="custom-section-item ${i?"":"hidden"}" data-section-id="${t.id}" data-type="${t.type}">\n      <span class="custom-section-icon">${(null==a?void 0:a.icon)||"ğŸ“„"}</span>\n      <div class="custom-section-info">\n        <span class="custom-section-type">${(null==a?void 0:a.name)||t.type}</span>\n        ${l?`<span class="custom-section-title">${e(l)}</span>`:""}\n        ${s?`<span class="custom-section-meta">${e(s)}</span>`:""}\n      </div>\n      <div class="custom-section-actions">\n        <button type="button" class="section-btn btn-edit" title="ç·¨é›†" data-section-id="${t.id}">âœï¸</button>\n        <button type="button" class="section-btn btn-visibility ${i?"":"hidden"}" title="${i?"éè¡¨ç¤ºã«ã™ã‚‹":"è¡¨ç¤ºã™ã‚‹"}" data-section-id="${t.id}">\n          ${i?"ğŸ‘ï¸":"ğŸ‘ï¸â€ğŸ—¨ï¸"}\n        </button>\n        <button type="button" class="section-btn btn-delete" title="å‰Šé™¤" data-section-id="${t.id}">ğŸ—‘ï¸</button>\n      </div>\n    </div>\n  `}(t)).join(""),function(){const e=document.getElementById("custom-sections-list");if(!e)return;e.onclick=e=>{const t=e.target.closest("button");if(!t)return;const n=t.dataset.sectionId;n&&(t.classList.contains("btn-edit")?Je(n):t.classList.contains("btn-visibility")?Ve(n):t.classList.contains("btn-delete")&&Fe(n))}}()):(t.style.display="none",n.innerHTML="")}()}function Re(e){const t=e.target.closest("button");if(!t)return;const n=t.dataset.sectionId;n&&(t.classList.contains("btn-edit")?Je(n):t.classList.contains("btn-duplicate")?function(e){var t;const n=Be.find(t=>t.id===e);if(!n)return;if(!m(n.type,Be))return void alert(`${(null==(t=u[n.type])?void 0:t.name)||n.type}ã¯ã“ã‚Œä»¥ä¸Šè¿½åŠ ã§ãã¾ã›ã‚“`);const o={...JSON.parse(JSON.stringify(n)),id:g(n.type),order:n.order+.5};Be.push(o),Ke(),Me(),nt()}(n):t.classList.contains("btn-visibility")?Ve(n):t.classList.contains("btn-delete")&&Fe(n))}function Ne(){const e=document.getElementById("add-section-modal"),t=document.getElementById("section-type-grid");e&&t&&(t.innerHTML=Object.entries(u).filter(([e])=>!u[e].required||m(e,Be)).map(([e,t])=>`\n      <div class="section-type-card" data-type="${e}" ${m(e,Be)?"":"disabled"}>\n        <span class="type-icon">${t.icon}</span>\n        <span class="type-name">${t.name}</span>\n        ${1!==t.maxInstances||m(e,Be)?"":'<span class="type-limit">è¿½åŠ æ¸ˆã¿</span>'}\n      </div>\n    `).join(""),t.querySelectorAll(".section-type-card:not([disabled])").forEach(e=>{e.addEventListener("click",()=>{_e(e.dataset.type),Oe()})}),e.style.display="flex")}function Oe(){const e=document.getElementById("add-section-modal");e&&(e.style.display="none")}function He(){const e=document.getElementById("add-section-modal"),t=document.getElementById("section-type-grid");if(!e||!t)return;const n=["hero","points","jobs","details","faq","apply"],o=Object.entries(u).filter(([e])=>!n.includes(e));t.innerHTML=o.map(([e,t])=>`\n      <div class="section-type-card" data-type="${e}" ${m(e,Be)?"":"disabled"}>\n        <span class="type-icon">${t.icon}</span>\n        <span class="type-name">${t.name}</span>\n        ${1!==t.maxInstances||m(e,Be)?"":'<span class="type-limit">è¿½åŠ æ¸ˆã¿</span>'}\n      </div>\n    `).join(""),t.querySelectorAll(".section-type-card:not([disabled])").forEach(e=>{e.addEventListener("click",()=>{_e(e.dataset.type),Oe()})}),e.style.display="flex"}function _e(e){const t=u[e];if(!t)return;if(!m(e,Be))return void alert(`${t.name}ã¯ã“ã‚Œä»¥ä¸Šè¿½åŠ ã§ãã¾ã›ã‚“`);let n;if(!["hero","points","jobs","details","faq","apply"].includes(e)){const e=Be.find(e=>"apply"===e.type);e?(n=e.order,Be.forEach(e=>{e.order>=n&&(e.order+=1)})):n=Be.length}else n=Be.length;const o={id:g(e),type:e,order:n,visible:!0,data:JSON.parse(JSON.stringify(t.defaultData)),layout:JSON.parse(JSON.stringify(t.defaultLayout))};Be.push(o),Ke(),Me(),Je(o.id),nt()}function Fe(e){var t;if(!v(e,Be))return void alert("ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯å‰Šé™¤ã§ãã¾ã›ã‚“");const n=Be.find(t=>t.id===e),o=(null==(t=u[null==n?void 0:n.type])?void 0:t.name)||(null==n?void 0:n.type);confirm(`ã€Œ${o}ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)&&(Be=Be.filter(t=>t.id!==e),Ke(),Me(),nt())}function Ve(e){const t=Be.find(t=>t.id===e);t&&(t.visible=!t.visible,Me(),nt())}function Ke(){Be.sort((e,t)=>(e.order||0)-(t.order||0)),Be.forEach((e,t)=>{e.order=t})}function Je(t){if(Ae=Be.find(e=>e.id===t),!Ae)return void console.log("[openSectionEditor] Section not found:",t);console.log("[openSectionEditor] Opening editor for:",Ae.type,Ae);const a=document.getElementById("section-editor-modal"),i=document.getElementById("section-editor-title"),l=document.getElementById("section-editor-content"),s=document.getElementById("section-delete-btn");if(!a||!l)return void console.error("[openSectionEditor] Modal or content element not found");const r=u[Ae.type];console.log("[openSectionEditor] Type config:",r),i.textContent=`${(null==r?void 0:r.name)||Ae.type}ã‚’ç·¨é›†`,s&&(s.style.display=(null==r?void 0:r.required)?"none":"inline-block");const c=function(t){switch(console.log("[renderSectionEditorContent] Rendering editor for type:",t.type),t.type){case"hero":return function(t){var n,o,a,i;return`\n    <div class="editor-section">\n      <div class="form-group">\n        <label for="editor-hero-title">ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-hero-title" value="${e((null==(n=t.data)?void 0:n.title)||"")}" placeholder="ä¾‹: æœˆå32ä¸‡å††ä»¥ä¸Šå¯ï¼å…¥ç¤¾ç‰¹å…¸ã‚ã‚Š">\n      </div>\n      <div class="form-group">\n        <label for="editor-hero-subtitle">ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-hero-subtitle" value="${e((null==(o=t.data)?void 0:o.subtitle)||"")}" placeholder="ä¾‹: æœªçµŒé¨“è€…æ­“è¿ï¼å……å®Ÿã®ç ”ä¿®åˆ¶åº¦">\n      </div>\n      <div class="form-group">\n        <label>èƒŒæ™¯ç”»åƒ</label>\n        <div id="hero-image-uploader-container" data-current-url="${e((null==(a=t.data)?void 0:a.image)||"")}"></div>\n        <input type="hidden" id="editor-hero-image" value="${e((null==(i=t.data)?void 0:i.image)||"")}">\n      </div>\n    </div>\n  `}(t);case"points":return function(e){var t,n,o,a;const i=(null==(t=e.data)?void 0:t.points)||[];return`\n    <div class="editor-section">\n      <h4>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š</h4>\n      <div class="form-group">\n        <label for="editor-points-columns">ã‚«ãƒ©ãƒ æ•°</label>\n        <select id="editor-points-columns">\n          <option value="2" ${2===(null==(n=e.layout)?void 0:n.columns)?"selected":""}>2åˆ—</option>\n          <option value="3" ${3===(null==(o=e.layout)?void 0:o.columns)?"selected":""}>3åˆ—</option>\n          <option value="4" ${4===(null==(a=e.layout)?void 0:a.columns)?"selected":""}>4åˆ—</option>\n        </select>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ãƒã‚¤ãƒ³ãƒˆä¸€è¦§</h4>\n      <div id="editor-points-list" class="editor-items-list">\n        ${i.map((e,t)=>Ye(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-point" class="btn-add-item">\n        <span>+</span> ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"faq":return function(e){var t;const n=(null==(t=e.data)?void 0:t.items)||[];return`\n    <div class="editor-section">\n      <h4>ã‚ˆãã‚ã‚‹è³ªå•</h4>\n      <div id="editor-faq-list" class="editor-items-list">\n        ${n.map((e,t)=>Qe(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-faq" class="btn-add-item">\n        <span>+</span> Q&Aã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"custom":return function(t){var n,o,a,i,l,s,r,c,d,u;const m=(null==(n=t.layout)?void 0:n.variant)||"text-only",y=!!(null==(o=t.data)?void 0:o.button);return`\n    <div class="editor-section">\n      <h4>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</h4>\n      <div class="variant-selector">\n        ${Object.entries(p).map(([e,t])=>`\n          <label class="variant-option ${m===e?"selected":""}">\n            <input type="radio" name="custom-variant" value="${e}" ${m===e?"checked":""}>\n            <span class="variant-icon">${t.icon}</span>\n            <span class="variant-name">${t.name}</span>\n          </label>\n        `).join("")}\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h4>\n      <div class="form-group">\n        <label for="editor-custom-title">ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-custom-title" value="${e((null==(a=t.data)?void 0:a.title)||"")}">\n      </div>\n      <div class="form-group">\n        <label for="editor-custom-content">æœ¬æ–‡</label>\n        <div id="editor-custom-content" class="rich-editor" contenteditable="true">${(null==(i=t.data)?void 0:i.content)||""}</div>\n        <p class="form-hint">**å¤ªå­—** ã‚„ *æ–œä½“* ãŒä½¿ãˆã¾ã™</p>\n      </div>\n      <div class="form-group" id="custom-image-field">\n        <label>ç”»åƒ</label>\n        <div id="custom-image-uploader-container" data-current-url="${e((null==(l=t.data)?void 0:l.image)||"")}"></div>\n        <input type="hidden" id="editor-custom-image" value="${e((null==(s=t.data)?void 0:s.image)||"")}">\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ãƒœã‚¿ãƒ³</h4>\n      <div class="form-group">\n        <label class="checkbox-label">\n          <input type="checkbox" id="editor-custom-has-button" ${y?"checked":""}>\n          ãƒœã‚¿ãƒ³ã‚’è¿½åŠ \n        </label>\n      </div>\n      <div id="button-fields" style="${y?"":"display:none"}">\n        <div class="form-group">\n          <label for="editor-button-text">ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</label>\n          <input type="text" id="editor-button-text" value="${e((null==(c=null==(r=t.data)?void 0:r.button)?void 0:c.text)||"")}">\n        </div>\n        <div class="form-group">\n          <label for="editor-button-url">ãƒªãƒ³ã‚¯å…ˆURL</label>\n          <input type="text" id="editor-button-url" value="${e((null==(u=null==(d=t.data)?void 0:d.button)?void 0:u.url)||"#")}">\n        </div>\n      </div>\n    </div>\n  `}(t);case"gallery":return function(t){var n,o,a,i,l,s,r,c;const d=(null==(n=t.data)?void 0:n.images)||[];return`\n    <div class="editor-section">\n      <h4>è¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-gallery-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n          <input type="text" id="editor-gallery-title" value="${e((null==(o=t.data)?void 0:o.sectionTitle)||"")}">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-gallery-columns">ã‚«ãƒ©ãƒ æ•°</label>\n          <select id="editor-gallery-columns">\n            <option value="2" ${2===(null==(a=t.layout)?void 0:a.columns)?"selected":""}>2åˆ—</option>\n            <option value="3" ${3===(null==(i=t.layout)?void 0:i.columns)?"selected":""}>3åˆ—</option>\n            <option value="4" ${4===(null==(l=t.layout)?void 0:l.columns)?"selected":""}>4åˆ—</option>\n          </select>\n        </div>\n        <div class="form-group">\n          <label for="editor-gallery-style">ã‚¹ã‚¿ã‚¤ãƒ«</label>\n          <select id="editor-gallery-style">\n            <option value="grid" ${"grid"===(null==(s=t.layout)?void 0:s.style)?"selected":""}>ã‚°ãƒªãƒƒãƒ‰</option>\n            <option value="masonry" ${"masonry"===(null==(r=t.layout)?void 0:r.style)?"selected":""}>ãƒ¡ã‚¤ã‚½ãƒ³ãƒªãƒ¼</option>\n            <option value="slider" ${"slider"===(null==(c=t.layout)?void 0:c.style)?"selected":""}>ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ç”»åƒä¸€è¦§</h4>\n      <div id="editor-gallery-list" class="editor-items-list gallery-items">\n        ${d.map((e,t)=>Xe(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-gallery-image" class="btn-add-item">\n        <span>+</span> ç”»åƒã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"testimonial":return function(t){var n,o,a,i,l;const s=(null==(n=t.data)?void 0:n.testimonials)||[];return`\n    <div class="editor-section">\n      <h4>è¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-testimonial-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n          <input type="text" id="editor-testimonial-title" value="${e((null==(o=t.data)?void 0:o.sectionTitle)||"ç¤¾å“¡ã®å£°")}">\n        </div>\n        <div class="form-group">\n          <label for="editor-testimonial-style">ã‚¹ã‚¿ã‚¤ãƒ«</label>\n          <select id="editor-testimonial-style">\n            <option value="cards" ${"cards"===(null==(a=t.layout)?void 0:a.style)?"selected":""}>ã‚«ãƒ¼ãƒ‰</option>\n            <option value="list" ${"list"===(null==(i=t.layout)?void 0:i.style)?"selected":""}>ãƒªã‚¹ãƒˆ</option>\n            <option value="slider" ${"slider"===(null==(l=t.layout)?void 0:l.style)?"selected":""}>ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ç¤¾å“¡ä¸€è¦§</h4>\n      <div id="editor-testimonial-list" class="editor-items-list">\n        ${s.map((e,t)=>We(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-testimonial" class="btn-add-item">\n        <span>+</span> ç¤¾å“¡ã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"carousel":return console.log("[renderSectionEditorContent] Rendering carousel editor"),function(t){var n,o,a,i,l,s;const r=(null==(n=t.data)?void 0:n.images)||[],c=!1!==(null==(o=t.data)?void 0:o.autoPlay),d=(null==(a=t.data)?void 0:a.interval)||5e3;return`\n    <div class="editor-section">\n      <h4>è¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-carousel-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n          <input type="text" id="editor-carousel-title" value="${e((null==(i=t.data)?void 0:i.sectionTitle)||"")}">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-carousel-autoplay" ${c?"checked":""}>\n            è‡ªå‹•å†ç”Ÿ\n          </label>\n        </div>\n        <div class="form-group">\n          <label for="editor-carousel-interval">åˆ‡æ›¿é–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰</label>\n          <input type="number" id="editor-carousel-interval" value="${d}" min="1000" step="500">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-carousel-dots" ${!1!==(null==(l=t.layout)?void 0:l.showDots)?"checked":""}>\n            ãƒ‰ãƒƒãƒˆè¡¨ç¤º\n          </label>\n        </div>\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-carousel-arrows" ${!1!==(null==(s=t.layout)?void 0:s.showArrows)?"checked":""}>\n            çŸ¢å°è¡¨ç¤º\n          </label>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ç”»åƒä¸€è¦§</h4>\n      <div id="editor-carousel-list" class="editor-items-list carousel-items">\n        ${r.map((e,t)=>Ze(e,t)).join("")}\n      </div>\n      <button type="button" id="editor-add-carousel-image" class="btn-add-item">\n        <span>+</span> ç”»åƒã‚’è¿½åŠ \n      </button>\n    </div>\n  `}(t);case"video":return console.log("[renderSectionEditorContent] Rendering video editor"),function(t){var n,o,a,i,l,s;const r=(null==(n=t.data)?void 0:n.videoUrl)||"",c=(null==(o=t.data)?void 0:o.videoType)||"youtube",d=(null==(a=t.data)?void 0:a.description)||"",u=(null==(i=t.layout)?void 0:i.aspectRatio)||"16:9",p=(null==(l=t.layout)?void 0:l.fullWidth)||!1;return`\n    <div class="editor-section">\n      <h4>å‹•ç”»è¨­å®š</h4>\n      <div class="form-group">\n        <label for="editor-video-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" id="editor-video-title" value="${e((null==(s=t.data)?void 0:s.sectionTitle)||"")}">\n      </div>\n      <div class="form-group">\n        <label for="editor-video-url">å‹•ç”»URL</label>\n        <input type="url" id="editor-video-url" value="${e(r)}" placeholder="https://www.youtube.com/watch?v=xxxxx">\n        <p class="form-hint">YouTube, Vimeo, ã¾ãŸã¯ç›´æ¥å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®URLã‚’å…¥åŠ›</p>\n      </div>\n      <div class="form-group">\n        <label for="editor-video-type">å‹•ç”»ã‚¿ã‚¤ãƒ—</label>\n        <select id="editor-video-type">\n          <option value="youtube" ${"youtube"===c?"selected":""}>YouTube</option>\n          <option value="vimeo" ${"vimeo"===c?"selected":""}>Vimeo</option>\n          <option value="tiktok" ${"tiktok"===c?"selected":""}>TikTok</option>\n          <option value="direct" ${"direct"===c?"selected":""}>ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆMP4ç­‰ï¼‰</option>\n          <option value="iframe" ${"iframe"===c?"selected":""}>ãã®ä»–ï¼ˆiframeï¼‰</option>\n        </select>\n      </div>\n      <div class="form-group">\n        <label for="editor-video-description">èª¬æ˜æ–‡ï¼ˆä»»æ„ï¼‰</label>\n        <textarea id="editor-video-description" rows="2" placeholder="å‹•ç”»ã®èª¬æ˜æ–‡">${e(d)}</textarea>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>è¡¨ç¤ºè¨­å®š</h4>\n      <div class="form-row">\n        <div class="form-group">\n          <label for="editor-video-aspect">ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”</label>\n          <select id="editor-video-aspect">\n            <option value="16:9" ${"16:9"===u?"selected":""}>16:9ï¼ˆæ¨ªé•·ï¼‰</option>\n            <option value="4:3" ${"4:3"===u?"selected":""}>4:3ï¼ˆæ¨™æº–ï¼‰</option>\n            <option value="1:1" ${"1:1"===u?"selected":""}>1:1ï¼ˆæ­£æ–¹å½¢ï¼‰</option>\n            <option value="9:16" ${"9:16"===u?"selected":""}>9:16ï¼ˆç¸¦é•·ï¼‰</option>\n          </select>\n        </div>\n        <div class="form-group">\n          <label class="checkbox-label">\n            <input type="checkbox" id="editor-video-fullwidth" ${p?"checked":""}>\n            å…¨å¹…è¡¨ç¤º\n          </label>\n        </div>\n      </div>\n    </div>\n\n    <div class="editor-section">\n      <h4>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h4>\n      <div id="editor-video-preview" class="video-preview">\n        ${r?et(r,c):'<p class="preview-empty">URLã‚’å…¥åŠ›ã™ã‚‹ã¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>'}\n      </div>\n    </div>\n  `}(t);case"jobs":case"details":case"apply":return function(e){const t=u[e.type];return`\n    <div class="editor-section">\n      <p class="editor-info">\n        ã€Œ${(null==t?void 0:t.name)||e.type}ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿ã‚„æ±‚äººãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚<br>\n        è¡¨ç¤º/éè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆã¨ä¸¦ã³é †ã®å¤‰æ›´ã®ã¿å¯èƒ½ã§ã™ã€‚\n      </p>\n    </div>\n  `}(t);default:return console.log("[renderSectionEditorContent] Unknown type, returning default"),"<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ç·¨é›†ã§ãã¾ã›ã‚“</p>"}}(Ae);console.log("[openSectionEditor] Editor HTML length:",null==c?void 0:c.length),l.innerHTML=c,function(){Ce={},function(){const e=document.getElementById("hero-image-uploader-container");if(!e)return;const t=e.dataset.currentUrl||"",a=document.getElementById("editor-hero-image"),i=(null==De?void 0:De())||"default",l=n({id:"hero-image-uploader",label:"",currentUrl:t,uploadFn:e=>o(e,i),onUpload:e=>{a&&(a.value=e),Ae&&(Ae.data.image=e),nt()}});e.innerHTML="",e.appendChild(l),Ce.hero=l}(),function(){const e=document.getElementById("custom-image-uploader-container");if(!e)return;const t=e.dataset.currentUrl||"",a=document.getElementById("editor-custom-image"),i=(null==De?void 0:De())||"default",l=n({id:"custom-image-uploader",label:"",currentUrl:t,uploadFn:e=>o(e,i),onUpload:e=>{a&&(a.value=e),Ae&&(Ae.data.image=e),nt()}});e.innerHTML="",e.appendChild(l),Ce.custom=l}(),function(){const e=document.getElementById("editor-gallery-list");if(!e)return;const t=(null==De?void 0:De())||"default";e.querySelectorAll(".gallery-item").forEach((e,a)=>{const i=e.querySelector(".gallery-image-uploader-container");if(!i)return;const l=i.dataset.currentUrl||"",s=e.querySelector(".gallery-url"),r=n({id:`gallery-image-uploader-${a}`,label:"",currentUrl:l,uploadFn:e=>o(e,t),onUpload:e=>{s&&(s.value=e),nt()}});i.innerHTML="",i.appendChild(r),Ce[`gallery-${a}`]=r})}();const e=document.getElementById("editor-add-point");e&&e.addEventListener("click",()=>{const e=document.getElementById("editor-points-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",Ye({title:"",description:""},t)),tt()});const t=document.getElementById("editor-add-faq");t&&t.addEventListener("click",()=>{const e=document.getElementById("editor-faq-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",Qe({question:"",answer:""},t)),tt()});const a=document.getElementById("editor-add-gallery-image");a&&a.addEventListener("click",()=>{const e=document.getElementById("editor-gallery-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",Xe("",t)),tt(),function(e){const t=document.getElementById("editor-gallery-list");if(!t)return;const a=t.querySelectorAll(".gallery-item")[e];if(!a)return;const i=a.querySelector(".gallery-image-uploader-container");if(!i)return;const l=i.dataset.currentUrl||"",s=a.querySelector(".gallery-url"),r=(null==De?void 0:De())||"default",c=n({id:`gallery-image-uploader-${e}`,label:"",currentUrl:l,uploadFn:e=>o(e,r),onUpload:e=>{s&&(s.value=e),nt()}});i.innerHTML="",i.appendChild(c),Ce[`gallery-${e}`]=c}(t)});const i=document.getElementById("editor-add-testimonial");i&&i.addEventListener("click",()=>{const e=document.getElementById("editor-testimonial-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",We({name:"",role:"",quote:""},t)),tt()});const l=document.getElementById("editor-add-carousel-image");l&&l.addEventListener("click",()=>{const e=document.getElementById("editor-carousel-list"),t=e.querySelectorAll(".editor-item").length;e.insertAdjacentHTML("beforeend",Ze("",t)),tt(),function(e){const t=document.getElementById("editor-carousel-list");if(!t)return;const a=t.querySelectorAll(".carousel-item")[e];if(!a)return;const i=a.querySelector(".carousel-image-uploader-container");if(!i)return;const l=i.dataset.currentUrl||"",s=a.querySelector(".carousel-url"),r=(null==De?void 0:De())||"default",c=n({id:`carousel-image-uploader-${e}`,label:"",currentUrl:l,uploadFn:e=>o(e,r),onUpload:e=>{s&&(s.value=e),nt()}});i.innerHTML="",i.appendChild(c),Ce[`carousel-${e}`]=c}(t)});!function(){const e=document.getElementById("editor-carousel-list");if(!e)return;const t=(null==De?void 0:De())||"default";e.querySelectorAll(".carousel-item").forEach((e,a)=>{const i=e.querySelector(".carousel-image-uploader-container");if(!i)return;const l=i.dataset.currentUrl||"",s=e.querySelector(".carousel-url"),r=n({id:`carousel-image-uploader-${a}`,label:"",currentUrl:l,uploadFn:e=>o(e,t),onUpload:e=>{s&&(s.value=e),nt()}});i.innerHTML="",i.appendChild(r),Ce[`carousel-${a}`]=r})}();const s=document.getElementById("editor-video-url"),r=document.getElementById("editor-video-type");s&&s.addEventListener("input",()=>{ot()});r&&r.addEventListener("change",()=>{ot()});const c=document.getElementById("editor-custom-has-button");c&&c.addEventListener("change",()=>{const e=document.getElementById("button-fields");e&&(e.style.display=c.checked?"":"none")});document.querySelectorAll('input[name="custom-variant"]').forEach(e=>{e.addEventListener("change",()=>{document.querySelectorAll(".variant-option").forEach(e=>{e.classList.toggle("selected",e.querySelector("input").checked)})})}),tt()}(),a.style.display="flex"}function ze(){const e=document.getElementById("section-editor-modal");e&&(e.style.display="none"),Ae=null}function Ge(){Ae&&(!function(){var e,t,n,o,a,i,l,s,r,c,d,u,p,m,y,v,g,f,b,h,E,$,I,w,x,S,q;if(!Ae)return;switch(Ae.type){case"hero":Ae.data.title=(null==(e=document.getElementById("editor-hero-title"))?void 0:e.value)||"",Ae.data.subtitle=(null==(t=document.getElementById("editor-hero-subtitle"))?void 0:t.value)||"",Ae.data.image=(null==(n=document.getElementById("editor-hero-image"))?void 0:n.value)||"";break;case"points":Ae.layout.columns=parseInt((null==(o=document.getElementById("editor-points-columns"))?void 0:o.value)||"3"),Ae.data.points=function(){const e=[];return document.querySelectorAll("#editor-points-list .editor-item").forEach((t,n)=>{var o,a;const i=(null==(o=t.querySelector(".point-title"))?void 0:o.value)||"",l=(null==(a=t.querySelector(".point-desc"))?void 0:a.value)||"";(i||l)&&e.push({id:`p${n+1}`,title:i,description:l})}),e}();break;case"faq":Ae.data.items=function(){const e=[];return document.querySelectorAll("#editor-faq-list .editor-item").forEach((t,n)=>{var o,a;const i=(null==(o=t.querySelector(".faq-question"))?void 0:o.value)||"",l=(null==(a=t.querySelector(".faq-answer"))?void 0:a.value)||"";i&&l&&e.push({id:`faq-${n+1}`,question:i,answer:l})}),e}();break;case"custom":Ae.layout.variant=(null==(a=document.querySelector('input[name="custom-variant"]:checked'))?void 0:a.value)||"text-only",Ae.data.title=(null==(i=document.getElementById("editor-custom-title"))?void 0:i.value)||"",Ae.data.content=(null==(l=document.getElementById("editor-custom-content"))?void 0:l.innerHTML)||"",Ae.data.image=(null==(s=document.getElementById("editor-custom-image"))?void 0:s.value)||"";const L=null==(r=document.getElementById("editor-custom-has-button"))?void 0:r.checked;Ae.data.button=L?{text:(null==(c=document.getElementById("editor-button-text"))?void 0:c.value)||"",url:(null==(d=document.getElementById("editor-button-url"))?void 0:d.value)||"#",style:"primary"}:null;break;case"gallery":Ae.layout.columns=parseInt((null==(u=document.getElementById("editor-gallery-columns"))?void 0:u.value)||"3"),Ae.layout.style=(null==(p=document.getElementById("editor-gallery-style"))?void 0:p.value)||"grid",Ae.data.sectionTitle=(null==(m=document.getElementById("editor-gallery-title"))?void 0:m.value)||"",Ae.data.images=function(){const e=[];return document.querySelectorAll("#editor-gallery-list .editor-item").forEach(t=>{var n,o;const a=(null==(n=t.querySelector(".gallery-url"))?void 0:n.value)||"",i=(null==(o=t.querySelector(".gallery-caption"))?void 0:o.value)||"";a&&e.push({url:a,caption:i})}),e}();break;case"testimonial":Ae.layout.style=(null==(y=document.getElementById("editor-testimonial-style"))?void 0:y.value)||"cards",Ae.data.sectionTitle=(null==(v=document.getElementById("editor-testimonial-title"))?void 0:v.value)||"ç¤¾å“¡ã®å£°",Ae.data.testimonials=function(){const e=[];return document.querySelectorAll("#editor-testimonial-list .editor-item").forEach(t=>{var n,o,a,i;const l=(null==(n=t.querySelector(".testimonial-name"))?void 0:n.value)||"",s=(null==(o=t.querySelector(".testimonial-role"))?void 0:o.value)||"",r=(null==(a=t.querySelector(".testimonial-quote"))?void 0:a.value)||"",c=(null==(i=t.querySelector(".testimonial-avatar"))?void 0:i.value)||"";(l||r)&&e.push({name:l,role:s,quote:r,avatar:c})}),e}();break;case"carousel":Ae.data.sectionTitle=(null==(g=document.getElementById("editor-carousel-title"))?void 0:g.value)||"",Ae.data.autoPlay=(null==(f=document.getElementById("editor-carousel-autoplay"))?void 0:f.checked)??!0,Ae.data.interval=parseInt((null==(b=document.getElementById("editor-carousel-interval"))?void 0:b.value)||"5000"),Ae.layout.showDots=(null==(h=document.getElementById("editor-carousel-dots"))?void 0:h.checked)??!0,Ae.layout.showArrows=(null==(E=document.getElementById("editor-carousel-arrows"))?void 0:E.checked)??!0,Ae.data.images=function(){const e=[];return document.querySelectorAll("#editor-carousel-list .editor-item").forEach(t=>{var n,o,a;const i=(null==(n=t.querySelector(".carousel-url"))?void 0:n.value)||"",l=(null==(o=t.querySelector(".carousel-caption"))?void 0:o.value)||"",s=(null==(a=t.querySelector(".carousel-alt"))?void 0:a.value)||"";i&&e.push({url:i,caption:l,alt:s})}),e}();break;case"video":Ae.data.sectionTitle=(null==($=document.getElementById("editor-video-title"))?void 0:$.value)||"",Ae.data.videoUrl=(null==(I=document.getElementById("editor-video-url"))?void 0:I.value)||"",Ae.data.videoType=(null==(w=document.getElementById("editor-video-type"))?void 0:w.value)||"youtube",Ae.data.description=(null==(x=document.getElementById("editor-video-description"))?void 0:x.value)||"",Ae.layout.aspectRatio=(null==(S=document.getElementById("editor-video-aspect"))?void 0:S.value)||"16:9",Ae.layout.fullWidth=(null==(q=document.getElementById("editor-video-fullwidth"))?void 0:q.checked)||!1}}(),Me(),nt(),ze())}function Ye(t,n){return`\n    <div class="editor-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>ãƒã‚¤ãƒ³ãƒˆ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>ã‚¿ã‚¤ãƒˆãƒ«</label>\n        <input type="text" class="point-title" value="${e(t.title||"")}">\n      </div>\n      <div class="form-group">\n        <label>èª¬æ˜</label>\n        <textarea class="point-desc" rows="2">${e(t.description||"")}</textarea>\n      </div>\n    </div>\n  `}function Qe(t,n){return`\n    <div class="editor-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>Q&A ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>è³ªå•</label>\n        <input type="text" class="faq-question" value="${e(t.question||"")}">\n      </div>\n      <div class="form-group">\n        <label>å›ç­”</label>\n        <textarea class="faq-answer" rows="3">${e(t.answer||"")}</textarea>\n      </div>\n    </div>\n  `}function Xe(t,n){const o="string"==typeof t?t:t.url,a="object"==typeof t?t.caption:"";return`\n    <div class="editor-item gallery-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>ç”»åƒ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>ç”»åƒ</label>\n        <div class="gallery-image-uploader-container" data-current-url="${e(o||"")}"></div>\n        <input type="hidden" class="gallery-url" value="${e(o||"")}">\n      </div>\n      <div class="form-group">\n        <label>ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="gallery-caption" value="${e(a||"")}">\n      </div>\n    </div>\n  `}function We(t,n){return`\n    <div class="editor-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>ç¤¾å“¡ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-row">\n        <div class="form-group">\n          <label>åå‰</label>\n          <input type="text" class="testimonial-name" value="${e(t.name||"")}">\n        </div>\n        <div class="form-group">\n          <label>å½¹è·ãƒ»éƒ¨ç½²</label>\n          <input type="text" class="testimonial-role" value="${e(t.role||"")}">\n        </div>\n      </div>\n      <div class="form-group">\n        <label>ã‚³ãƒ¡ãƒ³ãƒˆ</label>\n        <textarea class="testimonial-quote" rows="3">${e(t.quote||"")}</textarea>\n      </div>\n      <div class="form-group">\n        <label>å†™çœŸURLï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="testimonial-avatar" value="${e(t.avatar||"")}">\n      </div>\n    </div>\n  `}function Ze(t,n){const o="string"==typeof t?t:t.url,a="object"==typeof t?t.caption:"",i="object"==typeof t?t.alt:"";return`\n    <div class="editor-item carousel-item" data-index="${n}">\n      <div class="editor-item-header">\n        <span class="drag-handle">â‹®â‹®</span>\n        <span>ç”»åƒ ${n+1}</span>\n        <button type="button" class="btn-remove-item" data-index="${n}">Ã—</button>\n      </div>\n      <div class="form-group">\n        <label>ç”»åƒ</label>\n        <div class="carousel-image-uploader-container" data-current-url="${e(o||"")}"></div>\n        <input type="hidden" class="carousel-url" value="${e(o||"")}">\n      </div>\n      <div class="form-group">\n        <label>ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="carousel-caption" value="${e(a||"")}" placeholder="ç”»åƒã®èª¬æ˜æ–‡">\n      </div>\n      <div class="form-group">\n        <label>ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆï¼ˆä»»æ„ï¼‰</label>\n        <input type="text" class="carousel-alt" value="${e(i||"")}" placeholder="ç”»åƒãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã®ãƒ†ã‚­ã‚¹ãƒˆ">\n      </div>\n    </div>\n  `}function et(t,n){if(!t)return"";if("youtube"===n||t.includes("youtube.com")||t.includes("youtu.be")){const n=function(e){let t=e.match(/[?&]v=([^&]+)/);return t?t[1]:(t=e.match(/youtu\.be\/([^?&]+)/),t?t[1]:(t=e.match(/youtube\.com\/embed\/([^?&]+)/),t?t[1]:(t=e.match(/youtube\.com\/shorts\/([^?&]+)/),t?t[1]:null)))}(t);if(n)return`\n        <div class="video-preview-card video-preview-youtube">\n          <div class="video-preview-icon">â–¶ï¸</div>\n          <div class="video-preview-info">\n            <span class="video-preview-type">YouTube</span>\n            <span class="video-preview-id">ID: ${e(n)}</span>\n          </div>\n        </div>\n      `}return"vimeo"===n||t.includes("vimeo.com")?`\n      <div class="video-preview-card video-preview-vimeo">\n        <div class="video-preview-icon">â–¶ï¸</div>\n        <div class="video-preview-info">\n          <span class="video-preview-type">Vimeo</span>\n          <span class="video-preview-url">${e(t.substring(0,50))}...</span>\n        </div>\n      </div>\n    `:"tiktok"===n||t.includes("tiktok.com")?`\n      <div class="video-preview-card video-preview-tiktok">\n        <div class="video-preview-icon">ğŸµ</div>\n        <div class="video-preview-info">\n          <span class="video-preview-type">TikTok</span>\n          <span class="video-preview-url">${e(t.substring(0,50))}...</span>\n        </div>\n      </div>\n    `:`\n    <div class="video-preview-card video-preview-other">\n      <div class="video-preview-icon">ğŸ¬</div>\n      <div class="video-preview-info">\n        <span class="video-preview-type">å‹•ç”»</span>\n        <span class="video-preview-url">${e(t.substring(0,50))}${t.length>50?"...":""}</span>\n      </div>\n    </div>\n  `}function tt(){document.querySelectorAll(".btn-remove-item").forEach(e=>{e.onclick=e=>{const t=e.target.closest(".editor-item");if(t){t.remove();const e=t.parentElement||document.querySelector(".editor-items-list");e&&e.querySelectorAll(".editor-item").forEach((e,t)=>{e.dataset.index=t;const n=e.querySelector(".editor-item-header span:nth-child(2)");n&&(n.textContent=n.textContent.replace(/\d+/,t+1))})}}})}function nt(){"function"==typeof je&&je()}function ot(){const e=document.getElementById("editor-video-preview"),t=document.getElementById("editor-video-url"),n=document.getElementById("editor-video-type");if(!e||!t)return;const o=t.value.trim(),a=(null==n?void 0:n.value)||"youtube";e.innerHTML=o?et(o,a):'<p class="preview-empty">URLã‚’å…¥åŠ›ã™ã‚‹ã¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>'}const at={default:{primary:"#6366f1",accent:"#818cf8",bg:"#ffffff",text:"#1f2937"},modern:{primary:"#3b82f6",accent:"#60a5fa",bg:"#f8fafc",text:"#1e293b"},yellow:{primary:"#f59e0b",accent:"#fbbf24",bg:"#fffbeb",text:"#78350f"},impact:{primary:"#111827",accent:"#374151",bg:"#f9fafb",text:"#111827"},local:{primary:"#92400e",accent:"#b45309",bg:"#fef3c7",text:"#78350f"},zen:{primary:"#059669",accent:"#10b981",bg:"#f0fdf4",text:"#1f2937"}};let it=null;let lt=!1,st=[],rt=null,ct=[],dt=null;function ut(t){const n=document.getElementById("lp-company-grid");n&&(0!==t.length?(n.innerHTML=t.map(t=>{const n=(t.company||t.companyDomain||"?").charAt(0).toUpperCase();return`\n      <div class="lp-company-card" data-domain="${e(t.companyDomain)}">\n        <div class="lp-company-icon">${e(n)}</div>\n        <div class="lp-company-name">${e(t.company||t.companyDomain)}</div>\n        <div class="lp-company-domain">${e(t.companyDomain)}</div>\n      </div>\n    `}).join(""),n.querySelectorAll(".lp-company-card").forEach(e=>{e.addEventListener("click",async()=>{const t=e.dataset.domain;dt=t,n.querySelectorAll(".lp-company-card").forEach(e=>e.classList.remove("selected")),e.classList.add("selected"),await mt(t);const o=document.getElementById("lp-company-select-group"),a=document.getElementById("lp-job-select-group");o&&(o.style.display="none"),a&&(a.style.display="block"),pt("job");const i=document.getElementById("lp-selected-company-name");if(i){const e=ct.find(e=>e.companyDomain===t);i.textContent=`${(null==e?void 0:e.company)||t} ã®æ±‚äºº`}})})):n.innerHTML='<div class="lp-no-results"><p>è©²å½“ã™ã‚‹ä¼šç¤¾ãŒã‚ã‚Šã¾ã›ã‚“</p></div>')}function pt(e){const t=document.querySelectorAll(".lp-step"),n=["company","job","edit"],o=n.indexOf(e);t.forEach(e=>{const t=e.dataset.step,a=n.indexOf(t);e.classList.remove("active","completed"),a<o?e.classList.add("completed"):a===o&&e.classList.add("active")})}async function mt(t){var n,o;const a=document.getElementById("lp-job-grid"),l=document.getElementById("lp-job-select"),s=ct.find(e=>e.companyDomain===t);if(!s)return void console.warn(`[LPè¨­å®š] ä¼šç¤¾ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${t}`);a&&(a.innerHTML='<div class="lp-loading-placeholder">æ±‚äººã‚’èª­ã¿è¾¼ã¿ä¸­...</div>');const r=null==(n=s.jobsSheet)?void 0:n.trim(),c=null==(o=s.manageSheetUrl)?void 0:o.trim();let d="";if(r)d=`https://docs.google.com/spreadsheets/d/${C}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(r)}`;else if(c){const e=c.match(/\/d\/([a-zA-Z0-9_-]+)/);if(e){d=`https://docs.google.com/spreadsheets/d/${e[1]}/gviz/tq?tqx=out:csv`}}if(!d)return console.warn(`[LPè¨­å®š] æ±‚äººã‚·ãƒ¼ãƒˆURLãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${t}`),void(a&&(a.innerHTML='<div class="lp-no-results"><p>æ±‚äººã‚·ãƒ¼ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p></div>'));try{const t=await fetch(d);if(!t.ok)return console.warn(`[LPè¨­å®š] æ±‚äººã‚·ãƒ¼ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—: ${t.status}`),void(a&&(a.innerHTML='<div class="lp-no-results"><p>æ±‚äººãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p></div>'));const n=function(e,t){const n=e.split("\n"),o=i(n[0]||""),a=[];for(let l=1;l<n.length;l++){if(!n[l].trim())continue;const e=i(n[l]),s={};if(o.forEach((t,n)=>{const o=t.replace(/"/g,"").trim(),a=o.split(" ")[0]||o;s[a]=e[n]||""}),"false"===s.visible||"FALSE"===s.visible)continue;const r=s.jobId||s["æ±‚äººID"]||s.id||s.ID||`job-${l}`,c=s.title||s["ã‚¿ã‚¤ãƒˆãƒ«"]||s["æ±‚äººã‚¿ã‚¤ãƒˆãƒ«"]||s["å‹Ÿé›†ã‚¿ã‚¤ãƒˆãƒ«"]||s["æ±‚äººå"]||s["å‹Ÿé›†å"]||"(ã‚¿ã‚¤ãƒˆãƒ«ãªã—)";a.push({id:`${t.companyDomain}_${r}`,jobId:r,title:c,company:t.company,companyDomain:t.companyDomain,jobsSheet:t.jobsSheet,manageSheetUrl:t.manageSheetUrl,rawData:s})}return a}(await t.text(),s);if(st=n,function(t){const n=document.getElementById("lp-job-grid");if(!n)return;if(0===t.length)return void(n.innerHTML='<div class="lp-no-results"><p>ã“ã®ä¼šç¤¾ã«ã¯æ±‚äººãŒã‚ã‚Šã¾ã›ã‚“</p></div>');n.innerHTML=t.map(t=>`\n    <div class="lp-job-card" data-job-id="${e(t.id)}">\n      <div class="lp-job-title">${e(t.title)}</div>\n      <div class="lp-job-id">ID: ${e(t.jobId)}</div>\n      <div class="lp-job-actions">\n        <button type="button" class="lp-job-action-btn primary lp-select-job-btn">LPè¨­å®šã‚’ç·¨é›†</button>\n        <a href="lp.html?j=${encodeURIComponent(t.id)}" target="_blank" class="lp-job-action-btn secondary">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</a>\n      </div>\n    </div>\n  `).join(""),n.querySelectorAll(".lp-select-job-btn").forEach(e=>{e.addEventListener("click",async t=>{t.stopPropagation();const o=e.closest(".lp-job-card"),a=o.dataset.jobId;n.querySelectorAll(".lp-job-card").forEach(e=>e.classList.remove("selected")),o.classList.add("selected");const i=document.getElementById("lp-job-select");i&&(i.value=a),await gt(a),pt("edit")})})}(n),l){let t='<option value="">-- æ±‚äººã‚’é¸æŠ --</option>';for(const o of n)t+=`<option value="${e(o.id)}">${e(o.title)}</option>`;l.innerHTML=t}}catch(u){console.warn(`[LPè¨­å®š] æ±‚äººèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${t}`,u),a&&(a.innerHTML='<div class="lp-no-results"><p>æ±‚äººãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p></div>')}}async function yt(){return async function(){const e=document.getElementById("lp-company-select-group"),t=document.getElementById("lp-job-select-group"),n=document.getElementById("lp-selection-steps");let o=Ee();if(o&&0!==o.length||(await $e(),o=Ee()),ct=o.filter(e=>e.companyDomain&&("â—‹"===e.showCompany||"â—¯"===e.showCompany)),te()){e&&(e.style.display="block"),t&&(t.style.display="none"),n&&(n.style.display="flex"),ut(ct);const o=document.getElementById("lp-company-search");o&&o.addEventListener("input",e=>{const t=e.target.value.toLowerCase().trim();ut(t?ct.filter(e=>{var n,o;return(null==(n=e.company)?void 0:n.toLowerCase().includes(t))||(null==(o=e.companyDomain)?void 0:o.toLowerCase().includes(t))}):ct)});const a=document.getElementById("lp-back-to-companies");a&&a.addEventListener("click",()=>{e&&(e.style.display="block"),t&&(t.style.display="none");const n=document.getElementById("lp-editor");n&&(n.style.display="none"),pt("company")})}else{const o=ee();e&&(e.style.display="none"),n&&(n.style.display="none");const a=document.getElementById("lp-back-to-companies");a&&(a.style.display="none"),o?(dt=o,await mt(o),t&&(t.style.display="block")):(console.warn("[LPè¨­å®š] ä¼šç¤¾ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"),t&&(t.style.display="none"))}}()}function vt(e){const t=document.getElementById("lp-editor");if(!t)return;t.querySelectorAll("input, select, textarea, button").forEach(t=>{t.disabled=e});const n=document.getElementById("btn-save-lp-settings"),o=document.getElementById("btn-reset-lp-settings");n&&(n.disabled=e),o&&(o.disabled=e);const a=t.querySelector(".lp-loading-overlay");if(e){if(!a){const e=document.createElement("div");e.className="lp-loading-overlay",e.innerHTML='<div class="loading-spinner"></div><p>èª­ã¿è¾¼ã¿ä¸­...</p>',t.style.position="relative",t.appendChild(e)}}else null==a||a.remove()}async function gt(e){var t,n;const o=document.getElementById("lp-editor"),a=document.getElementById("lp-preview-btn"),l=document.getElementById("lp-edit-mode-btn");if(!e)return o&&(o.style.display="none"),void(rt=null);if(rt=st.find(t=>t.id===e),!rt)return void(o&&(o.style.display="none"));o&&(o.style.display="block"),vt(!0);const s=rt.id;a&&(a.href=`lp.html?j=${encodeURIComponent(s)}`),l&&(l.href=`lp.html?j=${encodeURIComponent(s)}&edit`),Ot(),Dt((null==rt?void 0:rt.companyDomain)||dt);const r=document.querySelector('input[name="design-pattern"][value="standard"]');r&&(r.checked=!0);try{const o=(null==(t=rt.manageSheetUrl)?void 0:t.trim())||(null==(n=rt.jobsSheet)?void 0:n.trim());if(console.log("[LPè¨­å®š] ç®¡ç†ã‚·ãƒ¼ãƒˆURL:",o),!o)return console.log("[LPè¨­å®š] ç®¡ç†ã‚·ãƒ¼ãƒˆURLãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"),void Nt();let a=null;const l=o.match(/\/d\/([a-zA-Z0-9_-]+)/);if(l?a=l[1]:/^[a-zA-Z0-9_-]+$/.test(o)&&(a=o),!a)return console.log("[LPè¨­å®š] ç®¡ç†ã‚·ãƒ¼ãƒˆIDã‚’æŠ½å‡ºã§ãã¾ã›ã‚“"),void Nt();const s=Date.now(),r=`https://docs.google.com/spreadsheets/d/${a}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent("LPè¨­å®š")}&_t=${s}`;console.log("[LPè¨­å®š] LPè¨­å®šã‚·ãƒ¼ãƒˆURL:",r);const c=await fetch(r,{cache:"no-store"});if(c.ok){const t=function(e,t){const n=function(e){const t=[];let n="",o=!1;for(let a=0;a<e.length;a++){const i=e[a];if('"'===i)'"'===e[a+1]?(n+='""',a++):(o=!o,n+=i);else if("\n"!==i||o){if("\r"===i)continue;n+=i}else n.trim()&&t.push(n),n=""}n.trim()&&t.push(n);return t}(e),o=i(n[0]||"");for(let a=1;a<n.length;a++){if(!n[a].trim())continue;const e=i(n[a]),l={};o.forEach((t,n)=>{const o=t.replace(/"/g,"").trim();l[o]=e[n]||""});if((l.jobId||l["æ±‚äººID"]||"")===t){const e={heroTitle:l.heroTitle||l["ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¿ã‚¤ãƒˆãƒ«"]||"",heroSubtitle:l.heroSubtitle||l["ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«"]||"",heroImage:l.heroImage||l["ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒ"]||"",ctaText:l.ctaText||l["CTAãƒ†ã‚­ã‚¹ãƒˆ"]||"",faq:l.faq||l.FAQ||"",designPattern:l.designPattern||l["ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³"]||"",layoutStyle:l.layoutStyle||l["ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚¹ã‚¿ã‚¤ãƒ«"]||"default",sectionOrder:l.sectionOrder||l["ã‚»ã‚¯ã‚·ãƒ§ãƒ³é †åº"]||"",sectionVisibility:l.sectionVisibility||l["ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤º"]||"",tiktokPixelId:l.tiktokPixelId||l["TikTok Pixel ID"]||"",googleAdsId:l.googleAdsId||l["Google Ads ID"]||"",googleAdsLabel:l.googleAdsLabel||l["Google Ads ãƒ©ãƒ™ãƒ«"]||"",metaPixelId:l.metaPixelId||l["Meta Pixel ID"]||"",lineTagId:l.lineTagId||l["LINE Tag ID"]||"",clarityProjectId:l.clarityProjectId||l["Clarity Project ID"]||"",ogpTitle:l.ogpTitle||l["OGPã‚¿ã‚¤ãƒˆãƒ«"]||"",ogpDescription:l.ogpDescription||l["OGPèª¬æ˜æ–‡"]||"",ogpImage:l.ogpImage||l["OGPç”»åƒ"]||"",showVideoButton:l.showVideoButton||l["å‹•ç”»ãƒœã‚¿ãƒ³è¡¨ç¤º"]||"",videoUrl:l.videoUrl||l["å‹•ç”»URL"]||"",lpContent:l.lpContent||l["LPæ§‹æˆ"]||"",customPrimary:l.customPrimary||l["ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰"]||"",customAccent:l.customAccent||l["ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ï¼ˆã‚¢ã‚¯ã‚»ãƒ³ãƒˆï¼‰"]||"",customBg:l.customBg||l["ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ï¼ˆèƒŒæ™¯ï¼‰"]||"",customText:l.customText||l["ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ï¼ˆãƒ†ã‚­ã‚¹ãƒˆï¼‰"]||""};for(let t=1;t<=6;t++)e[`pointTitle${t}`]=l[`pointTitle${t}`]||l[`ãƒã‚¤ãƒ³ãƒˆ${t}ã‚¿ã‚¤ãƒˆãƒ«`]||"",e[`pointDesc${t}`]=l[`pointDesc${t}`]||l[`ãƒã‚¤ãƒ³ãƒˆ${t}èª¬æ˜`]||"";return e}}return null}(await c.text(),e);if(t){ft("lp-hero-title",t.heroTitle),ft("lp-hero-subtitle",t.heroSubtitle),ft("lp-hero-image",t.heroImage);const e=[];for(let a=1;a<=6;a++){const n=t[`pointTitle${a}`]||"",o=t[`pointDesc${a}`]||"";(n||o)&&e.push({title:n,desc:o})}St(e.length>0?e:[{title:"",desc:""},{title:"",desc:""},{title:"",desc:""}]),ft("lp-cta-text",t.ctaText||"ä»Šã™ãå¿œå‹Ÿã™ã‚‹"),ft("lp-faq",t.faq);if(Pt(function(e){if(!e)return[{question:"",answer:""}];const t=[],n=e.replace(/\\n/g,"\n").split(/\|\||[\n\r]+/).filter(e=>e.trim());for(const o of n){const e=o.match(/Q[:ï¼š](.+?)\|A[:ï¼š](.+)/i);e&&t.push({question:e[1].trim(),answer:e[2].trim()})}return t.length>0?t:[{question:"",answer:""}]}(t.faq)),t.designPattern){const e=document.querySelector(`input[name="design-pattern"][value="${t.designPattern}"]`);e&&(e.checked=!0)}t.sectionOrder&&function(e){const t=document.getElementById("lp-section-order");if(!t||!e)return;const n=e.split(",").map(e=>e.trim()).filter(e=>e);if(0===n.length)return;const o=Array.from(t.querySelectorAll(".section-order-item")),a={};o.forEach(e=>{a[e.dataset.section]=e}),n.forEach(e=>{const n=a[e];n&&t.appendChild(n)})}(t.sectionOrder),t.sectionVisibility&&function(e){if(!e)return;try{const t=JSON.parse(e);["points","jobs","details","faq"].forEach(e=>{if(void 0!==t[e]){const n=document.getElementById(`section-${e}-visible`);n&&(n.checked=t[e])}})}catch(t){console.error("ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤ºçŠ¶æ…‹ã®ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼:",t)}}(t.sectionVisibility),ft("lp-tiktok-pixel",t.tiktokPixelId),ft("lp-google-ads-id",t.googleAdsId),ft("lp-google-ads-label",t.googleAdsLabel),ft("lp-meta-pixel",t.metaPixelId),ft("lp-line-tag",t.lineTagId),ft("lp-clarity",t.clarityProjectId),ft("lp-ogp-title",t.ogpTitle),ft("lp-ogp-description",t.ogpDescription),ft("lp-ogp-image",t.ogpImage);const n=document.getElementById("lp-show-video-button"),o=document.getElementById("video-url-group");return n&&(n.checked="true"===String(t.showVideoButton).toLowerCase()||!0===t.showVideoButton,o&&(o.style.display=n.checked?"block":"none")),ft("lp-video-url",t.videoUrl),bt({primary:t.customPrimary||"",accent:t.customAccent||"",bg:t.customBg||"",text:t.customText||""}),Ht(t.heroImage||""),jt(t.heroImage||""),xt(),Ue(t),Me(),void wt()}}}catch(c){console.log("LPè¨­å®šã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")}finally{vt(!1)}Nt(),wt()}function ft(e,t){const n=document.getElementById(e);n&&(n.value=t||"")}function bt(e){["primary","accent","bg","text"].forEach(t=>{const n=document.getElementById(`lp-custom-${t}`),o=document.getElementById(`lp-custom-${t}-text`),a=e[t]||"";n&&(n.value=a||("bg"===t?"#ffffff":"text"===t?"#1f2937":"#000000")),o&&(o.value=a)})}function ht(){var e;const t=document.querySelector(".lp-admin-layout-option.selected"),n=(null==(e=null==t?void 0:t.dataset)?void 0:e.layout)||"default",o=at[n]||at.default;["primary","accent","bg","text"].forEach(e=>{const t=document.getElementById(`lp-custom-${e}`),n=document.getElementById(`lp-custom-${e}-text`);t&&(t.value=o[e]||"#000000"),n&&(n.value="")})}function Et(){["primary","accent","bg","text"].forEach(e=>{const t=document.getElementById(`lp-custom-${e}`),n=document.getElementById(`lp-custom-${e}-text`);t&&n&&(t.addEventListener("input",()=>{n.value=t.value,Kt()}),n.addEventListener("input",()=>{const e=n.value;/^#[0-9A-Fa-f]{6}$/.test(e)&&(t.value=e),Kt()}))});const e=document.getElementById("lp-reset-colors");e&&e.addEventListener("click",()=>{ht(),Kt()})}function $t(){var e,t,n,o,a;const i=document.querySelector(".lp-admin-layout-option.selected"),l=(null==(e=null==i?void 0:i.dataset)?void 0:e.layout)||"default",s=at[l]||at.default;return{primary:(null==(t=document.getElementById("lp-custom-primary-text"))?void 0:t.value)||s.primary,accent:(null==(n=document.getElementById("lp-custom-accent-text"))?void 0:n.value)||s.accent,bg:(null==(o=document.getElementById("lp-custom-bg-text"))?void 0:o.value)||s.bg,text:(null==(a=document.getElementById("lp-custom-text-text"))?void 0:a.value)||s.text}}let It=!1;function wt(){if(It)return void Gt();if(!document.getElementById("lp-preview-container"))return;["lp-hero-title","lp-hero-subtitle","lp-hero-image","lp-cta-text","lp-faq","lp-tiktok-pixel","lp-google-ads-id","lp-google-ads-label","lp-meta-pixel","lp-line-tag","lp-clarity","lp-ogp-title","lp-ogp-description","lp-ogp-image","lp-video-url"].forEach(e=>{const t=document.getElementById(e);t&&t.addEventListener("input",()=>Kt())}),document.querySelectorAll('input[name="design-pattern"]').forEach(e=>{e.addEventListener("change",()=>Kt())});const e=document.getElementById("lp-show-video-button");e&&e.addEventListener("change",()=>Kt()),document.querySelectorAll(".lp-admin-layout-option").forEach(e=>{e.addEventListener("click",()=>{setTimeout(()=>Kt(),50)})}),Et(),It=!0,Gt()}function xt(){lt||(Pe(Gt,{getCompanyDomain:()=>(null==rt?void 0:rt.companyDomain)||null}),lt=!0)}function St(t=[{title:"",desc:""},{title:"",desc:""},{title:"",desc:""}]){const n=document.getElementById("point-inputs-container");n&&(n.innerHTML=t.map((t,n)=>`\n    <div class="point-input-group" data-point-index="${n}">\n      <label>ãƒã‚¤ãƒ³ãƒˆ${n+1}</label>\n      <input type="text" class="point-title" placeholder="ã‚¿ã‚¤ãƒˆãƒ«" value="${e(t.title||"")}">\n      <input type="text" class="point-desc" placeholder="èª¬æ˜æ–‡" value="${e(t.desc||"")}">\n      <button type="button" class="btn-remove-point" title="å‰Šé™¤">&times;</button>\n    </div>\n  `).join(""),n.querySelectorAll(".btn-remove-point").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.closest(".point-input-group");t&&n.children.length>1&&(t.remove(),qt(),Lt(),Kt())})}),n.querySelectorAll("input").forEach(e=>{e.addEventListener("input",()=>Kt())}),Lt())}function qt(){const e=document.getElementById("point-inputs-container");e&&e.querySelectorAll(".point-input-group").forEach((e,t)=>{e.dataset.pointIndex=t;const n=e.querySelector("label");n&&(n.textContent=`ãƒã‚¤ãƒ³ãƒˆ${t+1}`)})}function Lt(){const e=document.getElementById("point-inputs-container"),t=document.getElementById("btn-add-point");if(!e||!t)return;const n=e.children.length;t.disabled=n>=6}function Tt(){const e=document.getElementById("point-inputs-container");if(!e)return;const t=e.children.length;if(t>=6)return;const n=t,o=document.createElement("div");o.className="point-input-group",o.dataset.pointIndex=n,o.innerHTML=`\n    <label>ãƒã‚¤ãƒ³ãƒˆ${n+1}</label>\n    <input type="text" class="point-title" placeholder="ã‚¿ã‚¤ãƒˆãƒ«" value="">\n    <input type="text" class="point-desc" placeholder="èª¬æ˜æ–‡" value="">\n    <button type="button" class="btn-remove-point" title="å‰Šé™¤">&times;</button>\n  `,o.querySelector(".btn-remove-point").addEventListener("click",()=>{e.children.length>1&&(o.remove(),qt(),Lt(),Kt())}),o.querySelectorAll("input").forEach(e=>{e.addEventListener("input",()=>Kt())}),e.appendChild(o),Lt(),o.querySelector(".point-title").focus()}function Bt(){const e=document.getElementById("point-inputs-container");if(!e)return[];const t=[];return e.querySelectorAll(".point-input-group").forEach(e=>{var n,o;const a=(null==(n=e.querySelector(".point-title"))?void 0:n.value)||"",i=(null==(o=e.querySelector(".point-desc"))?void 0:o.value)||"";t.push({title:a,desc:i})}),t}function kt(){const e=document.getElementById("btn-add-point");e&&e.addEventListener("click",Tt),St()}function At(){const e=document.getElementById("lp-show-video-button"),t=document.getElementById("video-url-group");e&&t&&e.addEventListener("change",()=>{t.style.display=e.checked?"block":"none"})}function jt(t){const n=document.getElementById("lp-hero-image-preview");n&&(t?(n.innerHTML=`<img src="${e(t)}" alt="ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" style="max-width: 200px; max-height: 120px; object-fit: cover; border-radius: 8px;">`,n.style.display="block"):(n.innerHTML="",n.style.display="none"))}function Dt(e){let n=document.getElementById("btn-upload-hero-image"),i=document.getElementById("lp-hero-image");const l=document.getElementById("lp-hero-image-preview");if(!n||!i)return;const s=n.cloneNode(!0);n.parentNode.replaceChild(s,n),n=s,i.addEventListener("input",()=>{jt(i.value)}),i.value&&jt(i.value),n.addEventListener("click",async()=>{const s=e||dt;if(s)try{const e=await a({accept:"image/png,image/jpeg,image/webp"});n.disabled=!0,n.innerHTML='<span class="upload-spinner"></span> ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...',l&&(l.classList.add("uploading"),l.innerHTML='<div class="upload-spinner"></div>',l.style.display="block");const r=Date.now(),c=await o(e,s),d=c.includes("?")?`${c}&t=${r}`:`${c}?t=${r}`;i.value=d,i.dispatchEvent(new Event("input",{bubbles:!0})),jt(d),Ht(d),t("ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ","success")}catch(r){console.error("[LPSettings] ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:",r),"ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ"!==r.message&&t("ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ: "+r.message,"error"),jt(i.value)}finally{n.disabled=!1,n.innerHTML='<span class="upload-icon">ğŸ“·</span> ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',l&&l.classList.remove("uploading")}else t("ä¼šç¤¾æƒ…å ±ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“","error")})}function Ct(){const e=document.getElementById("btn-add-faq");e&&e.addEventListener("click",Ut),Pt([{question:"",answer:""}])}function Pt(t=[{question:"",answer:""}]){const n=document.getElementById("faq-list");n&&(n.innerHTML=t.map((t,n)=>`\n    <div class="faq-item" data-index="${n}">\n      <div class="faq-item-header">\n        <span class="faq-item-number">Q${n+1}</span>\n        <div class="faq-item-actions">\n          <button type="button" class="faq-action-btn delete" data-index="${n}" title="å‰Šé™¤">\n            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>\n          </button>\n        </div>\n      </div>\n      <div class="faq-fields">\n        <div class="faq-field">\n          <label>\n            <span class="faq-label-icon q">Q</span>\n            è³ªå•\n          </label>\n          <input type="text" class="faq-question-input" value="${e(t.question)}" placeholder="ä¾‹: æœªçµŒé¨“ã§ã‚‚å¿œå‹Ÿã§ãã¾ã™ã‹ï¼Ÿ">\n        </div>\n        <div class="faq-field">\n          <label>\n            <span class="faq-label-icon a">A</span>\n            å›ç­”\n          </label>\n          <textarea class="faq-answer-input" rows="2" placeholder="ä¾‹: ã¯ã„ã€æœªçµŒé¨“ã®æ–¹ã‚‚å¤§æ­“è¿ã§ã™ã€‚ä¸å¯§ã«æŒ‡å°ã„ãŸã—ã¾ã™ã€‚">${e(t.answer)}</textarea>\n        </div>\n      </div>\n    </div>\n  `).join(""),n.querySelectorAll(".faq-action-btn.delete").forEach(e=>{e.addEventListener("click",()=>{!function(e){const t=Mt();t.length<=1?Pt([{question:"",answer:""}]):(t.splice(e,1),Pt(t));Rt(),Kt()}(parseInt(e.dataset.index))})}),n.querySelectorAll(".faq-question-input, .faq-answer-input").forEach(e=>{e.addEventListener("input",()=>{Rt(),Kt()})}),Rt())}function Ut(){const e=Mt();e.push({question:"",answer:""}),Pt(e),Rt(),setTimeout(()=>{const e=document.querySelector(".faq-item:last-child .faq-question-input");e&&e.focus()},100)}function Mt(){const e=document.getElementById("faq-list");if(!e)return[];const t=[];return e.querySelectorAll(".faq-item").forEach(e=>{var n,o,a,i;const l=(null==(o=null==(n=e.querySelector(".faq-question-input"))?void 0:n.value)?void 0:o.trim())||"",s=(null==(i=null==(a=e.querySelector(".faq-answer-input"))?void 0:a.value)?void 0:i.trim())||"";t.push({question:l,answer:s})}),t}function Rt(){const e=Mt(),t=document.getElementById("lp-faq");if(t){const n=e.filter(e=>e.question||e.answer).map(e=>`Q:${e.question}|A:${e.answer}`).join("\n");t.value=n}}function Nt(){["lp-hero-title","lp-hero-subtitle","lp-hero-image","lp-faq","lp-tiktok-pixel","lp-google-ads-id","lp-google-ads-label","lp-ogp-title","lp-ogp-description","lp-ogp-image","lp-video-url"].forEach(e=>ft(e,"")),ft("lp-cta-text","ä»Šã™ãå¿œå‹Ÿã™ã‚‹");const e=document.getElementById("lp-show-video-button"),t=document.getElementById("video-url-group");e&&(e.checked=!1),t&&(t.style.display="none"),St(),Pt([{question:"",answer:""}]);const n=document.querySelector('input[name="design-pattern"][value="standard"]');n&&(n.checked=!0),ht(),Ht(""),xt(),Ue({}),Me()}function Ot(){const t=document.getElementById("hero-image-presets");t&&(t.innerHTML=R.map(t=>`\n    <div class="hero-image-preset" data-url="${e(t.url)}" title="${e(t.name)}">\n      <img src="${e(t.thumbnail)}" alt="${e(t.name)}" loading="lazy">\n      <span class="preset-name">${e(t.name)}</span>\n      <span class="preset-check">âœ“</span>\n    </div>\n  `).join(""),t.querySelectorAll(".hero-image-preset").forEach(e=>{e.addEventListener("click",()=>{!function(e){const t=document.getElementById("lp-hero-image");t&&(t.value=e,t.dispatchEvent(new Event("input",{bubbles:!0})));Ht(e)}(e.dataset.url)})}))}function Ht(e){const t=document.getElementById("hero-image-presets");t&&t.querySelectorAll(".hero-image-preset").forEach(t=>{const n=t.dataset.url,o=(null==e?void 0:e.split("?")[0])||"",a=(null==n?void 0:n.split("?")[0])||"";o&&a&&o===a?t.classList.add("selected"):t.classList.remove("selected")})}async function _t(){var e,t,n,o,a,i,l,s,r,c,d,u,p,m,y,v,g,f,b,h,E,$,I,w,x,S,q,L;console.log("[LPä¿å­˜] saveLPSettings é–‹å§‹");const T=null==(e=document.getElementById("lp-job-select"))?void 0:e.value;if(console.log("[LPä¿å­˜] jobId:",T),!T)return alert("æ±‚äººã‚’é¸æŠã—ã¦ãã ã•ã„"),void console.log("[LPä¿å­˜] jobIdãŒãªã„ãŸã‚ä¸­æ–­");const B=rt||st.find(e=>e.id===T);if(console.log("[LPä¿å­˜] jobData:",B),!B)return alert("æ±‚äººãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"),void console.log("[LPä¿å­˜] jobDataãŒãªã„ãŸã‚ä¸­æ–­");const k=Bt(),A=document.querySelector(".lp-admin-layout-option.selected"),j=(null==(t=null==A?void 0:A.dataset)?void 0:t.layout)||"default",D={jobId:T,companyDomain:B.companyDomain,company:B.company,jobTitle:B.title,designPattern:(null==(n=document.querySelector('input[name="design-pattern"]:checked'))?void 0:n.value)||"standard",layoutStyle:j,heroTitle:(null==(o=document.getElementById("lp-hero-title"))?void 0:o.value)||"",heroSubtitle:(null==(a=document.getElementById("lp-hero-subtitle"))?void 0:a.value)||"",heroImage:(null==(i=document.getElementById("lp-hero-image"))?void 0:i.value)||"",ctaText:(null==(l=document.getElementById("lp-cta-text"))?void 0:l.value)||"",faq:(null==(s=document.getElementById("lp-faq"))?void 0:s.value)||"",sectionOrder:Ft().join(","),sectionVisibility:JSON.stringify(Vt())};for(let U=0;U<6;U++)D[`pointTitle${U+1}`]=(null==(r=k[U])?void 0:r.title)||"",D[`pointDesc${U+1}`]=(null==(c=k[U])?void 0:c.desc)||"";D.tiktokPixelId=(null==(d=document.getElementById("lp-tiktok-pixel"))?void 0:d.value)||"",D.googleAdsId=(null==(u=document.getElementById("lp-google-ads-id"))?void 0:u.value)||"",D.googleAdsLabel=(null==(p=document.getElementById("lp-google-ads-label"))?void 0:p.value)||"",D.metaPixelId=(null==(m=document.getElementById("lp-meta-pixel"))?void 0:m.value)||"",D.lineTagId=(null==(y=document.getElementById("lp-line-tag"))?void 0:y.value)||"",D.clarityProjectId=(null==(v=document.getElementById("lp-clarity"))?void 0:v.value)||"",D.ogpTitle=(null==(g=document.getElementById("lp-ogp-title"))?void 0:g.value)||"",D.ogpDescription=(null==(f=document.getElementById("lp-ogp-description"))?void 0:f.value)||"",D.ogpImage=(null==(b=document.getElementById("lp-ogp-image"))?void 0:b.value)||"",$t(),D.customPrimary=(null==(h=document.getElementById("lp-custom-primary-text"))?void 0:h.value)||"",D.customAccent=(null==(E=document.getElementById("lp-custom-accent-text"))?void 0:E.value)||"",D.customBg=(null==($=document.getElementById("lp-custom-bg-text"))?void 0:$.value)||"",D.customText=(null==(I=document.getElementById("lp-custom-text-text"))?void 0:I.value)||"";const C={version:"2.0",sections:Be,globalSettings:ke};if(C){D.lpContent=JSON.stringify(C);const e=null==(w=C.sections)?void 0:w.find(e=>"heroCta"===e.type);(null==e?void 0:e.data)?(D.showVideoButton=e.data.showVideoButton?"true":"false",D.videoUrl=e.data.videoUrl||""):(D.showVideoButton=(null==(x=document.getElementById("lp-show-video-button"))?void 0:x.checked)?"true":"false",D.videoUrl=(null==(S=document.getElementById("lp-video-url"))?void 0:S.value)||"")}else D.showVideoButton=(null==(q=document.getElementById("lp-show-video-button"))?void 0:q.checked)?"true":"false",D.videoUrl=(null==(L=document.getElementById("lp-video-url"))?void 0:L.value)||"";console.log("[LPä¿å­˜] é€ä¿¡ã™ã‚‹è¨­å®š:",D),console.log("[LPä¿å­˜] layoutStyle:",D.layoutStyle),console.log("[LPä¿å­˜] faq:",D.faq),console.log("[LPä¿å­˜] lpContent:",D.lpContent?"ã‚ã‚Š":"ãªã—"),console.log("[LPä¿å­˜] showVideoButton:",D.showVideoButton),console.log("[LPä¿å­˜] videoUrl:",D.videoUrl);const P=U;try{const e=document.getElementById("btn-save-lp-settings");e&&(e.disabled=!0,e.textContent="ä¿å­˜ä¸­...");const t=btoa(unescape(encodeURIComponent(JSON.stringify({action:"saveLPSettings",settings:D})))),n=`${P}?action=post&data=${encodeURIComponent(t)}`,o=await fetch(n,{method:"GET",redirect:"follow"}),a=await o.text();let i;console.log("[LPä¿å­˜] GASãƒ¬ã‚¹ãƒãƒ³ã‚¹:",a);try{i=JSON.parse(a),console.log("[LPä¿å­˜] ãƒ‘ãƒ¼ã‚¹æ¸ˆã¿ãƒ¬ã‚¹ãƒãƒ³ã‚¹:",i)}catch(M){throw e&&(e.disabled=!1,e.textContent="LPè¨­å®šã‚’ä¿å­˜"),new Error(`GASã‹ã‚‰ã®å¿œç­”ãŒä¸æ­£ã§ã™: ${a.substring(0,200)}`)}if(e&&(e.disabled=!1,e.textContent="LPè¨­å®šã‚’ä¿å­˜"),!i.success)return void alert("ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: "+(i.error||"ä¸æ˜ãªã‚¨ãƒ©ãƒ¼"));localStorage.removeItem(`lp_settings_${T}`),alert(`LPè¨­å®šã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜ã—ã¾ã—ãŸã€‚\n\næ±‚äºº: ${B.title}\nä¼šç¤¾: ${B.company}\nãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³: ${D.designPattern}`)}catch(R){console.error("GAS APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼:",R),alert("ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ã¾ã™ã€‚"),function(e,t,n){const o=`lp_settings_${t}`;localStorage.setItem(o,JSON.stringify(e)),alert(`LPè¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ã¾ã—ãŸã€‚\n\næ³¨æ„: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è‡ªå‹•ä¿å­˜ã™ã‚‹ã«ã¯ã€è¨­å®šç”»é¢ã§GAS API URLã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚\n\næ±‚äºº: ${(null==n?void 0:n.title)||t}\nãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³: ${e.designPattern}`)}(D,T,B)}}function Ft(){const e=document.getElementById("lp-section-order");return e?Array.from(e.querySelectorAll("li")).map(e=>e.dataset.section):["hero","points","jobs","details","faq","apply"]}function Vt(){var e,t,n,o;return{points:(null==(e=document.getElementById("section-points-visible"))?void 0:e.checked)??!0,jobs:(null==(t=document.getElementById("section-jobs-visible"))?void 0:t.checked)??!0,details:(null==(n=document.getElementById("section-details-visible"))?void 0:n.checked)??!0,faq:(null==(o=document.getElementById("section-faq-visible"))?void 0:o.checked)??!0}}function Kt(){it&&clearTimeout(it),it=setTimeout(()=>{Gt()},300)}function Jt(){Gt()}function zt(){}function Gt(){const t=document.getElementById("lp-preview-frame"),n=document.getElementById("lp-preview-container");if(!t||!n)return;const o=dt;if(!o)return;const a=Ee(),i=function(t,n){const o=`lp-pattern-${n.designPattern||"standard"}`,a=n.layoutStyle||"default",i=at[a]||at.default,l={primary:n.customPrimary||i.primary,accent:n.customAccent||i.accent,bg:n.customBg||i.bg,text:n.customText||i.text};let s={points:!0,jobs:!0,details:!0,faq:!0};try{n.sectionVisibility&&(s={...s,...JSON.parse(n.sectionVisibility)})}catch(p){}const r=["hero","points","jobs","details","faq","apply"];let c=r;if(n.sectionOrder){const e=n.sectionOrder.split(",").map(e=>e.trim()).filter(e=>e);if(e.length>0){const t=r.filter(t=>!e.includes(t));c=[...e,...t]}}const d=c.map(o=>{switch(o){case"hero":return function(t,n){const o=n.heroTitle||`${t.company||"ä¼šç¤¾å"}ã§åƒã“ã†`,a=n.heroSubtitle||"",i=n.heroImage||"";return`\n    <section class="lp-hero">\n      <div class="lp-hero-bg" style="${i?`background-image: url('${e(i)}')`:"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}"></div>\n      <div class="lp-hero-overlay"></div>\n      <div class="lp-hero-content">\n        <p class="lp-hero-company">${e(t.company||"")}</p>\n        <h1 class="lp-hero-title">${e(o)}</h1>\n        ${a?`<p class="lp-hero-subtitle">${e(a)}</p>`:""}\n        <div class="lp-hero-cta">\n          <a href="#lp-apply" class="lp-btn-apply-hero">ä»Šã™ãå¿œå‹Ÿã™ã‚‹</a>\n        </div>\n      </div>\n    </section>\n  `}(t,n);case"points":return s.points?function(t){const n=[];for(let e=1;e<=6;e++){const o=t[`pointTitle${e}`],a=t[`pointDesc${e}`]||"";o&&n.push({title:o,desc:a,idx:e})}return 0===n.length?"":`\n    <section class="lp-points">\n      <div class="lp-section-inner">\n        <h2 class="lp-section-title">ã“ã®æ±‚äººã®ãƒã‚¤ãƒ³ãƒˆ</h2>\n        <div class="lp-points-grid">\n          ${n.map((t,n)=>`\n            <div class="lp-point-card">\n              <div class="lp-point-number">${n+1}</div>\n              <h3 class="lp-point-title">${e(t.title)}</h3>\n              <p class="lp-point-desc">${e(t.desc)}</p>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n    </section>\n  `}(n):"";case"jobs":return s.jobs?'\n    <section class="lp-jobs">\n      <div class="lp-section-inner">\n        <h2 class="lp-section-title">å‹Ÿé›†ä¸­ã®æ±‚äºº</h2>\n        <div class="lp-jobs-placeholder">\n          <p>æ±‚äººæƒ…å ±ã¯å®Ÿéš›ã®ãƒšãƒ¼ã‚¸ã§ã”ç¢ºèªãã ã•ã„</p>\n        </div>\n      </div>\n    </section>\n  ':"";case"details":return s.details?'\n    <section class="lp-details">\n      <div class="lp-section-inner">\n        <h2 class="lp-section-title">å‹Ÿé›†è¦é …</h2>\n        <div class="lp-details-placeholder">\n          <p>è©³ç´°ãªå‹Ÿé›†è¦é …ã¯å®Ÿéš›ã®ãƒšãƒ¼ã‚¸ã§ã”ç¢ºèªãã ã•ã„</p>\n        </div>\n      </div>\n    </section>\n  ':"";case"faq":return s.faq&&n.faq?function(t){if(!t)return"";const n=t.split(/\|\||[\n\r]+/).filter(e=>e.trim()).map(e=>{const t=e.match(/Q[:ï¼š](.+?)\|A[:ï¼š](.+)/i);return t?{question:t[1].trim(),answer:t[2].trim()}:null}).filter(e=>e&&e.question&&e.answer);return 0===n.length?"":`\n    <section class="lp-faq">\n      <div class="lp-section-inner">\n        <h2 class="lp-section-title">ã‚ˆãã‚ã‚‹è³ªå•</h2>\n        <div class="lp-faq-list">\n          ${n.map(t=>`\n            <div class="lp-faq-item">\n              <div class="lp-faq-question">\n                <span class="lp-faq-q">Q</span>\n                <span>${e(t.question)}</span>\n              </div>\n              <div class="lp-faq-answer">\n                <span class="lp-faq-a">A</span>\n                <span>${e(t.answer)}</span>\n              </div>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n    </section>\n  `}(n.faq):"";case"apply":return function(t,n){const o=n.ctaText||"ä»Šã™ãå¿œå‹Ÿã™ã‚‹";return`\n    <section class="lp-apply" id="lp-apply">\n      <div class="lp-section-inner">\n        <h2 class="lp-section-title">å¿œå‹Ÿã™ã‚‹</h2>\n        <p class="lp-apply-text">ã”å¿œå‹ŸãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™</p>\n        <div class="lp-apply-buttons">\n          <button class="lp-btn-apply-main">${e(o)}</button>\n        </div>\n      </div>\n    </section>\n  `}(0,n);default:return""}}).join(""),u=`\n    --lp-primary: ${l.primary};\n    --lp-accent: ${l.accent};\n    --lp-bg: ${l.bg};\n    --lp-text: ${l.text};\n  `;return`\n<!DOCTYPE html>\n<html lang="ja">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">\n  <style>\n    \n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: 'Noto Sans JP', sans-serif; line-height: 1.6; color: var(--lp-text, #333); background-color: var(--lp-bg, #fff); }\n\n    .lp-hero { position: relative; min-height: 400px; display: flex; align-items: center; justify-content: center; }\n    .lp-hero-bg { position: absolute; inset: 0; background-size: cover; background-position: center; }\n    .lp-hero-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.4); }\n    .lp-hero-content { position: relative; z-index: 1; text-align: center; color: #fff; padding: 40px 20px; }\n    .lp-hero-company { font-size: 14px; margin-bottom: 10px; opacity: 0.9; }\n    .lp-hero-title { font-size: 28px; font-weight: 900; margin-bottom: 15px; }\n    .lp-hero-subtitle { font-size: 16px; opacity: 0.9; margin-bottom: 20px; }\n    .lp-hero-cta { margin-top: 20px; }\n    .lp-btn-apply-hero { display: inline-block; padding: 15px 40px; background: var(--lp-accent, #ff6b35); color: #fff; text-decoration: none; border-radius: 50px; font-weight: 700; font-size: 16px; }\n\n    .lp-section-inner { max-width: 800px; margin: 0 auto; padding: 40px 20px; }\n    .lp-section-title { font-size: 24px; font-weight: 700; text-align: center; margin-bottom: 30px; color: var(--lp-text, #333); }\n\n    .lp-points { background: color-mix(in srgb, var(--lp-bg, #f8f9fa) 95%, var(--lp-primary, #667eea) 5%); }\n    .lp-points-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }\n    .lp-point-card { background: var(--lp-bg, #fff); padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }\n    .lp-point-number { width: 36px; height: 36px; background: var(--lp-primary, #667eea); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 15px; }\n    .lp-point-title { font-size: 18px; font-weight: 700; margin-bottom: 10px; color: var(--lp-text, #333); }\n    .lp-point-desc { font-size: 14px; color: color-mix(in srgb, var(--lp-text, #666) 70%, transparent); }\n\n    .lp-jobs, .lp-details { background: var(--lp-bg, #fff); }\n    .lp-jobs-placeholder, .lp-details-placeholder { text-align: center; padding: 40px; background: color-mix(in srgb, var(--lp-bg, #f8f9fa) 95%, var(--lp-primary, #667eea) 5%); border-radius: 8px; color: color-mix(in srgb, var(--lp-text, #888) 60%, transparent); }\n\n    .lp-faq { background: color-mix(in srgb, var(--lp-bg, #f8f9fa) 95%, var(--lp-primary, #667eea) 5%); }\n    .lp-faq-list { display: flex; flex-direction: column; gap: 15px; }\n    .lp-faq-item { background: var(--lp-bg, #fff); border-radius: 8px; padding: 20px; }\n    .lp-faq-question { display: flex; gap: 12px; font-weight: 600; margin-bottom: 10px; color: var(--lp-text, #333); }\n    .lp-faq-answer { display: flex; gap: 12px; color: color-mix(in srgb, var(--lp-text, #666) 70%, transparent); }\n    .lp-faq-q, .lp-faq-a { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; flex-shrink: 0; }\n    .lp-faq-q { background: var(--lp-primary, #667eea); color: #fff; }\n    .lp-faq-a { background: color-mix(in srgb, var(--lp-primary, #e9ecef) 20%, var(--lp-bg, #fff) 80%); color: var(--lp-text, #333); }\n\n    .lp-apply { background: linear-gradient(135deg, var(--lp-primary, #667eea) 0%, var(--lp-accent, #764ba2) 100%); color: #fff; text-align: center; }\n    .lp-apply .lp-section-title { color: #fff; }\n    .lp-apply-text { margin-bottom: 25px; opacity: 0.9; }\n    .lp-btn-apply-main { padding: 18px 50px; background: var(--lp-accent, #ff6b35); color: #fff; border: none; border-radius: 50px; font-size: 18px; font-weight: 700; cursor: pointer; }\n\n    /* ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã€ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ãŒå„ªå…ˆï¼‰ */\n    .lp-pattern-modern .lp-point-number { background: var(--lp-primary, #10b981); }\n    .lp-pattern-modern .lp-btn-apply-hero, .lp-pattern-modern .lp-btn-apply-main { background: var(--lp-accent, #10b981); }\n    .lp-pattern-modern .lp-apply { background: linear-gradient(135deg, var(--lp-primary, #10b981) 0%, var(--lp-accent, #059669) 100%); }\n    .lp-pattern-modern .lp-faq-q { background: var(--lp-primary, #10b981); }\n\n    .lp-pattern-classic .lp-point-number { background: var(--lp-primary, #92400e); }\n    .lp-pattern-classic .lp-btn-apply-hero, .lp-pattern-classic .lp-btn-apply-main { background: var(--lp-accent, #b45309); }\n    .lp-pattern-classic .lp-apply { background: linear-gradient(135deg, var(--lp-primary, #92400e) 0%, var(--lp-accent, #78350f) 100%); }\n    .lp-pattern-classic .lp-faq-q { background: var(--lp-primary, #92400e); }\n\n    .lp-pattern-minimal .lp-point-number { background: var(--lp-primary, #374151); }\n    .lp-pattern-minimal .lp-btn-apply-hero, .lp-pattern-minimal .lp-btn-apply-main { background: var(--lp-accent, #111827); }\n    .lp-pattern-minimal .lp-apply { background: var(--lp-primary, #111827); }\n    .lp-pattern-minimal .lp-faq-q { background: var(--lp-primary, #374151); }\n\n    .lp-pattern-colorful .lp-point-number { background: var(--lp-primary, #ec4899); }\n    .lp-pattern-colorful .lp-btn-apply-hero, .lp-pattern-colorful .lp-btn-apply-main { background: linear-gradient(90deg, var(--lp-primary, #ec4899), var(--lp-accent, #8b5cf6)); }\n    .lp-pattern-colorful .lp-apply { background: linear-gradient(135deg, var(--lp-primary, #ec4899) 0%, var(--lp-accent, #8b5cf6) 100%); }\n    .lp-pattern-colorful .lp-faq-q { background: var(--lp-primary, #ec4899); }\n  \n  </style>\n</head>\n<body class="lp-body ${o}" style="${u}" data-layout="${a}">\n  <div id="lp-content">\n    ${d}\n  </div>\n</body>\n</html>\n  `}((null==a?void 0:a.find(e=>e.companyDomain===o))||{company:o},function(){var e,t,n,o,a,i,l,s,r;const c=Bt(),d=document.querySelector(".lp-admin-layout-option.selected"),u=(null==(e=null==d?void 0:d.dataset)?void 0:e.layout)||"default",p=$t(),m={designPattern:(null==(t=document.querySelector('input[name="design-pattern"]:checked'))?void 0:t.value)||"standard",layoutStyle:u,heroTitle:(null==(n=document.getElementById("lp-hero-title"))?void 0:n.value)||"",heroSubtitle:(null==(o=document.getElementById("lp-hero-subtitle"))?void 0:o.value)||"",heroImage:(null==(a=document.getElementById("lp-hero-image"))?void 0:a.value)||"",ctaText:(null==(i=document.getElementById("lp-cta-text"))?void 0:i.value)||"ä»Šã™ãå¿œå‹Ÿã™ã‚‹",faq:(null==(l=document.getElementById("lp-faq"))?void 0:l.value)||"",sectionOrder:Ft().join(","),sectionVisibility:JSON.stringify(Vt()),customPrimary:p.primary,customAccent:p.accent,customBg:p.bg,customText:p.text};for(let y=0;y<6;y++)m[`pointTitle${y+1}`]=(null==(s=c[y])?void 0:s.title)||"",m[`pointDesc${y+1}`]=(null==(r=c[y])?void 0:r.desc)||"";return m}());t.srcdoc=i}function Yt(){const e=document.getElementById("lp-section-order");if(!e)return;let t=null,n=null;e.querySelectorAll(".section-order-item").forEach(o=>{o.setAttribute("draggable","true"),o.addEventListener("dragstart",e=>{t=o,o.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",""),setTimeout(()=>{o.style.opacity="0.4"},0)}),o.addEventListener("dragend",()=>{o.classList.remove("dragging"),o.style.opacity="",t=null,e.querySelectorAll(".section-order-item").forEach(e=>{e.classList.remove("drag-over")}),Gt(),o.style.animation="none",o.offsetHeight,o.style.animation="sortableDropped 0.3s ease"}),o.addEventListener("dragover",n=>{if(n.preventDefault(),n.dataTransfer.dropEffect="move",!t||t===o)return;const a=Qt(e,n.clientY);e.querySelectorAll(".section-order-item").forEach(e=>{e.classList.remove("drag-over")}),a&&a!==t&&a.classList.add("drag-over"),null==a?e.appendChild(t):e.insertBefore(t,a)}),o.addEventListener("dragleave",()=>{o.classList.remove("drag-over")}),o.addEventListener("touchstart",e=>{e.touches[0].clientY,n=o,o.classList.add("dragging")},{passive:!0}),o.addEventListener("touchmove",t=>{if(!n)return;const o=t.touches[0].clientY,a=Qt(e,o);null==a?e.appendChild(n):a!==n&&e.insertBefore(n,a)},{passive:!0}),o.addEventListener("touchend",()=>{n&&(n.classList.remove("dragging"),Gt()),n=null})})}function Qt(e,t){return[...e.querySelectorAll(".section-order-item:not(.dragging)")].reduce((e,n)=>{const o=n.getBoundingClientRect(),a=t-o.top-o.height/2;return a<0&&a>e.offset?{offset:a,element:n}:e},{offset:Number.NEGATIVE_INFINITY}).element}function Xt(e){if(!(!0===e.visible||"true"===e.visible||"TRUE"===e.visible||!0===e.isVisible||"true"===e.isVisible))return"draft";if(e.publishEndDate){const t=new Date(e.publishEndDate),n=new Date;if(n.setHours(0,0,0,0),t<n)return"expired"}return"active"}function Wt(e){return{active:"å…¬é–‹ä¸­",draft:"éå…¬é–‹",expired:"æ²è¼‰çµ‚äº†"}[e]||e}function Zt(e){return{active:"status-active",draft:"status-draft",expired:"status-expired"}[e]||""}function en(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function tn(e){if(!e)return"-";const t=new Date(e);return isNaN(t.getTime())?e:`${String(t.getFullYear()).slice(2)}/${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")}`}function nn(e,t="edit-job"){const n=(e,n)=>{const o=document.getElementById(`${t}-${e}`);o&&(o.value=n||"")};n("title",e.title),n("location",e.location),n("salary",e.monthlySalary),n("bonus",e.totalBonus),n("order",e.order),n("type",e.jobType),n("features",e.features),n("badges",e.badges),n("description",e.jobDescription),n("requirements",e.requirements),n("benefits",e.benefits),n("hours",e.workingHours),n("holidays",e.holidays),n("start-date",en(e.publishStartDate)),n("end-date",en(e.publishEndDate));const o=document.getElementById(`${t}-visible`);o&&(o.checked="true"===e.visible||"TRUE"===e.visible||!0===e.visible)}function on(e="edit-job"){["title","location","salary","bonus","order","type","features","badges","description","requirements","benefits","hours","holidays","start-date","end-date"].forEach(t=>{const n=document.getElementById(`${e}-${t}`);n&&(n.value="")});const t=document.getElementById(`${e}-visible`);t&&(t.checked=!0)}const an="ãƒªã‚¯ã‚¨ã‚³æ±‚äººãƒŠãƒ“",ln="https://rikueko.com",sn="ãƒªã‚¯ã‚¨ã‚³æ±‚äººãƒŠãƒ“",rn="https://rikueko.com";function cn(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function dn(e){return e?e.replace(/<[^>]*>/g,"").trim():""}function un(e){if(!e)return{prefecture:"",city:"",country:"JP"};const t=e.match(/^(.+?[éƒ½é“åºœçœŒ])/),n=t?t[1]:"",o=e.match(/[éƒ½é“åºœçœŒ](.+?[å¸‚åŒºç”ºæ‘])/);return{prefecture:n,city:o?o[1]:e.replace(n,"").trim(),country:"JP"}}function pn(e){if(!e)return{min:null,max:null,currency:"JPY",period:"MONTH"};const t=String(e);let n=0;const o=t.match(/(\d+(?:\.\d+)?)\s*ä¸‡/);if(o)n=1e4*parseFloat(o[1]);else{const e=t.match(/(\d{1,3}(?:,\d{3})*|\d+)/);e&&(n=parseInt(e[1].replace(/,/g,"")))}return{min:n,max:n,currency:"JPY",period:"MONTH"}}function mn(e){if(!e)return"FULL_TIME";return{"æ­£ç¤¾å“¡":"FULL_TIME","ãƒ•ãƒ«ã‚¿ã‚¤ãƒ ":"FULL_TIME","ãƒ‘ãƒ¼ãƒˆ":"PART_TIME","ãƒ‘ãƒ¼ãƒˆã‚¿ã‚¤ãƒ ":"PART_TIME","ã‚¢ãƒ«ãƒã‚¤ãƒˆ":"PART_TIME","å¥‘ç´„ç¤¾å“¡":"CONTRACTOR","å¥‘ç´„":"CONTRACTOR","æ´¾é£":"TEMPORARY","æ´¾é£ç¤¾å“¡":"TEMPORARY","ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³":"INTERN","æœŸé–“å·¥":"CONTRACTOR","æœŸé–“å¾“æ¥­å“¡":"CONTRACTOR"}[e]||"FULL_TIME"}function yn(e){return e.companyDomain&&e.id?`${ln}/job-detail.html?company=${encodeURIComponent(e.companyDomain)}&job=${encodeURIComponent(e.id)}`:e.companyDomain?`${ln}/lp.html?company=${encodeURIComponent(e.companyDomain)}`:ln}function vn(e){const t=(new Date).toISOString();let n=`<?xml version="1.0" encoding="UTF-8"?>\n<source>\n  <publisher>${cn(sn)}</publisher>\n  <publisherurl>${cn(rn)}</publisherurl>\n  <lastBuildDate>${t}</lastBuildDate>\n`;return e.forEach(e=>{if(!e.title)return;const t=un(e.location||e.companyAddress);pn(e.monthlySalary);const o=yn(e),a=dn(e.jobDescription||e.description||"");n+=`\n  <job>\n    <title><![CDATA[${e.title}]]></title>\n    <date>${e.publishStartDate||(new Date).toISOString().split("T")[0]}</date>\n    <referencenumber>${cn(e.id||"")}</referencenumber>\n    <url><![CDATA[${o}]]></url>\n    <company><![CDATA[${e.company||""}]]></company>\n    <city><![CDATA[${t.city}]]></city>\n    <state><![CDATA[${t.prefecture}]]></state>\n    <country>${t.country}</country>\n    <postalcode></postalcode>\n    <description><![CDATA[${a}]]></description>\n    <salary><![CDATA[${e.monthlySalary||""}]]></salary>\n    <jobtype>${mn(e.employmentType)}</jobtype>\n    <category><![CDATA[${e.jobType||"è£½é€ ãƒ»å·¥å ´"}]]></category>\n    <experience><![CDATA[${e.requirements||"æœªçµŒé¨“æ­“è¿"}]]></experience>\n  </job>`}),n+="\n</source>",n}function gn(e){const t=e.map(e=>{if(!e.title)return null;const t=un(e.location||e.companyAddress),n=pn(e.monthlySalary),o=yn(e),a=dn(e.jobDescription||e.description||e.title),i={"@context":"https://schema.org/","@type":"JobPosting",title:e.title,description:a,identifier:{"@type":"PropertyValue",name:e.company||an,value:e.id||""},datePosted:e.publishStartDate||(new Date).toISOString().split("T")[0],hiringOrganization:{"@type":"Organization",name:e.company||"",sameAs:o},jobLocation:{"@type":"Place",address:{"@type":"PostalAddress",addressLocality:t.city,addressRegion:t.prefecture,addressCountry:t.country}},employmentType:mn(e.employmentType)};return n.min&&(i.baseSalary={"@type":"MonetaryAmount",currency:n.currency,value:{"@type":"QuantitativeValue",value:n.min,unitText:n.period}}),e.publishEndDate&&(i.validThrough=e.publishEndDate),i}).filter(Boolean);return JSON.stringify(t,null,2)}function fn(e){const t=(new Date).toISOString();let n=`<?xml version="1.0" encoding="UTF-8"?>\n<jobs xmlns="http://www.jobbox.com/schema/jobs">\n  <publisher>${cn(sn)}</publisher>\n  <publisherUrl>${cn(rn)}</publisherUrl>\n  <lastUpdate>${t}</lastUpdate>\n`;return e.forEach(e=>{if(!e.title)return;const t=un(e.location||e.companyAddress),o=pn(e.monthlySalary),a=yn(e),i=dn(e.jobDescription||e.description||"");n+=`\n  <job>\n    <id>${cn(e.id||"")}</id>\n    <title><![CDATA[${e.title}]]></title>\n    <company><![CDATA[${e.company||""}]]></company>\n    <url><![CDATA[${a}]]></url>\n    <location>\n      <prefecture>${cn(t.prefecture)}</prefecture>\n      <city>${cn(t.city)}</city>\n      <country>${t.country}</country>\n    </location>\n    <description><![CDATA[${i}]]></description>\n    <salary>\n      <type>monthly</type>\n      <min>${o.min||""}</min>\n      <max>${o.max||""}</max>\n      <currency>${o.currency}</currency>\n      <text><![CDATA[${e.monthlySalary||""}]]></text>\n    </salary>\n    <employmentType>${cn(e.employmentType||"æ­£ç¤¾å“¡")}</employmentType>\n    <requirements><![CDATA[${e.requirements||""}]]></requirements>\n    <benefits><![CDATA[${e.benefits||""}]]></benefits>\n    <workingHours><![CDATA[${e.workingHours||""}]]></workingHours>\n    <holidays><![CDATA[${e.holidays||""}]]></holidays>\n    <datePosted>${e.publishStartDate||(new Date).toISOString().split("T")[0]}</datePosted>\n    <validThrough>${e.publishEndDate||""}</validThrough>\n  </job>`}),n+="\n</jobs>",n}function bn(e){const t=e=>{if(null==e)return"";const t=String(e).replace(/"/g,'""');return t.includes(",")||t.includes('"')||t.includes("\n")?`"${t}"`:t};let n=["id","ã‚¿ã‚¤ãƒˆãƒ«","ä¼šç¤¾å","å‹¤å‹™åœ°","éƒ½é“åºœçœŒ","å¸‚åŒºç”ºæ‘","æœˆå","ç‰¹å…¸ç·é¡","é›‡ç”¨å½¢æ…‹","ä»•äº‹å†…å®¹","å¿œå‹Ÿè³‡æ ¼","å¾…é‡","å‹¤å‹™æ™‚é–“","ä¼‘æ—¥","æ²è¼‰é–‹å§‹æ—¥","æ²è¼‰çµ‚äº†æ—¥","URL"].join(",")+"\n";return e.forEach(e=>{const o=un(e.location||e.companyAddress),a=yn(e),i=[e.id||"",e.title||"",e.company||"",e.location||e.companyAddress||"",o.prefecture,o.city,e.monthlySalary||"",e.totalBonus||"",e.employmentType||"",dn(e.jobDescription||""),e.requirements||"",e.benefits||"",e.workingHours||"",e.holidays||"",e.publishStartDate||"",e.publishEndDate||"",a];n+=i.map(t).join(",")+"\n"}),n}async function hn(){try{const e=await l();if(!e)throw new Error("ä¼šç¤¾ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");const t=[];for(const n of e){if(!s(n))continue;const e=await r(n.jobsSheet);e&&e.forEach(e=>{"false"!==e.visible&&"FALSE"!==e.visible&&c(e)&&(e.company=n.company,e.companyDomain=n.companyDomain,e.companyAddress=e.location||n.companyAddress||"",t.push(e))})}return console.log(`[JobFeedGenerator] ${t.length}ä»¶ã®æ±‚äººã‚’å–å¾—ã—ã¾ã—ãŸ`),{jobs:t,indeedXml:vn(t),googleJsonLd:gn(t),jobBoxXml:fn(t),csv:bn(t)}}catch(e){throw console.error("[JobFeedGenerator] ãƒ•ã‚£ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼:",e),e}}function En(e,t,n){const o=new Blob([e],{type:n}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}async function $n(){En((await hn()).indeedXml,"indeed-feed.xml","application/xml")}async function In(){En((await hn()).googleJsonLd,"google-jobs.json","application/json")}async function wn(){En((await hn()).jobBoxXml,"jobbox-feed.xml","application/xml")}async function xn(){En((await hn()).csv,"jobs-feed.csv","text/csv;charset=utf-8")}let Sn=null,qn=null,Ln=null,Tn=[],Bn=null,kn=!1,An=null,jn={},Dn={search:"",status:"",area:""},Cn=[],Pn=!1,Un=!1,Mn=!1,Rn=null;function Nn(e,t,n){Sn=e,qn=t,Ln=n}function On(e){Ln=e}function Hn(e){Tn=e}function _n(e){Bn=e}function Fn(e){kn=e}function Vn(e){}function Kn(e){An=e}function Jn(e){}function zn(e){jn=e}function Gn(){Dn={search:"",status:"",area:""}}function Yn(e){Cn=e}function Qn(e){}function Xn(e){Pn=e}function Wn(e){Un=e}function Zn(){return Mn}function eo(){Mn=!0}function to(){Mn=!1}function no(){return Rn&&Rn.abort(),Rn=new AbortController,Rn}function oo(){Rn=null}const ao={apiKey:"AIzaSyB3eXZoFkXOwnHxPvaHiWO7csmZK4KGqAQ",authDomain:"generated-area-484613-e3-90bd4.firebaseapp.com",projectId:"generated-area-484613-e3-90bd4"};let io=null,lo=[],so=[],ro=1;let co=null,uo=[],po="";function mo(e){return document.getElementById(po+e)}const yo={new:"æ–°è¦",contacted:"é€£çµ¡æ¸ˆã¿",interviewing:"é¢æ¥èª¿æ•´ä¸­",interviewed:"é¢æ¥æ¸ˆã¿",hired:"æ¡ç”¨",rejected:"ä¸æ¡ç”¨",withdrawn:"è¾é€€"},vo={apply:"å¿œå‹Ÿ",line:"LINEç›¸è«‡",consult:"ãŠå•ã„åˆã‚ã›"},go={immediate:"ã™ãã«ã§ã‚‚","within-week":"1é€±é–“ä»¥å†…","within-month":"1ãƒ¶æœˆä»¥å†…","within-2months":"2ãƒ¶æœˆä»¥å†…",undecided:"æœªå®šãƒ»ç›¸è«‡ã—ãŸã„"},fo={first_contact:{subject:"åˆå›é€£çµ¡",body:"{applicantName}æ§˜\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã«ã”å¿œå‹Ÿã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\n\nã”å¿œå‹Ÿå†…å®¹ã‚’ç¢ºèªã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚\nã¤ãã¾ã—ã¦ã¯ã€ä¸€åº¦ãŠé›»è©±ã«ã¦ãŠè©±ã‚’ã•ã›ã¦ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚\n\nã”éƒ½åˆã®è‰¯ã„æ—¥æ™‚ã‚’ã„ãã¤ã‹ãŠçŸ¥ã‚‰ã›ã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\nï¼ˆå¹³æ—¥10:00ã€œ18:00ã®é–“ã§ãŠé¡˜ã„ã§ãã¾ã™ã¨å¹¸ã„ã§ã™ï¼‰\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},schedule_interview:{subject:"é¢æ¥æ—¥ç¨‹èª¿æ•´",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¢æ¥ã®æ—¥ç¨‹èª¿æ•´ã«ã¤ã„ã¦ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚\n\nä¸‹è¨˜ã®æ—¥ç¨‹ã§ã”éƒ½åˆã®è‰¯ã„æ—¥æ™‚ã¯ã”ã–ã„ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\n\nã€å€™è£œæ—¥ã€‘\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\n\nä¸Šè¨˜ä»¥å¤–ã§ã‚‚ã”èª¿æ•´å¯èƒ½ã§ã™ã®ã§ã€ã”å¸Œæœ›ã®æ—¥æ™‚ãŒã”ã–ã„ã¾ã—ãŸã‚‰ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚\n\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},interview_reminder:{subject:"é¢æ¥ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¢æ¥æ—¥ç¨‹ã®ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’ãŠé€ã‚Šã„ãŸã—ã¾ã™ã€‚\n\nã€é¢æ¥æ—¥æ™‚ã€‘â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nã€å ´æ‰€ã€‘ã€’â—¯â—¯â—¯-â—¯â—¯â—¯â—¯ â—¯â—¯çœŒâ—¯â—¯å¸‚â—¯â—¯\nã€æŒã¡ç‰©ã€‘å±¥æ­´æ›¸ã€ç­†è¨˜ç”¨å…·\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nå½“æ—¥ãŠä¼šã„ã§ãã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚"},document_request:{subject:"æ›¸é¡æå‡ºä¾é ¼",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¸è€ƒã‚’é€²ã‚ã‚‹ã«ã‚ãŸã‚Šã€ä¸‹è¨˜ã®æ›¸é¡ã‚’ã”æå‡ºã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\n\nã€æå‡ºæ›¸é¡ã€‘\nãƒ»å±¥æ­´æ›¸ï¼ˆå†™çœŸè²¼ä»˜ï¼‰\nãƒ»è·å‹™çµŒæ­´æ›¸\n\nã€æå‡ºæ–¹æ³•ã€‘\nãƒã‚¤ãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã«ã¦ã”é€ä»˜ãã ã•ã„ã€‚\n\nã€æå‡ºæœŸé™ã€‘\nâ—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰ã¾ã§\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},result_pending:{subject:"é¸è€ƒçµæœå¾…ã¡",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nå…ˆæ—¥ã¯é¢æ¥ã«ãŠè¶Šã—ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\nç¾åœ¨ã€ç¤¾å†…ã«ã¦é¸è€ƒã‚’é€²ã‚ã¦ãŠã‚Šã¾ã™ã€‚\nçµæœã«ã¤ãã¾ã—ã¦ã¯ã€â—¯æœˆâ—¯æ—¥é ƒã¾ã§ã«ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãäºˆå®šã§ã™ã€‚\n\nä»Šã—ã°ã‚‰ããŠå¾…ã¡ã„ãŸã ã‘ã¾ã™ã‚ˆã†ãŠé¡˜ã„ç”³ã—ä¸Šã’ã¾ã™ã€‚"},offer:{subject:"å†…å®šé€šçŸ¥",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã®é¸è€ƒã«ã”å‚åŠ ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\næ…é‡ã«æ¤œè¨ã•ã›ã¦ã„ãŸã ã„ãŸçµæœã€{applicantName}æ§˜ã‚’æ¡ç”¨ã•ã›ã¦ã„ãŸã ãã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚\n\nã¤ãã¾ã—ã¦ã¯ã€å…¥ç¤¾ã«é–¢ã™ã‚‹è©³ç´°ã«ã¤ã„ã¦ã”èª¬æ˜ã•ã›ã¦ã„ãŸã ããŸãã€\nãŠé›»è©±ã«ã¦ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\n{applicantName}æ§˜ã¨ä¸€ç·’ã«åƒã‘ã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚"},rejection:{subject:"ä¸æ¡ç”¨é€šçŸ¥",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã«ã”å¿œå‹Ÿã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\næ…é‡ã«æ¤œè¨ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸãŒã€èª ã«æ®‹å¿µãªãŒã‚‰ä»Šå›ã¯ã”æœŸå¾…ã«æ²¿ãˆãªã„çµæœã¨ãªã‚Šã¾ã—ãŸã€‚\n\nã”å¿œå‹Ÿã„ãŸã ã„ãŸã“ã¨ã«å¿ƒã‚ˆã‚Šæ„Ÿè¬ç”³ã—ä¸Šã’ã¾ã™ã¨ã¨ã‚‚ã«ã€\n{applicantName}æ§˜ã®ä»Šå¾Œã®ã”æ´»èºã‚’ãŠç¥ˆã‚Šç”³ã—ä¸Šã’ã¾ã™ã€‚"}};function bo(){return firebase.apps.length||firebase.initializeApp(ao),firebase.firestore()}function ho(){const t=mo("detail-assignee");if(t){const n=t.value;t.innerHTML='<option value="">æœªå‰²å½“</option>'+uo.map(t=>`<option value="${e(t)}">${e(t)}</option>`).join(""),t.value=n}}async function Eo(){var e;const t=mo("new-assignee-name"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(n)if(uo.includes(n))alert("ã“ã®æ‹…å½“è€…ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™");else try{const e=bo().collection("settings").doc(io||"global");uo.push(n),await e.set({assignees:uo,updatedAt:firebase.firestore.FieldValue.serverTimestamp()},{merge:!0}),ho(),Io();const t=mo("detail-assignee");t&&(t.value=n)}catch(o){console.error("Failed to add assignee:",o),alert("æ‹…å½“è€…ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: "+o.message)}else alert("æ‹…å½“è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")}function $o(){const e=mo("assignee-modal"),t=mo("new-assignee-name");e&&(e.style.display="flex"),t&&(t.value="",t.focus())}function Io(){const e=mo("assignee-modal");e&&(e.style.display="none")}async function wo(){const e=mo("applicants-list");e&&(e.innerHTML='<div class="loading-message">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>');try{let e=bo().collection("applications");io&&(e=e.where("companyDomain","==",io)),e=e.orderBy("createdAt","desc");const t=await e.get();lo=[],t.forEach(e=>{lo.push({id:e.id,...e.data()})}),xo(),So()}catch(t){console.error("Failed to load applicants:",t),e&&(e.innerHTML='<div class="empty-message">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>')}}function xo(){var e,t,n,o;const a=(null==(e=mo("filter-status"))?void 0:e.value)||"",i=(null==(t=mo("filter-type"))?void 0:t.value)||"",l=(null==(o=null==(n=mo("filter-search"))?void 0:n.value)?void 0:o.toLowerCase())||"";so=lo.filter(e=>{var t;if(a&&(e.status||"new")!==a)return!1;if(i&&e.type!==i)return!1;if(l){const n=(e.jobTitle||"").toLowerCase(),o=(e.applicantName||(null==(t=e.applicant)?void 0:t.name)||"").toLowerCase();if(!n.includes(l)&&!o.includes(l))return!1}return!0}),ro=1,qo(),Lo()}function So(){const e=lo.length,t=lo.filter(e=>!e.status||"new"===e.status).length,n=lo.filter(e=>["contacted","interviewing","interviewed"].includes(e.status)).length,o=lo.filter(e=>["hired","rejected","withdrawn"].includes(e.status)).length,a=mo("stat-total"),i=mo("stat-new"),l=mo("stat-progress"),s=mo("stat-complete");a&&(a.textContent=e),i&&(i.textContent=t),l&&(l.textContent=n),s&&(s.textContent=o)}function qo(){const t=mo("applicants-list");if(!t)return;if(0===so.length)return void(t.innerHTML='<div class="empty-message">å¿œå‹Ÿãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>');const n=20*(ro-1),o=n+20,a=so.slice(n,o);t.innerHTML=a.map(t=>{var n,o;const a=Po((null==(n=t.createdAt)?void 0:n.toDate)?t.createdAt.toDate():new Date(t.timestamp||t.createdAt)),i=t.status||"new",l=vo[t.type]||t.type||"-",s=yo[i]||i,r=t.applicantName||(null==(o=t.applicant)?void 0:o.name)||"-",c=co===t.id;let d="type-apply";return"line"===t.type&&(d="type-line"),"consult"===t.type&&(d="type-consult"),`\n      <div class="applicant-card ${c?"selected":""}" data-id="${e(t.id)}">\n        <div class="applicant-card-main">\n          <div class="applicant-card-header">\n            <span class="applicant-card-name">${e(r)}</span>\n            <span class="applicant-card-type ${d}">${e(l)}</span>\n          </div>\n          <div class="applicant-card-job">${e(t.jobTitle||"-")}</div>\n          <div class="applicant-card-meta">\n            <span>${e(a)}</span>\n            ${t.assignee?`<span>æ‹…å½“: ${e(t.assignee)}</span>`:""}\n          </div>\n        </div>\n        <div class="applicant-card-status">\n          <span class="status-badge status-${e(i)}">${e(s)}</span>\n        </div>\n      </div>\n    `}).join(""),t.querySelectorAll(".applicant-card").forEach(e=>{e.addEventListener("click",()=>{!function(e){var t,n,o,a,i,l,s;const r=lo.find(t=>t.id===e);if(!r)return;co=e,document.querySelectorAll(".applicant-card").forEach(t=>{t.classList.toggle("selected",t.dataset.id===e)});const c=mo("detail-empty"),d=mo("detail-content");c&&(c.style.display="none");d&&(d.style.display="flex");const u=r.applicantName||(null==(t=r.applicant)?void 0:t.name)||"-",p=r.applicantPhone||(null==(n=r.applicant)?void 0:n.phone)||"-",m=r.applicantEmail||(null==(o=r.applicant)?void 0:o.email)||"-",y=(null==(a=r.applicant)?void 0:a.age)||"-",v=(null==(i=r.applicant)?void 0:i.address)||"-",g=(null==(l=r.applicant)?void 0:l.startDate)||"-";mo("detail-name").textContent=u,mo("detail-job-title").textContent=r.jobTitle||"-",mo("detail-phone").textContent=p,mo("detail-email").textContent=m,mo("detail-age").textContent=y,mo("detail-address").textContent=v,mo("detail-start-date").textContent=go[g]||g;const f=(null==(s=r.createdAt)?void 0:s.toDate)?r.createdAt.toDate():new Date(r.timestamp||r.createdAt);mo("detail-datetime").textContent=Po(f,!0),mo("detail-type").textContent=vo[r.type]||r.type||"-",mo("detail-source").textContent=Uo(r.source);const b=r.status||"new";document.querySelectorAll(".status-btn").forEach(e=>{e.classList.toggle("active",e.dataset.status===b)});const h=mo("detail-assignee");h&&(h.value=r.assignee||"");const E=mo("detail-notes");E&&(E.value=r.notes||"");Ao(r.history||[]),Bo(e)}(e.dataset.id)})})}function Lo(){const e=mo("pagination");if(!e)return;const t=Math.ceil(so.length/20);if(t<=1)return void(e.innerHTML="");let n="";n+=`<button class="page-btn" ${1===ro?"disabled":""} data-page="${ro-1}">å‰ã¸</button>`;for(let o=1;o<=t;o++)1===o||o===t||o>=ro-2&&o<=ro+2?n+=`<button class="page-btn ${o===ro?"active":""}" data-page="${o}">${o}</button>`:o!==ro-3&&o!==ro+3||(n+='<span class="page-ellipsis">...</span>');n+=`<button class="page-btn" ${ro===t?"disabled":""} data-page="${ro+1}">æ¬¡ã¸</button>`,e.innerHTML=n,e.querySelectorAll(".page-btn").forEach(e=>{e.addEventListener("click",()=>{e.disabled||(ro=parseInt(e.dataset.page),qo(),Lo())})})}function To(){co=null,document.querySelectorAll(".applicant-card").forEach(e=>{e.classList.remove("selected")});const e=mo("detail-empty"),t=mo("detail-content");e&&(e.style.display="flex"),t&&(t.style.display="none")}async function Bo(t){const n=mo("messages-container");if(n){n.innerHTML='<p class="no-data">èª­ã¿è¾¼ã¿ä¸­...</p>';try{const n=bo(),o=await n.collection("messages").where("applicationId","==",t).orderBy("createdAt","asc").get(),a=[];o.forEach(e=>{a.push({id:e.id,...e.data()})}),function(t){const n=mo("messages-container");if(!n)return;if(!t||0===t.length)return void(n.innerHTML='<p class="no-data">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚ã‚Šã¾ã›ã‚“</p>');n.innerHTML=t.map(t=>{var n;const o=(null==(n=t.createdAt)?void 0:n.toDate)?t.createdAt.toDate():new Date(t.createdAt),a="company"===t.from;return`\n      <div class="message-item ${a?"message-company":"message-applicant"}">\n        <div class="message-header">\n          <span class="message-sender">${e(a?"ä¼šç¤¾":"å¿œå‹Ÿè€…")}</span>\n          <span class="message-date">${Po(o,!0)}</span>\n        </div>\n        <div class="message-content">${e(t.content).replace(/\n/g,"<br>")}</div>\n      </div>\n    `}).join(""),n.scrollTop=n.scrollHeight}(a)}catch(o){console.error("Failed to load messages:",o),n.innerHTML='<p class="no-data">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p>'}}}async function ko(){var e;if(!co)return;const t=mo("new-message-text"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(!n)return void alert("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");const o=mo("btn-send-message");o&&(o.disabled=!0,o.textContent="é€ä¿¡ä¸­...");try{const e=bo(),o=lo.find(e=>e.id===co);await e.collection("messages").add({applicationId:co,companyDomain:(null==o?void 0:o.companyDomain)||io,from:"company",content:n,read:!1,createdAt:firebase.firestore.FieldValue.serverTimestamp()}),t.value="",await Bo(co)}catch(a){console.error("Failed to send message:",a),alert("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}finally{o&&(o.disabled=!1,o.textContent="é€ä¿¡")}}function Ao(t){const n=mo("detail-history");n&&(t&&0!==t.length?n.innerHTML=t.map(t=>{var n;return`\n      <div class="history-item">\n        <div class="history-date">${Po((null==(n=t.date)?void 0:n.toDate)?t.date.toDate():new Date(t.date),!0)}</div>\n        <div class="history-text">${e(t.text)}</div>\n      </div>\n    `}).join(""):n.innerHTML='<p class="no-data">å¯¾å¿œå±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“</p>')}async function jo(){var e,t;if(!co)return;const n=(null==(e=mo("detail-notes"))?void 0:e.value)||"",o=(null==(t=mo("detail-assignee"))?void 0:t.value)||"",a=mo("btn-save-notes");a&&(a.disabled=!0,a.textContent="ä¿å­˜ä¸­...");try{const e=bo();await e.collection("applications").doc(co).update({notes:n,assignee:o,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const t=lo.findIndex(e=>e.id===co);-1!==t&&(lo[t].notes=n,lo[t].assignee=o),qo()}catch(i){console.error("Failed to save notes:",i),alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{a&&(a.disabled=!1,a.textContent="ä¿å­˜")}}async function Do(){var e;if(!co)return;const t=mo("new-history-text"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(n)try{const e=bo(),o=lo.find(e=>e.id===co),a=(null==o?void 0:o.history)||[];a.push({date:new Date,text:n}),await e.collection("applications").doc(co).update({history:a,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const i=lo.findIndex(e=>e.id===co);-1!==i&&(lo[i].history=a),Ao(a),t.value=""}catch(o){console.error("Failed to add history:",o),alert("å±¥æ­´ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: "+o.message)}else alert("å¯¾å¿œå†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")}function Co(){if(0===so.length)return void alert("ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");const e=so.map(e=>{var t,n,o,a,i,l,s;const r=(null==(t=e.createdAt)?void 0:t.toDate)?e.createdAt.toDate():new Date(e.timestamp||e.createdAt),c=e.applicantName||(null==(n=e.applicant)?void 0:n.name)||"",d=e.applicantPhone||(null==(o=e.applicant)?void 0:o.phone)||"",u=e.applicantEmail||(null==(a=e.applicant)?void 0:a.email)||"",p=(null==(i=e.applicant)?void 0:i.age)||"",m=(null==(l=e.applicant)?void 0:l.address)||"",y=(null==(s=e.applicant)?void 0:s.startDate)||"";return[Po(r,!0),vo[e.type]||e.type||"",c,d,u,p,m,go[y]||y,e.jobTitle||"",Uo(e.source),yo[e.status||"new"],e.assignee||"",(e.notes||"").replace(/"/g,'""')]}),t=[["æ—¥æ™‚","ç¨®åˆ¥","å¿œå‹Ÿè€…å","é›»è©±ç•ªå·","ãƒ¡ãƒ¼ãƒ«","å¹´é½¢","ç¾ä½æ‰€","å¸Œæœ›å‹¤å‹™é–‹å§‹æ—¥","æ±‚äººã‚¿ã‚¤ãƒˆãƒ«","æµå…¥å…ƒ","ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹","æ‹…å½“è€…","ãƒ¡ãƒ¢"].join(","),...e.map(e=>e.map(e=>`"${e}"`).join(","))].join("\n"),n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8"}),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download=`applicants-${io||"all"}-${function(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${t}${n}${o}`}(new Date)}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}function Po(e,t=!1){if(!e||isNaN(e.getTime()))return"-";const n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");if(!t)return`${n}/${o}/${a}`;return`${n}/${o}/${a} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}function Uo(e){if(!e||"direct"===e)return"ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹";try{const t=new URL(e).hostname;return t.includes("google")?"Googleæ¤œç´¢":t.includes("yahoo")?"Yahoo!æ¤œç´¢":t.includes("tiktok")?"TikTokåºƒå‘Š":t.includes("instagram")||t.includes("fb")||t.includes("facebook")?"Metaåºƒå‘Š":t.includes("twitter")||t.includes("x.com")?"X(Twitter)":t.includes("line")?"LINE":t}catch{return e||"ä¸æ˜"}}function Mo(){var e,t,n,o,a,i,l,s,r,c,d,u,p,m,y,v,g,f,b;let h;null==(e=mo("btn-refresh"))||e.addEventListener("click",wo),null==(t=mo("btn-refresh-applicants"))||t.addEventListener("click",wo),null==(n=mo("btn-export-csv"))||n.addEventListener("click",Co),null==(o=mo("filter-status"))||o.addEventListener("change",xo),null==(a=mo("filter-type"))||a.addEventListener("change",xo),null==(i=mo("filter-search"))||i.addEventListener("input",()=>{clearTimeout(h),h=setTimeout(xo,300)}),null==(l=mo("btn-close-detail"))||l.addEventListener("click",To),document.querySelectorAll(".status-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.status;t&&async function(e){if(co)try{const t=bo();await t.collection("applications").doc(co).update({status:e,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const n=lo.findIndex(e=>e.id===co);-1!==n&&(lo[n].status=e),document.querySelectorAll(".status-btn").forEach(t=>{t.classList.toggle("active",t.dataset.status===e)}),xo(),So()}catch(t){console.error("Failed to update status:",t),alert("ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ")}}(t)})}),null==(s=mo("btn-save-notes"))||s.addEventListener("click",jo),null==(r=mo("btn-add-history"))||r.addEventListener("click",Do),null==(c=mo("new-history-text"))||c.addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),Do())}),null==(d=mo("btn-send-message"))||d.addEventListener("click",ko),null==(u=mo("new-message-text"))||u.addEventListener("keydown",e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),ko())}),null==(p=mo("message-template-select"))||p.addEventListener("change",e=>{!function(e){var t;if(!e)return;const n=fo[e];if(!n)return;const o=lo.find(e=>e.id===co);if(!o)return;const a=o.applicantName||(null==(t=o.applicant)?void 0:t.name)||"ãŠå®¢æ§˜",i=o.jobTitle||"æ±‚äºº";let l=n.body.replace(/{applicantName}/g,a).replace(/{jobTitle}/g,i);const s=mo("new-message-text");s&&(s.value=l,s.focus());const r=mo("message-template-select");r&&(r.value="")}(e.target.value)}),null==(m=mo("btn-add-assignee"))||m.addEventListener("click",$o),null==(y=mo("assignee-modal-close"))||y.addEventListener("click",Io),null==(v=mo("assignee-modal-cancel"))||v.addEventListener("click",Io),null==(g=mo("assignee-modal-save"))||g.addEventListener("click",Eo),null==(f=mo("assignee-modal"))||f.addEventListener("click",e=>{e.target.classList.contains("modal-overlay")&&Io()}),null==(b=mo("new-assignee-name"))||b.addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),Eo())})}async function Ro(e,t,n=""){io=e,po=n,Mo(),await async function(){try{const e=bo().collection("settings").doc(io||"global"),t=await e.get();uo=t.exists&&t.data().assignees?t.data().assignees:[],ho()}catch(e){console.error("Failed to load assignees:",e),uo=[]}}(),await wo()}let No=null,Oo=null,Ho={};async function _o(e){No=e;const t=document.getElementById("company-name");Oo=(null==t?void 0:t.textContent)||"";const n=document.getElementById("recruit-page-url");n&&(n.textContent=`/company-recruit.html?id=${e}`),f(e),b(e),h(),E(e),$(),I(),w(),Fo(!0);try{Ho=await k(e)||{},Object.keys(Ho).length>0?x(Ho,Oo):S(Oo),q(),function(){var e,t;const n=document.getElementById("btn-save-recruit-settings");n&&(n.replaceWith(n.cloneNode(!0)),null==(e=document.getElementById("btn-save-recruit-settings"))||e.addEventListener("click",async()=>{await L(No,e=>{Ho=e;const t=document.getElementById("recruit-save-message");t&&(t.style.display="block",setTimeout(()=>{t.style.display="none"},3e3))})}));const o=document.getElementById("btn-reset-recruit-settings");o&&(o.replaceWith(o.cloneNode(!0)),null==(t=document.getElementById("btn-reset-recruit-settings"))||t.addEventListener("click",()=>{T(Ho,Oo),B()}))}()}finally{Fo(!1)}}function Fo(e){const t=document.getElementById("section-recruit-settings");if(!t)return;t.querySelectorAll("input, select, textarea, button").forEach(t=>{t.disabled=e});const n=document.getElementById("btn-save-recruit-settings"),o=document.getElementById("btn-reset-recruit-settings");n&&(n.disabled=e),o&&(o.disabled=e);const a=t.querySelector(".recruit-loading-overlay");if(e){if(!a){const e=document.createElement("div");e.className="recruit-loading-overlay",e.innerHTML='<div class="loading-spinner"></div><p>èª­ã¿è¾¼ã¿ä¸­...</p>',t.style.position="relative",t.appendChild(e)}}else null==a||a.remove()}const Vo={gasApiUrl:"https://script.google.com/macros/s/AKfycbxj6CqSfY7jq04uDXURhewD_BAKx3csLKBpl1hdRBdNg-R-E6IuoaZGje22Gr9WYWY2/exec",firebaseConfig:{apiKey:"AIzaSyB3eXZoFkXOwnHxPvaHiWO7csmZK4KGqAQ",authDomain:"generated-area-484613-e3-90bd4.firebaseapp.com",projectId:"generated-area-484613-e3-90bd4"},sessionKey:"rikueco_admin_session",userRoleKey:"rikueco_user_role",userCompanyKey:"rikueco_user_company"},Ko="admin";function Jo(){return!!sessionStorage.getItem(Vo.sessionKey)}function zo(){return sessionStorage.getItem(Vo.userRoleKey)===Ko}function Go(e){return!!zo()||sessionStorage.getItem(Vo.userCompanyKey)===e}function Yo(){sessionStorage.removeItem(Vo.sessionKey),sessionStorage.removeItem(Vo.userRoleKey),sessionStorage.removeItem(Vo.userCompanyKey),sessionStorage.removeItem("auth_method"),sessionStorage.removeItem("company_user_id"),"undefined"!=typeof firebase&&firebase.auth&&firebase.auth().signOut()}function Qo(){return"undefined"==typeof firebase?(console.warn("[JobManager] Firebase not loaded"),!1):(firebase.apps.length||firebase.initializeApp(Vo.firebaseConfig),!0)}export{At as $,Wt as A,qn as B,Gt as C,Yt as D,Kt as E,zt as F,Jt as G,Ot as H,_t as I,gt as J,yt as K,Le as L,qe as M,Se as N,xe as O,we as P,Ie as Q,$e as R,K as S,z as T,oe as U,Y as V,G as W,X,Q as Y,kt as Z,Ct as _,ee as a,$n as a0,In as a1,wn as a2,xn as a3,se as a4,Z as a5,re as a6,ce as a7,ne as a8,ae as a9,Ht as aA,Ue as aB,Un as aC,Yn as aD,Qn as aE,Cn as aF,Dt as aG,bt as aH,jt as aI,Ee as aJ,Wn as aK,Yo as aL,Qo as aM,Jo as aN,Go as aO,zo as aP,Zn as aQ,Pn as aR,eo as aS,to as aT,ie as aa,le as ab,kn as ac,Bn as ad,_n as ae,Fn as af,no as ag,Ln as ah,On as ai,oo as aj,en as ak,jn as al,me as am,zn as an,ue as ao,pe as ap,Jn as aq,ye as ar,ve as as,de as at,Vn as au,Kn as av,An as aw,Pe as ax,Et as ay,ht as az,M as b,D as c,Xt as d,Gn as e,Nn as f,W as g,on as h,te as i,Dn as j,Vo as k,Sn as l,Hn as m,Tn as n,Ro as o,nn as p,_o as q,ge as r,Xn as s,bn as t,fn as u,gn as v,vn as w,En as x,tn as y,Zt as z};
