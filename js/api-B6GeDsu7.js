import{spreadsheetConfig as t}from"./config-Cl207AaT.js";import{getRecruitSettings as e,saveRecruitSettings as n}from"./firestore-service-nwMOgNSo.js";const s=t.gasApiUrl,o=new Map;async function a(t){if(!t)return null;const n=Date.now(),s=o.get(t);if(s&&n-s.timestamp<3e5)return s.data;try{const s=await e(t);if(s.success&&s.settings&&Object.keys(s.settings).length>0)return o.set(t,{data:s.settings,timestamp:n}),s.settings}catch(a){console.log("[RecruitSettings] Firestore読み込みエラー:",a)}return(null==s?void 0:s.data)||null}async function r(t){try{const e=await n(t.companyDomain,t);if(!e.success)throw new Error(e.error||"保存に失敗しました");return t.companyDomain&&o.set(t.companyDomain,{data:t,timestamp:Date.now()}),e}catch(c){throw console.error("[RecruitSettings] Firestore保存エラー:",c),c}const e=btoa(unescape(encodeURIComponent(JSON.stringify({action:"updateRecruitSettings",settings:t})))),a=`${s}?action=post&data=${encodeURIComponent(e)}`,r=await fetch(a,{method:"GET",redirect:"follow"}),i=await r.json();if(!i.success)throw new Error(i.message||i.error||"保存に失敗しました");return t.companyDomain&&o.set(t.companyDomain,{data:t,timestamp:Date.now()}),i}export{a as l,r as s};
