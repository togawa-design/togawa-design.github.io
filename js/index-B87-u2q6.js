import{e}from"./utils-DCR9QUau.js";const t="https://asia-northeast1-generated-area-484613-e3-90bd4.cloudfunctions.net";async function n(){const e=await async function(){try{const e=firebase.auth().currentUser;if(e)return await e.getIdToken()}catch(e){console.warn("Failed to get ID token:",e)}return null}(),t={"Content-Type":"application/json"};return e&&(t.Authorization=`Bearer ${e}`),t}async function a(e,a,i){if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)throw new Error("ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚æœ¬ç•ªç’°å¢ƒã§ãŠè©¦ã—ãã ã•ã„ã€‚");const s=await n(),l=await fetch(`${t}/initiateCalendarAuth`,{method:"POST",headers:s,body:JSON.stringify({companyDomain:e,companyUserId:a,staffName:i})});if(!l.ok){const e=await l.json();throw new Error(e.error||"èªè¨¼URLã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")}return l.json()}async function i(e,a){if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)return console.log("[Calendar] ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã¯åˆ©ç”¨ã§ãã¾ã›ã‚“"),{success:!0,integration:null};const i=await n(),s=new URLSearchParams({companyDomain:e,companyUserId:a}),l=await fetch(`${t}/getCalendarIntegration?${s}`,{headers:i});if(!l.ok){const e=await l.json();throw new Error(e.error||"é€£æºæƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")}return l.json()}async function s(e,a){const i=await n(),s=await fetch(`${t}/revokeCalendarAuth`,{method:"POST",headers:i,body:JSON.stringify({companyDomain:e,companyUserId:a})});if(!s.ok){const e=await s.json();throw new Error(e.error||"é€£æºè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ")}return s.json()}async function l(e,a,i,s){const l=await n(),o=new URLSearchParams({companyDomain:e,companyUserId:a,startDate:i,endDate:s}),c=await fetch(`${t}/getCalendarAvailability?${o}`,{headers:l});if(!c.ok){const e=await c.json();throw new Error(e.error||"ç©ºãæ™‚é–“ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")}return c.json()}async function o(e){const a=await n(),i=await fetch(`${t}/createCalendarEvent`,{method:"POST",headers:a,body:JSON.stringify(e)});if(!i.ok){const e=await i.json();throw new Error(e.error||"ã‚¤ãƒ™ãƒ³ãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}return i.json()}function c(e){const t=new Date(e),n=t.getDay(),a=t.getDate()-n+(0===n?-6:1);return t.setDate(a),t.setHours(0,0,0,0),t}function r(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function d(e){return["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"][e.getDay()]}const u={apiKey:"AIzaSyB3eXZoFkXOwnHxPvaHiWO7csmZK4KGqAQ",authDomain:"generated-area-484613-e3-90bd4.firebaseapp.com",projectId:"generated-area-484613-e3-90bd4"};let p=null,v=null,m=[],g=[],f=1;let y=null,h=[],w={},b=[],$={},L=null,E=null,D="";function k(e){return document.getElementById(D+e)}const S={new:"æ–°è¦",contacted:"é€£çµ¡æ¸ˆã¿",interviewing:"é¢æ¥èª¿æ•´ä¸­",interviewed:"é¢æ¥æ¸ˆã¿",hired:"æ¡ç”¨",joined:"å…¥ç¤¾",pending:"ä¿ç•™",ng:"NG",rejected:"ä¸æ¡ç”¨",withdrawn:"è¾é€€"},x={apply:"å¿œå‹Ÿ",line:"LINEç›¸è«‡",consult:"ãŠå•ã„åˆã‚ã›"},A={immediate:"ã™ãã«ã§ã‚‚","within-week":"1é€±é–“ä»¥å†…","within-month":"1ãƒ¶æœˆä»¥å†…","within-2months":"2ãƒ¶æœˆä»¥å†…",undecided:"æœªå®šãƒ»ç›¸è«‡ã—ãŸã„"},T={first_contact:{subject:"åˆå›é€£çµ¡",body:"{applicantName}æ§˜\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã«ã”å¿œå‹Ÿã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\n\nã”å¿œå‹Ÿå†…å®¹ã‚’ç¢ºèªã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚\nã¤ãã¾ã—ã¦ã¯ã€ä¸€åº¦ãŠé›»è©±ã«ã¦ãŠè©±ã‚’ã•ã›ã¦ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚\n\nã”éƒ½åˆã®è‰¯ã„æ—¥æ™‚ã‚’ã„ãã¤ã‹ãŠçŸ¥ã‚‰ã›ã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\nï¼ˆå¹³æ—¥10:00ã€œ18:00ã®é–“ã§ãŠé¡˜ã„ã§ãã¾ã™ã¨å¹¸ã„ã§ã™ï¼‰\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},schedule_interview:{subject:"é¢æ¥æ—¥ç¨‹èª¿æ•´",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¢æ¥ã®æ—¥ç¨‹èª¿æ•´ã«ã¤ã„ã¦ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚\n\nä¸‹è¨˜ã®æ—¥ç¨‹ã§ã”éƒ½åˆã®è‰¯ã„æ—¥æ™‚ã¯ã”ã–ã„ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\n\nã€å€™è£œæ—¥ã€‘\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nãƒ»â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\n\nä¸Šè¨˜ä»¥å¤–ã§ã‚‚ã”èª¿æ•´å¯èƒ½ã§ã™ã®ã§ã€ã”å¸Œæœ›ã®æ—¥æ™‚ãŒã”ã–ã„ã¾ã—ãŸã‚‰ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚\n\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},interview_reminder:{subject:"é¢æ¥ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¢æ¥æ—¥ç¨‹ã®ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’ãŠé€ã‚Šã„ãŸã—ã¾ã™ã€‚\n\nã€é¢æ¥æ—¥æ™‚ã€‘â—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰â—¯â—¯:00ã€œ\nã€å ´æ‰€ã€‘ã€’â—¯â—¯â—¯-â—¯â—¯â—¯â—¯ â—¯â—¯çœŒâ—¯â—¯å¸‚â—¯â—¯\nã€æŒã¡ç‰©ã€‘å±¥æ­´æ›¸ã€ç­†è¨˜ç”¨å…·\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nå½“æ—¥ãŠä¼šã„ã§ãã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚"},document_request:{subject:"æ›¸é¡æå‡ºä¾é ¼",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\né¸è€ƒã‚’é€²ã‚ã‚‹ã«ã‚ãŸã‚Šã€ä¸‹è¨˜ã®æ›¸é¡ã‚’ã”æå‡ºã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚\n\nã€æå‡ºæ›¸é¡ã€‘\nãƒ»å±¥æ­´æ›¸ï¼ˆå†™çœŸè²¼ä»˜ï¼‰\nãƒ»è·å‹™çµŒæ­´æ›¸\n\nã€æå‡ºæ–¹æ³•ã€‘\nãƒã‚¤ãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã«ã¦ã”é€ä»˜ãã ã•ã„ã€‚\n\nã€æå‡ºæœŸé™ã€‘\nâ—¯æœˆâ—¯æ—¥ï¼ˆâ—¯ï¼‰ã¾ã§\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"},result_pending:{subject:"é¸è€ƒçµæœå¾…ã¡",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nå…ˆæ—¥ã¯é¢æ¥ã«ãŠè¶Šã—ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\nç¾åœ¨ã€ç¤¾å†…ã«ã¦é¸è€ƒã‚’é€²ã‚ã¦ãŠã‚Šã¾ã™ã€‚\nçµæœã«ã¤ãã¾ã—ã¦ã¯ã€â—¯æœˆâ—¯æ—¥é ƒã¾ã§ã«ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãäºˆå®šã§ã™ã€‚\n\nä»Šã—ã°ã‚‰ããŠå¾…ã¡ã„ãŸã ã‘ã¾ã™ã‚ˆã†ãŠé¡˜ã„ç”³ã—ä¸Šã’ã¾ã™ã€‚"},offer:{subject:"å†…å®šé€šçŸ¥",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã®é¸è€ƒã«ã”å‚åŠ ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\næ…é‡ã«æ¤œè¨ã•ã›ã¦ã„ãŸã ã„ãŸçµæœã€{applicantName}æ§˜ã‚’æ¡ç”¨ã•ã›ã¦ã„ãŸã ãã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚\n\nã¤ãã¾ã—ã¦ã¯ã€å…¥ç¤¾ã«é–¢ã™ã‚‹è©³ç´°ã«ã¤ã„ã¦ã”èª¬æ˜ã•ã›ã¦ã„ãŸã ããŸãã€\nãŠé›»è©±ã«ã¦ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\n\nã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\n{applicantName}æ§˜ã¨ä¸€ç·’ã«åƒã‘ã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚"},rejection:{subject:"ä¸æ¡ç”¨é€šçŸ¥",body:"{applicantName}æ§˜\n\nãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚\n\nã“ã®åº¦ã¯ã€Œ{jobTitle}ã€ã«ã”å¿œå‹Ÿã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\næ…é‡ã«æ¤œè¨ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸãŒã€èª ã«æ®‹å¿µãªãŒã‚‰ä»Šå›ã¯ã”æœŸå¾…ã«æ²¿ãˆãªã„çµæœã¨ãªã‚Šã¾ã—ãŸã€‚\n\nã”å¿œå‹Ÿã„ãŸã ã„ãŸã“ã¨ã«å¿ƒã‚ˆã‚Šæ„Ÿè¬ç”³ã—ä¸Šã’ã¾ã™ã¨ã¨ã‚‚ã«ã€\n{applicantName}æ§˜ã®ä»Šå¾Œã®ã”æ´»èºã‚’ãŠç¥ˆã‚Šç”³ã—ä¸Šã’ã¾ã™ã€‚"}};function j(){return firebase.apps.length||firebase.initializeApp(u),firebase.firestore()}async function C(){try{const e=j(),t=await e.collection("company_users").where("companyDomain","==",p).where("isActive","==",!0).get();return b=[],t.forEach(e=>{b.push({id:e.id,...e.data()})}),await async function(){$={};for(const t of b)try{const e=await i(p,t.id);e.integration&&($[t.id]=e.integration)}catch(e){console.log(`No calendar integration for user ${t.id}`)}}(),b}catch(e){return console.error("Failed to load company users:",e),[]}}function M(e){const t=document.querySelector(".applicants-content"),n=k("settings-section"),a=k("page-title"),i=document.querySelector(".header-actions");if("settings"===e){t&&(t.style.display="none"),n&&(n.style.display="block"),a&&(a.textContent="è¨­å®š"),i&&(i.style.display="none"),document.querySelectorAll(".sidebar-nav li").forEach(e=>{e.classList.remove("active")});const e=document.getElementById("nav-settings");e&&e.closest("li").classList.add("active"),I()}else{t&&(t.style.display="flex"),n&&(n.style.display="none"),a&&(a.textContent="å¿œå‹Ÿè€…ä¸€è¦§"),i&&(i.style.display="flex"),document.querySelectorAll(".sidebar-nav li").forEach(e=>{e.classList.remove("active")});const e=document.querySelector('[data-section="applicants"]');e&&e.closest("li").classList.add("active")}}function I(){const t=k("calendar-integrations-list");t&&(0!==b.length?(t.innerHTML=b.map(t=>{const n=$[t.id],a=n&&n.isActive;return`\n      <div class="calendar-integration-item" data-user-id="${e(t.id)}">\n        <div class="calendar-integration-info">\n          <div class="calendar-integration-icon">ğŸ‘¤</div>\n          <div class="calendar-integration-details">\n            <h4>${e(t.name||t.username)}</h4>\n            <p>${a?e(n.googleEmail):"æœªé€£æº"}</p>\n          </div>\n        </div>\n        <div class="calendar-integration-actions">\n          ${a?`<span class="calendar-status connected">é€£æºä¸­</span>\n               <button class="btn-disconnect-calendar" data-user-id="${e(t.id)}">è§£é™¤</button>`:`<button class="btn-connect-calendar" data-user-id="${e(t.id)}" data-user-name="${e(t.name||t.username)}">\n                 <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"/></svg>\n                 Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«é€£æº\n               </button>`}\n        </div>\n      </div>\n    `}).join(""),t.querySelectorAll(".btn-connect-calendar").forEach(e=>{e.addEventListener("click",()=>{!async function(e,t){try{const n=await a(p,e,t);window.open(n.authUrl,"calendar-auth","width=600,height=700");let s=0;const l=10,o=setInterval(async()=>{s++;try{const t=await i(p,e);t.integration&&t.integration.isActive&&(clearInterval(o),$[e]=t.integration,I(),alert("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºãŒå®Œäº†ã—ã¾ã—ãŸ"))}catch(t){}s>=l&&clearInterval(o)},3e3)}catch(n){console.error("Failed to initiate calendar auth:",n),alert("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ: "+n.message)}}(e.dataset.userId,e.dataset.userName)})}),t.querySelectorAll(".btn-disconnect-calendar").forEach(e=>{e.addEventListener("click",()=>{!async function(e){if(!confirm("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ"))return;try{await s(p,e),delete $[e],I(),alert("ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºã‚’è§£é™¤ã—ã¾ã—ãŸ")}catch(t){console.error("Failed to revoke calendar auth:",t),alert("é€£æºè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: "+t.message)}}(e.dataset.userId)})})):t.innerHTML='<p class="no-data">æ‹…å½“è€…ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>ç®¡ç†ç”»é¢ã‹ã‚‰æ‹…å½“è€…ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚</p>')}async function H(){if(!y)return;const t=k("interview-modal");if(!t)return;const n=k("interview-staff");n&&(n.innerHTML='<option value="">æ‹…å½“è€…ã‚’é¸æŠ...</option>'+b.map(t=>{const n=$[t.id],a=(null==n?void 0:n.isActive)?" (ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºæ¸ˆ)":"";return`<option value="${e(t.id)}" data-has-calendar="${(null==n?void 0:n.isActive)?"true":"false"}">${e(t.name||t.username)}${a}</option>`}).join("")),E=null,L=c(new Date),k("availability-section").style.display="none",k("selected-slot-section").style.display="none",k("manual-datetime-section").style.display="block",k("calendar-status-hint").textContent="",t.style.display="flex"}function N(){const e=k("interview-modal");e&&(e.style.display="none")}async function F(){var e;const t=k("interview-staff"),n=t.options[t.selectedIndex],a="true"===(null==(e=null==n?void 0:n.dataset)?void 0:e.hasCalendar),i=t.value,s=k("availability-section"),l=k("manual-datetime-section"),o=k("calendar-status-hint");if(!i)return s.style.display="none",l.style.display="block",void(o.textContent="");a?(s.style.display="block",l.style.display="none",o.textContent="æ‹…å½“è€…ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰ç©ºãæ™‚é–“ã‚’å–å¾—ã—ã¾ã™",o.style.color="#10b981",await q(i)):(s.style.display="none",l.style.display="block",o.textContent="ã“ã®æ‹…å½“è€…ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœªé€£æºã§ã™ã€‚æ‰‹å‹•ã§æ—¥æ™‚ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",o.style.color="#f59e0b")}async function q(t){const n=k("availability-grid");if(n){n.innerHTML='<div class="loading-message">ç©ºãæ™‚é–“ã‚’å–å¾—ä¸­...</div>';try{const n=new Date(L);n.setDate(n.getDate()+6);const a=r(L),i=r(n);!function(t){const n=k("availability-grid");if(!n)return;const a={},i=[];for(let e=0;e<5;e++){const t=new Date(L);t.setDate(t.getDate()+e);const n=r(t);i.push({date:t,dateStr:n}),a[n]=[]}t.forEach(e=>{const t=e.start.split("T")[0];a[t]&&a[t].push(e)}),n.innerHTML=i.map(({date:t,dateStr:n})=>{const i=a[n]||[];return`\n      <div class="availability-day">\n        <div class="availability-day-header">\n          <span class="day-name">${d(t)}</span>\n          <span class="day-date">${`${t.getMonth()+1}/${t.getDate()}`}</span>\n        </div>\n        <div class="availability-slots">\n          ${i.length>0?i.map(t=>{const n=new Date(t.start),a=`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`,i=t.start;return`<button class="slot-btn ${E===i?"selected":""}" data-slot="${e(i)}">${a}</button>`}).join(""):'<p class="no-slots">ç©ºããªã—</p>'}\n        </div>\n      </div>\n    `}).join(""),n.querySelectorAll(".slot-btn").forEach(e=>{e.addEventListener("click",()=>{!function(e){E=e,document.querySelectorAll(".slot-btn").forEach(t=>{t.classList.toggle("selected",t.dataset.slot===e)});const t=k("selected-slot-section"),n=k("selected-slot");if(t&&n){const a=new Date(e),i=d(a),s=`${a.getFullYear()}å¹´${a.getMonth()+1}æœˆ${a.getDate()}æ—¥(${i})`,l=`${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`;n.textContent=`${s} ${l}`,t.style.display="block"}}(e.dataset.slot)})})}((await l(p,t,a,i)).availableSlots||[]),function(){const e=k("week-label");if(!e||!L)return;const t=new Date(L);t.setDate(t.getDate()+6);const n=`${L.getMonth()+1}/${L.getDate()}`,a=`${t.getMonth()+1}/${t.getDate()}`;e.textContent=`${L.getFullYear()}å¹´ ${n} - ${a}`}()}catch(a){console.error("Failed to load availability:",a),n.innerHTML='<div class="empty-message">ç©ºãæ™‚é–“ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</div>'}}}function U(){L.setDate(L.getDate()-7);const e=k("interview-staff");(null==e?void 0:e.value)&&q(e.value)}function R(){L.setDate(L.getDate()+7);const e=k("interview-staff");(null==e?void 0:e.value)&&q(e.value)}async function O(){var e,t,n,a,i,s,l,c;const r=k("interview-staff"),d=null==r?void 0:r.value;if(!d)return void alert("æ‹…å½“è€…ã‚’é¸æŠã—ã¦ãã ã•ã„");const u=r.options[r.selectedIndex];let v;if("true"===(null==(e=null==u?void 0:u.dataset)?void 0:e.hasCalendar)&&E)v=new Date(E);else{const e=k("interview-datetime");if(!(null==e?void 0:e.value))return void alert("é¢è«‡æ—¥æ™‚ã‚’é¸æŠã—ã¦ãã ã•ã„");v=new Date(e.value)}const g=parseInt((null==(t=k("interview-duration"))?void 0:t.value)||"60"),f=(null==(n=document.querySelector('input[name="meeting-type"]:checked'))?void 0:n.value)||"in_person",h=(null==(a=k("interview-location"))?void 0:a.value)||"",w=[];(null==(i=k("send-reminder-1day"))?void 0:i.checked)&&w.push({offsetMinutes:1440,sendTime:"10:00"}),(null==(s=k("send-reminder-1hour"))?void 0:s.checked)&&w.push({offsetMinutes:60});const $=m.find(e=>e.id===y);if(!$)return;const L=b.find(e=>e.id===d),D=k("interview-modal-save");D&&(D.disabled=!0,D.textContent="ç™»éŒ²ä¸­...");try{const e=await o({companyDomain:p,companyUserId:d,applicationId:y,applicantName:$.applicantName||(null==(l=$.applicant)?void 0:l.name)||"å¿œå‹Ÿè€…",applicantEmail:$.applicantEmail||(null==(c=$.applicant)?void 0:c.email)||"",staffName:(null==L?void 0:L.name)||(null==L?void 0:L.username)||"æ‹…å½“è€…",scheduledAt:v.toISOString(),durationMinutes:g,meetingType:f,location:h,reminders:w}),t=j();await t.collection("applications").doc(y).update({status:"interviewing",interviewId:e.interviewId,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const n=m.findIndex(e=>e.id===y);-1!==n&&(m[n].status="interviewing",m[n].interviewId=e.interviewId),N(),Z(y),K(),z(),alert("é¢è«‡ã‚’ç™»éŒ²ã—ã¾ã—ãŸã€‚æ‹…å½“è€…ã®Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«äºˆå®šãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚")}catch(S){console.error("Failed to save interview:",S),alert("é¢è«‡ã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: "+S.message)}finally{D&&(D.disabled=!1,D.textContent="é¢è«‡ã‚’ç™»éŒ²")}}async function P(){try{const e=j().collection("settings").doc(p||"global"),t=await e.get();h=t.exists&&t.data().assignees?t.data().assignees:[],B()}catch(e){console.error("Failed to load assignees:",e),h=[]}}function B(){const t=k("detail-assignee");if(t){const n=t.value;t.innerHTML='<option value="">æœªå‰²å½“</option>'+h.map(t=>`<option value="${e(t)}">${e(t)}</option>`).join(""),t.value=n}}async function _(){var e;const t=k("new-assignee-name"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(n)if(h.includes(n))alert("ã“ã®æ‹…å½“è€…ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™");else try{const e=j().collection("settings").doc(p||"global");h.push(n),await e.set({assignees:h,updatedAt:firebase.firestore.FieldValue.serverTimestamp()},{merge:!0}),B(),Y();const t=k("detail-assignee");t&&(t.value=n)}catch(a){console.error("Failed to add assignee:",a),alert("æ‹…å½“è€…ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}else alert("æ‹…å½“è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")}function V(){const e=k("assignee-modal"),t=k("new-assignee-name");e&&(e.style.display="flex"),t&&(t.value="",t.focus())}function Y(){const e=k("assignee-modal");e&&(e.style.display="none")}async function G(){const e=k("applicants-list");e&&(e.innerHTML='<div class="loading-message">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>');try{let e=j().collection("applications");p&&(e=e.where("companyDomain","==",p)),e=e.orderBy("createdAt","desc");const t=await e.get();m=[],t.forEach(e=>{m.push({id:e.id,...e.data()})}),w={},m.forEach(e=>{var t,n;const a=e.applicantPhone||(null==(t=e.applicant)?void 0:t.phone),i=e.applicantEmail||(null==(n=e.applicant)?void 0:n.email);if(a){const t=a.replace(/[-\s]/g,"");w[t]||(w[t]=[]),w[t].push(e)}if(i){const t=i.toLowerCase().trim();w[t]||(w[t]=[]),w[t].push(e)}}),K(),z()}catch(t){console.error("Failed to load applicants:",t),e&&(e.innerHTML='<div class="empty-message">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>')}}function K(){var e,t,n,a;const i=(null==(e=k("filter-status"))?void 0:e.value)||"",s=(null==(t=k("filter-type"))?void 0:t.value)||"",l=(null==(a=null==(n=k("filter-search"))?void 0:n.value)?void 0:a.toLowerCase())||"";g=m.filter(e=>{var t;if(i&&(e.status||"new")!==i)return!1;if(s&&e.type!==s)return!1;if(l){const n=(e.jobTitle||"").toLowerCase(),a=(e.applicantName||(null==(t=e.applicant)?void 0:t.name)||"").toLowerCase();if(!n.includes(l)&&!a.includes(l))return!1}return!0}),f=1,J(),X()}function z(){const e=m.length,t=m.filter(e=>!e.status||"new"===e.status).length,n=m.filter(e=>["contacted","interviewing","interviewed","pending"].includes(e.status)).length,a=m.filter(e=>["hired","joined","ng","rejected","withdrawn"].includes(e.status)).length,i=k("stat-total"),s=k("stat-new"),l=k("stat-progress"),o=k("stat-complete");i&&(i.textContent=e),s&&(s.textContent=t),l&&(l.textContent=n),o&&(o.textContent=a)}function J(){const t=k("applicants-list");if(!t)return;if(0===g.length)return void(t.innerHTML='<div class="empty-message">å¿œå‹Ÿãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>');const n=20*(f-1),a=n+20,i=g.slice(n,a);t.innerHTML=i.map(t=>{var n,a;const i=se((null==(n=t.createdAt)?void 0:n.toDate)?t.createdAt.toDate():new Date(t.timestamp||t.createdAt)),s=t.status||"new",l=x[t.type]||t.type||"-",o=S[s]||s,c=t.applicantName||(null==(a=t.applicant)?void 0:a.name)||"-",r=y===t.id;let d="type-apply";"line"===t.type&&(d="type-line"),"consult"===t.type&&(d="type-consult");const u=function(e){var t,n,a;const i=e.applicantPhone||(null==(t=e.applicant)?void 0:t.phone),s=e.applicantEmail||(null==(n=e.applicant)?void 0:n.email);let l=[];if(i){const e=i.replace(/[-\s]/g,""),t=w[e]||[];l=l.concat(t)}if(s){const e=s.toLowerCase().trim(),t=w[e]||[];l=l.concat(t)}const o=[...new Map(l.map(e=>[e.id,e])).values()].filter(t=>t.id!==e.id),c=(null==(a=e.createdAt)?void 0:a.toDate)?e.createdAt.toDate():new Date(e.timestamp||e.createdAt),r=o.filter(e=>{var t;return((null==(t=e.createdAt)?void 0:t.toDate)?e.createdAt.toDate():new Date(e.timestamp||e.createdAt))<c});return{isReapply:r.length>0,hasNgHistory:r.some(e=>"ng"===e.status||"rejected"===e.status),previousApps:r}}(t);let p="";return u.hasNgHistory?p+='<span class="duplicate-badge badge-ng-history">NGå±¥æ­´</span>':u.isReapply&&(p+='<span class="duplicate-badge badge-reapply">å†å¿œå‹Ÿ</span>'),`\n      <div class="applicant-card ${r?"selected":""}" data-id="${e(t.id)}">\n        <div class="applicant-card-main">\n          <div class="applicant-card-header">\n            <span class="applicant-card-name">${e(c)}</span>\n            <span class="applicant-card-type ${d}">${e(l)}</span>\n            ${p}\n          </div>\n          <div class="applicant-card-job">${e(t.jobTitle||"-")}</div>\n          <div class="applicant-card-meta">\n            <span>${e(i)}</span>\n            ${t.assignee?`<span>æ‹…å½“: ${e(t.assignee)}</span>`:""}\n          </div>\n        </div>\n        <div class="applicant-card-status">\n          <span class="status-badge status-${e(s)}">${e(o)}</span>\n        </div>\n      </div>\n    `}).join(""),t.querySelectorAll(".applicant-card").forEach(e=>{e.addEventListener("click",()=>{Z(e.dataset.id)})})}function X(){const e=k("pagination");if(!e)return;const t=Math.ceil(g.length/20);if(t<=1)return void(e.innerHTML="");let n="";n+=`<button class="page-btn" ${1===f?"disabled":""} data-page="${f-1}">å‰ã¸</button>`;for(let a=1;a<=t;a++)1===a||a===t||a>=f-2&&a<=f+2?n+=`<button class="page-btn ${a===f?"active":""}" data-page="${a}">${a}</button>`:a!==f-3&&a!==f+3||(n+='<span class="page-ellipsis">...</span>');n+=`<button class="page-btn" ${f===t?"disabled":""} data-page="${f+1}">æ¬¡ã¸</button>`,e.innerHTML=n,e.querySelectorAll(".page-btn").forEach(e=>{e.addEventListener("click",()=>{e.disabled||(f=parseInt(e.dataset.page),J(),X())})})}function Z(t){var n,a,i,s,l,o,c;const r=m.find(e=>e.id===t);if(!r)return;y=t,document.querySelectorAll(".applicant-card").forEach(e=>{e.classList.toggle("selected",e.dataset.id===t)});const u=k("detail-empty"),p=k("detail-content");u&&(u.style.display="none"),p&&(p.style.display="flex");const v=r.applicantName||(null==(n=r.applicant)?void 0:n.name)||"-",g=r.applicantPhone||(null==(a=r.applicant)?void 0:a.phone)||"-",f=r.applicantEmail||(null==(i=r.applicant)?void 0:i.email)||"-",h=(null==(s=r.applicant)?void 0:s.age)||"-",w=(null==(l=r.applicant)?void 0:l.address)||"-",b=(null==(o=r.applicant)?void 0:o.startDate)||"-";k("detail-name").textContent=v,k("detail-job-title").textContent=r.jobTitle||"-",k("detail-phone").textContent=g,k("detail-email").textContent=f,k("detail-age").textContent=h,k("detail-address").textContent=w,k("detail-start-date").textContent=A[b]||b;const $=(null==(c=r.createdAt)?void 0:c.toDate)?r.createdAt.toDate():new Date(r.timestamp||r.createdAt);k("detail-datetime").textContent=se($,!0),k("detail-type").textContent=x[r.type]||r.type||"-",k("detail-source").textContent=le(r.source);const L=r.status||"new";document.querySelectorAll(".status-btn").forEach(e=>{e.classList.toggle("active",e.dataset.status===L)});const E=k("detail-assignee");E&&(E.value=r.assignee||"");const D=k("detail-notes");D&&(D.value=r.notes||""),te(r.history||[]),W(t),async function(t){var n;const a=k("interview-info");if(!a)return;const i=m.find(e=>e.id===t);if(null==i?void 0:i.interviewId)try{const t=j(),s=await t.collection("interviews").doc(i.interviewId).get();if(!s.exists)return void(a.innerHTML='<p class="no-data">é¢è«‡ã¯è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>');const l=s.data(),o=(null==(n=l.scheduledAt)?void 0:n.toDate)?l.scheduledAt.toDate():new Date(l.scheduledAt),c=d(o),r={in_person:"å¯¾é¢",online:"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³",phone:"é›»è©±"};a.innerHTML=`\n      <div class="interview-scheduled">\n        <h4>é¢è«‡äºˆå®š</h4>\n        <p><strong>æ—¥æ™‚:</strong> ${o.getFullYear()}å¹´${o.getMonth()+1}æœˆ${o.getDate()}æ—¥(${c}) ${String(o.getHours()).padStart(2,"0")}:${String(o.getMinutes()).padStart(2,"0")}</p>\n        <p><strong>æ‹…å½“è€…:</strong> ${e(l.staffName||"-")}</p>\n        <p><strong>å½¢å¼:</strong> ${r[l.meetingType]||l.meetingType}</p>\n        ${l.location?`<p><strong>å ´æ‰€:</strong> ${e(l.location)}</p>`:""}\n      </div>\n    `}catch(s){console.error("Failed to load interview info:",s),a.innerHTML='<p class="no-data">é¢è«‡æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</p>'}else a.innerHTML='<p class="no-data">é¢è«‡ã¯è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>'}(t)}function Q(){y=null,document.querySelectorAll(".applicant-card").forEach(e=>{e.classList.remove("selected")});const e=k("detail-empty"),t=k("detail-content");e&&(e.style.display="flex"),t&&(t.style.display="none")}async function W(t){const n=k("messages-container");if(n){n.innerHTML='<p class="no-data">èª­ã¿è¾¼ã¿ä¸­...</p>';try{const n=j(),a=await n.collection("messages").where("applicationId","==",t).orderBy("createdAt","asc").get(),i=[];a.forEach(e=>{i.push({id:e.id,...e.data()})}),function(t){const n=k("messages-container");if(!n)return;if(!t||0===t.length)return void(n.innerHTML='<p class="no-data">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚ã‚Šã¾ã›ã‚“</p>');n.innerHTML=t.map(t=>{var n;const a=(null==(n=t.createdAt)?void 0:n.toDate)?t.createdAt.toDate():new Date(t.createdAt),i="company"===t.from;return`\n      <div class="message-item ${i?"message-company":"message-applicant"}">\n        <div class="message-header">\n          <span class="message-sender">${e(i?"ä¼šç¤¾":"å¿œå‹Ÿè€…")}</span>\n          <span class="message-date">${se(a,!0)}</span>\n        </div>\n        <div class="message-content">${e(t.content).replace(/\n/g,"<br>")}</div>\n      </div>\n    `}).join(""),n.scrollTop=n.scrollHeight}(i)}catch(a){console.error("Failed to load messages:",a),n.innerHTML='<p class="no-data">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p>'}}}async function ee(){var e;if(!y)return;const t=k("new-message-text"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(!n)return void alert("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");const a=k("btn-send-message");a&&(a.disabled=!0,a.textContent="é€ä¿¡ä¸­...");try{const e=j(),a=m.find(e=>e.id===y);await e.collection("messages").add({applicationId:y,companyDomain:(null==a?void 0:a.companyDomain)||p,from:"company",content:n,read:!1,createdAt:firebase.firestore.FieldValue.serverTimestamp()}),t.value="",await W(y)}catch(i){console.error("Failed to send message:",i),alert("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ: "+i.message)}finally{a&&(a.disabled=!1,a.textContent="é€ä¿¡")}}function te(t){const n=k("detail-history");n&&(t&&0!==t.length?n.innerHTML=t.map(t=>{var n;return`\n      <div class="history-item">\n        <div class="history-date">${se((null==(n=t.date)?void 0:n.toDate)?t.date.toDate():new Date(t.date),!0)}</div>\n        <div class="history-text">${e(t.text)}</div>\n      </div>\n    `}).join(""):n.innerHTML='<p class="no-data">å¯¾å¿œå±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“</p>')}async function ne(){var e,t;if(!y)return;const n=(null==(e=k("detail-notes"))?void 0:e.value)||"",a=(null==(t=k("detail-assignee"))?void 0:t.value)||"",i=k("btn-save-notes");i&&(i.disabled=!0,i.textContent="ä¿å­˜ä¸­...");try{const e=j();await e.collection("applications").doc(y).update({notes:n,assignee:a,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const t=m.findIndex(e=>e.id===y);-1!==t&&(m[t].notes=n,m[t].assignee=a),J()}catch(s){console.error("Failed to save notes:",s),alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{i&&(i.disabled=!1,i.textContent="ä¿å­˜")}}async function ae(){var e;if(!y)return;const t=k("new-history-text"),n=null==(e=null==t?void 0:t.value)?void 0:e.trim();if(n)try{const e=j(),a=m.find(e=>e.id===y),i=(null==a?void 0:a.history)||[];i.push({date:new Date,text:n}),await e.collection("applications").doc(y).update({history:i,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const s=m.findIndex(e=>e.id===y);-1!==s&&(m[s].history=i),te(i),t.value=""}catch(a){console.error("Failed to add history:",a),alert("å±¥æ­´ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}else alert("å¯¾å¿œå†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")}function ie(){if(0===g.length)return void alert("ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");const e=g.map(e=>{var t,n,a,i,s,l,o;const c=(null==(t=e.createdAt)?void 0:t.toDate)?e.createdAt.toDate():new Date(e.timestamp||e.createdAt),r=e.applicantName||(null==(n=e.applicant)?void 0:n.name)||"",d=e.applicantPhone||(null==(a=e.applicant)?void 0:a.phone)||"",u=e.applicantEmail||(null==(i=e.applicant)?void 0:i.email)||"",p=(null==(s=e.applicant)?void 0:s.age)||"",v=(null==(l=e.applicant)?void 0:l.address)||"",m=(null==(o=e.applicant)?void 0:o.startDate)||"";return[se(c,!0),x[e.type]||e.type||"",r,d,u,p,v,A[m]||m,e.jobTitle||"",le(e.source),S[e.status||"new"],e.assignee||"",(e.notes||"").replace(/"/g,'""')]}),t=[["æ—¥æ™‚","ç¨®åˆ¥","å¿œå‹Ÿè€…å","é›»è©±ç•ªå·","ãƒ¡ãƒ¼ãƒ«","å¹´é½¢","ç¾ä½æ‰€","å¸Œæœ›å‹¤å‹™é–‹å§‹æ—¥","æ±‚äººã‚¿ã‚¤ãƒˆãƒ«","æµå…¥å…ƒ","ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹","æ‹…å½“è€…","ãƒ¡ãƒ¢"].join(","),...e.map(e=>e.map(e=>`"${e}"`).join(","))].join("\n"),n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=`applicants-${p||"all"}-${function(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}${n}${a}`}(new Date)}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}function se(e,t=!1){if(!e||isNaN(e.getTime()))return"-";const n=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");if(!t)return`${n}/${a}/${i}`;return`${n}/${a}/${i} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}function le(e){if(!e||"direct"===e)return"ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹";try{const t=new URL(e).hostname;return t.includes("google")?"Googleæ¤œç´¢":t.includes("yahoo")?"Yahoo!æ¤œç´¢":t.includes("tiktok")?"TikTokåºƒå‘Š":t.includes("instagram")||t.includes("fb")||t.includes("facebook")?"Metaåºƒå‘Š":t.includes("twitter")||t.includes("x.com")?"X(Twitter)":t.includes("line")?"LINE":t}catch{return e||"ä¸æ˜"}}function oe(){var e,t,n,a,i,s,l,o,c,r,d,u,p,v,g,f,h,w,b,$,L,E,D,S,x,A,C,I,q,P;let B;null==(e=k("btn-refresh"))||e.addEventListener("click",G),null==(t=k("btn-refresh-applicants"))||t.addEventListener("click",G),null==(n=k("btn-export-csv"))||n.addEventListener("click",ie),null==(a=k("filter-status"))||a.addEventListener("change",K),null==(i=k("filter-type"))||i.addEventListener("change",K),null==(s=k("filter-search"))||s.addEventListener("input",()=>{clearTimeout(B),B=setTimeout(K,300)}),null==(l=k("btn-close-detail"))||l.addEventListener("click",Q),document.querySelectorAll(".status-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.status;t&&async function(e){if(y)try{const t=j();await t.collection("applications").doc(y).update({status:e,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});const n=m.findIndex(e=>e.id===y);-1!==n&&(m[n].status=e),document.querySelectorAll(".status-btn").forEach(t=>{t.classList.toggle("active",t.dataset.status===e)}),K(),z()}catch(t){console.error("Failed to update status:",t),alert("ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ")}}(t)})}),null==(o=k("btn-save-notes"))||o.addEventListener("click",ne),null==(c=k("btn-add-history"))||c.addEventListener("click",ae),null==(r=k("new-history-text"))||r.addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),ae())}),null==(d=k("btn-send-message"))||d.addEventListener("click",ee),null==(u=k("new-message-text"))||u.addEventListener("keydown",e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),ee())}),null==(p=k("message-template-select"))||p.addEventListener("change",e=>{!function(e){var t;if(!e)return;const n=T[e];if(!n)return;const a=m.find(e=>e.id===y);if(!a)return;const i=a.applicantName||(null==(t=a.applicant)?void 0:t.name)||"ãŠå®¢æ§˜",s=a.jobTitle||"æ±‚äºº";let l=n.body.replace(/{applicantName}/g,i).replace(/{jobTitle}/g,s);const o=k("new-message-text");o&&(o.value=l,o.focus());const c=k("message-template-select");c&&(c.value="")}(e.target.value)}),null==(v=k("btn-add-assignee"))||v.addEventListener("click",V),null==(g=k("assignee-modal-close"))||g.addEventListener("click",Y),null==(f=k("assignee-modal-cancel"))||f.addEventListener("click",Y),null==(h=k("assignee-modal-save"))||h.addEventListener("click",_),null==(w=k("assignee-modal"))||w.addEventListener("click",e=>{e.target.classList.contains("modal-overlay")&&Y()}),null==(b=k("new-assignee-name"))||b.addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),_())}),null==($=document.getElementById("nav-settings"))||$.addEventListener("click",e=>{e.preventDefault(),M("settings")}),null==(L=k("btn-back-to-applicants"))||L.addEventListener("click",()=>{M("applicants")}),null==(E=k("btn-schedule-interview"))||E.addEventListener("click",H),null==(D=k("interview-modal-close"))||D.addEventListener("click",N),null==(S=k("interview-modal-cancel"))||S.addEventListener("click",N),null==(x=k("interview-modal-save"))||x.addEventListener("click",O),null==(A=k("interview-modal"))||A.addEventListener("click",e=>{e.target.classList.contains("modal-overlay")&&N()}),null==(C=k("interview-staff"))||C.addEventListener("change",F),null==(I=k("btn-prev-week"))||I.addEventListener("click",U),null==(q=k("btn-next-week"))||q.addEventListener("click",R),null==(P=k("btn-save-reminder-settings"))||P.addEventListener("click",ce);const J=document.getElementById("mobile-menu-btn"),X=document.querySelector(".admin-sidebar");J&&X&&(J.addEventListener("click",()=>{X.classList.toggle("open"),J.classList.toggle("active")}),document.addEventListener("click",e=>{!X.classList.contains("open")||X.contains(e.target)||J.contains(e.target)||(X.classList.remove("open"),J.classList.remove("active"))}))}async function ce(){var e,t,n;try{const a=j(),i={reminder1Day:(null==(e=k("reminder-1day"))?void 0:e.checked)||!1,reminder1DayTime:(null==(t=k("reminder-1day-time"))?void 0:t.value)||"10:00",reminder1Hour:(null==(n=k("reminder-1hour"))?void 0:n.checked)||!1,updatedAt:firebase.firestore.FieldValue.serverTimestamp()};await a.collection("settings").doc(p||"global").set({reminderSettings:i},{merge:!0}),alert("ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ")}catch(a){console.error("Failed to save reminder settings:",a),alert("è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}}async function re(){const e=new URLSearchParams(window.location.search);p=e.get("domain"),v=e.get("company")?decodeURIComponent(e.get("company")):null;const t=k("company-name");t&&(t.textContent=v||p||"å…¨ä¼šç¤¾"),oe(),await P(),await C(),await G(),"undefined"!=typeof window&&(window.ApplicantsManager={loadApplicantsData:G,applyFilters:K,exportCsv:ie,showSection:M})}async function de(e,t,n=""){p=e,v=t,D=n,oe(),await P(),await C(),await G()}function ue(){return y&&m.find(e=>e.id===y)||null}export{i as a,d as b,o as c,l as d,a as e,r as f,c as g,ue as h,de as i,re as j,s as r};
