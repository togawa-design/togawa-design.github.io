function initSearchTabs(){const e=document.querySelectorAll(".search-card"),n=document.querySelectorAll(".search-panel");e.forEach(t=>{t.addEventListener("click",function(){const t=this.dataset.method;e.forEach(e=>e.classList.remove("active")),n.forEach(e=>e.classList.remove("active")),this.classList.add("active");const o=document.getElementById("panel-"+t);o&&o.classList.add("active"),"location"===t&&showLocationModal(),"consult"===t&&showConsultModal()})})}async function showLocationModal(){const e=document.querySelector(".location-modal");e&&e.remove();const n=document.createElement("div");n.className="location-modal",n.innerHTML='\n    <div class="location-modal-overlay"></div>\n    <div class="location-modal-content">\n      <button class="location-modal-close">&times;</button>\n      <h3>勤務地から探す</h3>\n      <p>働きたいエリアを選択してください</p>\n      <div class="location-list">\n        <div class="location-loading">\n          <div class="loading-spinner"></div>\n          <span>勤務地を読み込み中...</span>\n        </div>\n      </div>\n    </div>\n  ',document.body.appendChild(n),requestAnimationFrame(()=>{n.classList.add("active")});const t=()=>{n.classList.remove("active"),setTimeout(()=>n.remove(),300)};n.querySelector(".location-modal-close").addEventListener("click",t),n.querySelector(".location-modal-overlay").addEventListener("click",t);try{const e=await JobsLoader.getLocationList(),o=n.querySelector(".location-list");if(0===e.length)return void(o.innerHTML='<p class="no-data">勤務地データがありません</p>');o.innerHTML=e.map(e=>`\n      <a href="location.html?prefecture=${encodeURIComponent(e.prefecture)}" class="location-item" data-prefecture="${e.prefecture}">\n        <span class="location-name">${e.prefecture}</span>\n        <span class="location-count">${e.count}件</span>\n      </a>\n    `).join(""),o.querySelectorAll(".location-item").forEach(e=>{e.addEventListener("click",n=>{n.preventDefault();const o=e.dataset.prefecture;t(),window.location.href=`location.html?prefecture=${encodeURIComponent(o)}`})})}catch(e){console.error("勤務地の取得エラー:",e),n.querySelector(".location-list").innerHTML='<p class="error">勤務地の取得に失敗しました</p>'}}function showConsultModal(){const e=document.querySelector(".consult-modal");e&&e.remove();const n=document.createElement("div");n.className="consult-modal",n.innerHTML='\n    <div class="consult-modal-overlay"></div>\n    <div class="consult-modal-content">\n      <button class="consult-modal-close">&times;</button>\n      <h3>無料相談</h3>\n      <p>専門スタッフがあなたにぴったりの求人をご提案します</p>\n      <div class="consult-options">\n        <a href="#" class="consult-option line">\n          <span class="icon">LINE</span>\n          <span>LINEで相談</span>\n        </a>\n        <a href="#" class="consult-option tel">\n          <span class="icon">TEL</span>\n          <span>電話で相談</span>\n        </a>\n        <a href="#" class="consult-option form">\n          <span class="icon">FORM</span>\n          <span>フォームで相談</span>\n        </a>\n      </div>\n    </div>\n  ',document.body.appendChild(n),requestAnimationFrame(()=>{n.classList.add("active")}),n.querySelector(".consult-modal-close").addEventListener("click",()=>{n.classList.remove("active"),setTimeout(()=>n.remove(),300)}),n.querySelector(".consult-modal-overlay").addEventListener("click",()=>{n.classList.remove("active"),setTimeout(()=>n.remove(),300)})}function initMobileMenu(){const e=document.querySelector(".mobile-menu-btn");if(!e)return;const n=document.createElement("nav");n.className="mobile-nav",n.innerHTML='\n    <ul>\n      <li><a href="#jobs">お仕事紹介</a></li>\n      <li><a href="#content">コンテンツ</a></li>\n      <li><a href="#about">当サイトについて</a></li>\n      <li><a href="#contact">お問い合わせ</a></li>\n      <li><a href="admin.html">管理者</a></li>\n    </ul>\n  ',document.querySelector(".header").after(n),e.addEventListener("click",function(){this.classList.toggle("active"),n.classList.toggle("active")}),n.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{e.classList.remove("active"),n.classList.remove("active")})})}function initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const n=this.getAttribute("href");if("#"===n)return;const t=document.querySelector(n);if(t){e.preventDefault();const n=document.querySelector(".header").offsetHeight,o=t.getBoundingClientRect().top+window.pageYOffset-n;window.scrollTo({top:o,behavior:"smooth"})}})})}function initHeaderScroll(){const e=document.querySelector(".header");window.addEventListener("scroll",()=>{window.scrollY>100?e.classList.add("scrolled"):e.classList.remove("scrolled")})}function animateNumbers(){const e=document.querySelectorAll(".stat-number"),n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target,o=parseInt(t.textContent.replace(/,/g,""));animateNumber(t,o),n.unobserve(t)}})},{threshold:.5});e.forEach(e=>n.observe(e))}function animateNumber(e,n){const t=performance.now();requestAnimationFrame(function o(a){const c=a-t,s=Math.min(c/2e3,1),i=1-Math.pow(1-s,3),l=Math.floor(0+(n-0)*i);e.textContent=l.toLocaleString(),s<1&&requestAnimationFrame(o)})}document.addEventListener("DOMContentLoaded",function(){initSearchTabs(),initMobileMenu(),initSmoothScroll(),initHeaderScroll()}),window.addEventListener("load",animateNumbers);