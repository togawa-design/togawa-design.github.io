const RikuekoUtils={escapeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML},sanitizeHtml(e,t=["b","strong","i","em","u","ul","ol","li","br","div","p"]){if(!e||"<br>"===e||"<div><br></div>"===e)return"";const n=document.createElement("div");n.innerHTML=e;return n.querySelectorAll("*").forEach(e=>{if(t.includes(e.tagName.toLowerCase()))for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);else e.replaceWith(...e.childNodes)}),n.innerHTML},nl2br(e){return e?this.escapeHtml(e).replace(/\n/g,"<br>"):""},getUrlParam:(e,t=null)=>new URLSearchParams(window.location.search).get(e)??t,setUrlParam(e,t){const n=new URL(window.location.href);t?n.searchParams.set(e,t):n.searchParams.delete(e),window.history.pushState({},"",n.toString())},removeUrlParam(e){this.setUrlParam(e,null)},hasUrlParam:e=>new URLSearchParams(window.location.search).has(e),waitForGlobal:(e,t=5e3,n=50)=>new Promise((r,o)=>{if(void 0!==window[e])return void r(window[e]);const a=Date.now(),s=setInterval(()=>{void 0!==window[e]?(clearInterval(s),r(window[e])):Date.now()-a>t&&(clearInterval(s),o(new Error(`Timeout waiting for ${e}`)))},n)}),async waitForJobsLoader(e=1e4){return void 0!==window.JobsLoader?window.JobsLoader:this.waitForGlobal("JobsLoader",e,100)},waitUntil:(e,t=5e3,n=50)=>new Promise((r,o)=>{if(e())return void r();const a=Date.now(),s=setInterval(()=>{e()?(clearInterval(s),r()):Date.now()-a>t&&(clearInterval(s),o(new Error("Timeout waiting for condition")))},n)}),createLoadingHtml(e="読み込んでいます...",t="しばらくお待ちください"){return`\n      <div class="loading-container">\n        <div class="loading-inner">\n          <div class="loading-spinner large"></div>\n          <p class="loading-text">${this.escapeHtml(e)}</p>\n          ${t?`<p class="loading-subtext">${this.escapeHtml(t)}</p>`:""}\n        </div>\n      </div>\n    `},showLoading(e,t,n){const r="string"==typeof e?document.getElementById(e):e;r&&(r.innerHTML=this.createLoadingHtml(t,n))},createErrorHtml(e,t="トップページへ戻る",n="/"){return`\n      <div class="error-container">\n        <p class="error-message">${this.escapeHtml(e)}</p>\n        <a href="${this.escapeHtml(n)}" class="btn-back">${this.escapeHtml(t)}</a>\n      </div>\n    `},showError(e,t,n,r){const o="string"==typeof e?document.getElementById(e):e;o&&(o.innerHTML=this.createErrorHtml(t,n,r))},showModal({className:e="modal",title:t="",content:n="",onClose:r=null}){this.closeModal(e);const o=document.createElement("div");o.className=e,o.innerHTML=`\n      <div class="${e}-overlay"></div>\n      <div class="${e}-content">\n        <button class="${e}-close">&times;</button>\n        ${t?`<h3>${this.escapeHtml(t)}</h3>`:""}\n        <div class="${e}-body">${n}</div>\n      </div>\n    `,document.body.appendChild(o),requestAnimationFrame(()=>{o.classList.add("active")});const a=()=>{o.classList.remove("active"),setTimeout(()=>{o.remove(),r&&r()},300)};o.querySelector(`.${e}-close`).addEventListener("click",a),o.querySelector(`.${e}-overlay`).addEventListener("click",a);const s=e=>{"Escape"===e.key&&(a(),document.removeEventListener("keydown",s))};return document.addEventListener("keydown",s),o},closeModal(e="modal"){const t=document.querySelector(`.${e}`);t&&(t.classList.remove("active"),setTimeout(()=>t.remove(),300))},parseDate(e){if(!e)return null;const t=e.trim().replace(/\//g,"-"),n=new Date(t);return isNaN(n.getTime())?null:(n.setHours(0,0,0,0),n)},formatDate(e,t="YYYY-MM-DD"){const n="string"==typeof e?this.parseDate(e):e;if(!n)return"";const r=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0");return t.replace("YYYY",r).replace("MM",o).replace("DD",a)},getToday(){const e=new Date;return e.setHours(0,0,0,0),e},trackEvent(e,t={}){const n="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||this.hasUrlParam("debug_mode");n&&console.log("[Analytics]",e,t),"function"==typeof gtag?(gtag("event",e,t),n&&console.log("[Analytics] gtag sent successfully")):n&&console.warn("[Analytics] gtag is not defined, event not sent:",e)},trackPageView(e,t={}){this.trackEvent("page_view",{page_name:e,page_location:window.location.href,page_title:document.title,...t})},getStorage(e,t=null){try{const n=localStorage.getItem(e);return n?JSON.parse(n):t}catch(e){return t}},setStorage(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("Failed to save to localStorage:",e)}},getSession(e,t=null){try{const n=sessionStorage.getItem(e);return n?JSON.parse(n):t}catch(e){return t}},setSession(e,t){try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("Failed to save to sessionStorage:",e)}},formatNumber:e=>e||0===e?Number(e).toLocaleString():"",parseSalary(e){if(!e)return 0;const t=e.match(/(\d+(?:\.\d+)?)\s*万/);if(t)return 1e4*parseFloat(t[1]);const n=e.match(/(\d{1,3}(?:,\d{3})*)\s*円/);if(n)return parseInt(n[1].replace(/,/g,""));const r=e.match(/[¥￥]\s*(\d{1,3}(?:,\d{3})*|\d+)/);if(r)return parseInt(r[1].replace(/,/g,""));const o=e.match(/(\d{1,3}(?:,\d{3})*|\d+)/);return o?parseInt(o[1].replace(/,/g,"")):0},truncate:(e,t=100,n="...")=>!e||e.length<=t?e||"":e.substring(0,t)+n,unique(e,t=null){if(t){const n=new Set;return e.filter(e=>{const r=e[t];return!n.has(r)&&(n.add(r),!0)})}return[...new Set(e)]},debounce(e,t=300){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...r)},t)}},throttle(e,t=300){let n;return function(...r){n||(e(...r),n=!0,setTimeout(()=>n=!1,t))}},scrollTo(e,t=0){const n="string"==typeof e?document.querySelector(e):e;if(!n)return;const r=n.getBoundingClientRect().top+window.pageYOffset-t;window.scrollTo({top:r,behavior:"smooth"})},initSmoothScroll(e=0){document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",n=>{const r=t.getAttribute("href");if("#"===r)return;const o=document.querySelector(r);o&&(n.preventDefault(),this.scrollTo(o,e))})})}};window.RikuekoUtils=RikuekoUtils,window.Utils=RikuekoUtils;