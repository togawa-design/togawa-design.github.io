# 採用プロセス分析機能 実装プラン

> 採用プロセスの健全性・効率性を可視化し、ボトルネックを特定する分析機能

---

## 目次

1. [概要](#概要)
2. [リードタイム分析](#リードタイム分析)
3. [歩留まり分析](#歩留まり分析)
4. [品質分析](#品質分析)
5. [アラート機能](#アラート機能)
6. [ダッシュボード設計](#ダッシュボード設計)
7. [データ設計](#データ設計)
8. [実装ステップ](#実装ステップ)

---

## 概要

### 目的

- 採用プロセスのどこに問題があるか特定する
- 対応の遅延を早期発見する
- 担当者のパフォーマンスを可視化する
- 採用効率を継続的に改善する

### 主要KPI

| KPI | 説明 | 目標値（参考） |
|-----|------|---------------|
| 初回レスポンス時間 | 応募→初回連絡 | 24時間以内 |
| 面談設定リードタイム | 応募→面談日確定 | 3日以内 |
| 選考リードタイム | 応募→結果確定 | 14日以内 |
| 最終歩留まり | 応募→入社 | 業種による |
| 内定承諾率 | 内定→入社 | 80%以上 |

---

## リードタイム分析

### 測定ポイント

```
応募
 │
 ├─ T1: 初回レスポンス時間
 │
初回連絡
 │
 ├─ T2: 面談調整時間
 │
面談日確定
 │
 ├─ T3: 面談待ち時間
 │
面談実施
 │
 ├─ T4: 選考判断時間
 │
結果通知（内定/不採用）
 │
 ├─ T5: 入社準備期間
 │
入社
```

### 各リードタイムの定義

| 指標 | 開始 | 終了 | 計算式 |
|------|------|------|--------|
| **T1: 初回レスポンス** | 応募日時 | 初回連絡日時 | `contactedAt - createdAt` |
| **T2: 面談調整** | 初回連絡 | 面談日確定 | `interviewScheduledAt - contactedAt` |
| **T3: 面談待ち** | 面談日確定 | 面談実施 | `interviewedAt - interviewScheduledAt` |
| **T4: 選考判断** | 面談実施 | 結果通知 | `decidedAt - interviewedAt` |
| **T5: 入社準備** | 内定 | 入社 | `joinedAt - decidedAt` |
| **総リードタイム** | 応募 | 入社 | `joinedAt - createdAt` |

### 分析ビュー

#### 1. サマリー（平均値）

```
┌─────────────────────────────────────────────────────────┐
│ 採用リードタイム分析                    期間: 過去30日   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  初回レスポンス    面談調整      面談待ち     選考判断   │
│  ┌─────────┐    ┌─────────┐   ┌─────────┐  ┌─────────┐ │
│  │  18時間  │ → │  2.5日   │ → │  4.2日   │ → │  1.8日   │ │
│  │  ✅ 良好 │    │  ✅ 良好 │   │  ⚠️ 要改善│  │  ✅ 良好 │ │
│  └─────────┘    └─────────┘   └─────────┘  └─────────┘ │
│                                                         │
│  総リードタイム（応募→入社）: 平均 12.3日               │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 2. 分布グラフ

```
初回レスポンス時間の分布

  60% │ ████████████
      │ ████████████
  40% │ ████████████  ████
      │ ████████████  ████
  20% │ ████████████  ████  ████
      │ ████████████  ████  ████  ████
   0% └──────────────────────────────────
       0-6h   6-12h  12-24h  24-48h  48h+

       ← 理想 ─────────────── 要改善 →
```

#### 3. 比較分析

| 比較軸 | 内容 |
|--------|------|
| 期間比較 | 先月 vs 今月のリードタイム変化 |
| 求人別 | どの求人の選考が長引いているか |
| 担当者別 | 誰の対応が早い/遅いか |
| 流入元別 | 広告経由 vs 自然流入で差があるか |

---

## 歩留まり分析（ファネル分析）

### ファネル可視化

```
┌─────────────────────────────────────────────────────────┐
│ 採用ファネル                           期間: 過去30日   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ████████████████████████████████████████  応募: 100人  │
│  ██████████████████████████████████       連絡済: 85人  │
│  │                                         (-15人 連絡不通)
│  ██████████████████████████               面談実施: 68人│
│  │                                         (-17人 辞退/日程合わず)
│  █████████████████                        内定: 42人    │
│  │                                         (-26人 不採用)
│  ████████████                             入社: 34人    │
│                                            (-8人 内定辞退)
│                                                         │
│  最終歩留まり: 34%                                       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 各ステップの転換率

| ステップ | 転換率 | 離脱理由 |
|---------|--------|---------|
| 応募→連絡済 | 85% | 連絡不通、重複応募 |
| 連絡済→面談実施 | 80% | 面談辞退、日程合わず |
| 面談実施→内定 | 62% | 不採用、保留 |
| 内定→入社 | 81% | 内定辞退、入社前辞退 |
| **全体** | **34%** | - |

### 離脱理由の分布

```
不採用理由の内訳

  スキル不足      ████████████████  40%
  経験不足        ████████████      30%
  勤務条件不一致  ████████          20%
  その他          ████              10%
```

```
辞退理由の内訳

  他社内定        ████████████████  45%
  条件合わず      ████████████      30%
  個人都合        ████████          20%
  連絡不通        ████              5%
```

---

## 品質分析

### 担当者別パフォーマンス

| 担当者 | 担当数 | 平均レスポンス | 採用率 | 内定承諾率 |
|--------|--------|---------------|--------|-----------|
| 田中 | 35人 | 12時間 | 38% | 85% |
| 佐藤 | 28人 | 24時間 | 32% | 78% |
| 鈴木 | 22人 | 36時間 | 28% | 72% |
| **平均** | - | 20時間 | 34% | 81% |

### スコアカード

```
┌─────────────────────────────────────────────────────────┐
│ 採用品質スコアカード                                     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  採用効率        候補者体験       選考品質              │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐            │
│  │   B+    │    │   A-    │    │   B     │            │
│  │  78点   │    │  85点   │    │  72点   │            │
│  └─────────┘    └─────────┘    └─────────┘            │
│                                                         │
│  採用効率: 応募→入社の転換率                            │
│  候補者体験: 平均レスポンス時間ベース                    │
│  選考品質: 入社後90日定着率（※将来実装）               │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## アラート機能

### アラート定義

| レベル | アラート名 | トリガー条件 | アクション |
|--------|-----------|-------------|-----------|
| 🔴 緊急 | 対応遅延 | 48時間以上「新規」のまま | 即時通知 |
| 🔴 緊急 | 長期放置 | 7日以上ステータス変更なし | 即時通知 |
| 🟡 警告 | 面談待ち滞留 | 5日以上「面接調整中」のまま | 日次サマリー |
| 🟡 警告 | 辞退率上昇 | 先週比で辞退率が20%以上増加 | 週次レポート |
| 🟡 警告 | 長期保留 | 14日以上「保留」のまま | 週次レポート |
| 🔵 情報 | レスポンス遅延傾向 | 平均レスポンス時間が目標を超過 | 週次レポート |

### アラート表示

```
┌─────────────────────────────────────────────────────────┐
│ ⚠️ 要対応アラート                                3件    │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 🔴 対応遅延: 山田太郎さん（製造スタッフ）               │
│    応募から52時間経過。早急に連絡してください。          │
│    [対応する] [詳細を見る]                              │
│                                                         │
│ 🔴 長期放置: 佐藤花子さん（物流スタッフ）               │
│    8日間ステータス変更なし。                            │
│    [対応する] [詳細を見る]                              │
│                                                         │
│ 🟡 面談待ち滞留: 3件                                    │
│    面接調整中のまま5日以上経過している応募があります。   │
│    [一覧を見る]                                         │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## ダッシュボード設計

### レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ 採用プロセス分析                                    [期間選択▼] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────┐│
│ │ 応募数       │ │ 採用数       │ │ 歩留まり     │ │ 平均     ││
│ │     125      │ │     42       │ │    34%       │ │ リード   ││
│ │  ▲ +15%     │ │  ▲ +8%      │ │  ▲ +2pt     │ │ タイム   ││
│ │  vs 先月    │ │  vs 先月    │ │  vs 先月    │ │ 12.3日   ││
│ └──────────────┘ └──────────────┘ └──────────────┘ └──────────┘│
│                                                                 │
│ ┌────────────────────────────┐ ┌────────────────────────────┐  │
│ │ 採用ファネル                │ │ リードタイム推移            │  │
│ │                            │ │                            │  │
│ │ ████████████████ 応募 125  │ │     ─●─ 初回レスポンス      │  │
│ │ ████████████     連絡 98   │ │     ─■─ 面談設定            │  │
│ │ ████████         面談 72   │ │     ─▲─ 選考判断            │  │
│ │ █████            内定 48   │ │                            │  │
│ │ ████             入社 42   │ │    [グラフ]                │  │
│ │                            │ │                            │  │
│ └────────────────────────────┘ └────────────────────────────┘  │
│                                                                 │
│ ┌────────────────────────────┐ ┌────────────────────────────┐  │
│ │ 担当者別パフォーマンス      │ │ 要対応アラート              │  │
│ │                            │ │                            │  │
│ │ 田中  ████████████ 38%     │ │ 🔴 対応遅延: 2件            │  │
│ │ 佐藤  ██████████   32%     │ │ 🟡 面談待ち滞留: 3件        │  │
│ │ 鈴木  ████████     28%     │ │ 🟡 長期保留: 1件            │  │
│ │                            │ │                            │  │
│ └────────────────────────────┘ └────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## データ設計

### 必要なフィールド追加

現在の `applications` コレクションに以下のタイムスタンプを追加:

```javascript
// applications/{applicationId}
{
  // 既存フィールド
  status: 'new' | 'contacted' | 'interviewing' | 'interviewed' | 'hired' | 'joined' | 'ng' | 'rejected' | 'withdrawn',
  createdAt: Timestamp,
  updatedAt: Timestamp,

  // 追加フィールド（リードタイム計算用）
  timestamps: {
    contactedAt: Timestamp | null,        // 初回連絡日時
    interviewScheduledAt: Timestamp | null, // 面談日確定日時
    interviewedAt: Timestamp | null,      // 面談実施日時
    decidedAt: Timestamp | null,          // 結果確定日時
    joinedAt: Timestamp | null            // 入社日時
  },

  // 離脱理由（不採用・辞退の場合）
  dropoffReason: {
    category: 'skill' | 'experience' | 'condition' | 'other_offer' | 'personal' | 'no_contact' | 'other',
    detail: string | null
  }
}
```

### 集計用コレクション

日次でバッチ処理してサマリーを保存:

```javascript
// analytics_recruitment/{companyDomain}/daily/{date}
{
  date: '2025-02-12',

  // 件数
  counts: {
    applications: 15,       // 新規応募数
    contacted: 12,          // 連絡済み数
    interviewed: 8,         // 面談実施数
    hired: 3,               // 内定数
    joined: 2,              // 入社数
    rejected: 4,            // 不採用数
    withdrawn: 1            // 辞退数
  },

  // 平均リードタイム（時間）
  avgLeadTimes: {
    toContact: 18.5,        // 初回レスポンス
    toSchedule: 52.3,       // 面談設定まで
    toInterview: 120.8,     // 面談実施まで
    toDecision: 168.2,      // 結果確定まで
    total: 295.6            // 入社まで
  },

  // 担当者別
  byAssignee: {
    'tanaka': { applications: 5, hired: 2, avgResponseTime: 12 },
    'sato': { applications: 4, hired: 1, avgResponseTime: 24 }
  },

  createdAt: Timestamp
}
```

---

## 実装ステップ

### Phase 1: 基本分析（MVP）

| タスク | 内容 |
|--------|------|
| 1-1 | `applications` コレクションに timestamps フィールド追加 |
| 1-2 | ステータス変更時に自動でタイムスタンプ記録 |
| 1-3 | リードタイム計算ユーティリティ関数作成 |
| 1-4 | サマリーカード表示（応募数、採用数、歩留まり、平均リードタイム） |
| 1-5 | 採用ファネル可視化 |

### Phase 2: 詳細分析

| タスク | 内容 |
|--------|------|
| 2-1 | リードタイム分布グラフ |
| 2-2 | 担当者別パフォーマンス表示 |
| 2-3 | 期間比較機能 |
| 2-4 | 求人別・流入元別フィルター |

### Phase 3: アラート・レポート

| タスク | 内容 |
|--------|------|
| 3-1 | アラート条件設定 |
| 3-2 | ダッシュボードにアラート表示 |
| 3-3 | 週次レポートメール送信（Cloud Scheduler） |
| 3-4 | 離脱理由分析 |

---

## 関連ファイル

### 既存ファイル（修正対象）

| ファイル | 変更内容 |
|----------|---------|
| `src/features/applicants/index.js` | ステータス変更時にタイムスタンプ記録 |
| `src/shared/firestore-service.js` | 集計クエリ追加 |
| `public/admin/sections/applicants.html` | ダッシュボード追加 |

### 新規ファイル

| ファイル | 内容 |
|----------|------|
| `src/features/admin/recruitment-analytics.js` | 採用分析モジュール |
| `src/shared/recruitment-metrics.js` | 指標計算ユーティリティ |

---

## 実装ステータス

### ✅ 完了済み

| 日付 | 内容 |
|------|------|
| 2026-02-12 | **採用管理タブ（基本実装）** |
| | - 詳細分析セクションに「採用管理」タブを追加（admin専用） |
| | - 対応アラート表示（48時間以上未対応の応募者を検出） |
| | - 採用ファネル可視化（応募→連絡済→面接→内定→入社） |
| | - リードタイム統計カード（初回レスポンス/面談設定/選考判断/全体） |
| | - 企業別採用状況テーブル |
| 2026-02-12 | **statusHistory自動記録（Phase 1完了）** |
| | - ステータス変更時に`statusHistory`配列へ自動追加 |
| | - 記録内容: `status`, `timestamp`, `previousStatus` |
| | - 対象関数: `changeStatus()`, `saveInterview()` |
| 2026-02-12 | **Phase 2: 分析機能拡張** |
| | - リードタイム分布グラフ（0-6h, 6-12h, 12-24h, 24-48h, 48h+） |
| | - 担当者別パフォーマンステーブル（担当数/平均レスポンス/採用率/承諾率） |
| 2026-02-12 | **Phase 2.5: 企業別ドリルダウン機能** |
| | - 企業別採用状況テーブルの行をクリック可能に |
| | - 企業別詳細ビュー（ファネル/リードタイム/分布/担当者） |
| | - 一覧⇔詳細の画面切り替え |

### 🚧 次のステップ

| Phase | タスク | 優先度 |
|-------|--------|--------|
| Phase 3 | アラートのリアルタイム通知 | 低 |
| Phase 3 | 週次レポートメール送信 | 低 |

### 実装ファイル

| ファイル | 変更内容 |
|----------|---------|
| `public/admin/sections/analytics-detail.html` | 採用管理タブHTML追加 |
| `src/features/admin/analytics.js` | タブ制御・データ読み込み・レンダリング関数追加 |
| `public/css/admin.css` | 採用管理タブ用スタイル追加 |
| `src/features/applicants/index.js` | `changeStatus()`, `saveInterview()`にstatusHistory記録追加 |

---

## 参考

- [採用KPIの考え方（参考記事）](https://www.hrbrain.jp/media/human-resources/recruitment-kpi)
- 業界平均値は企業規模・業種により大きく異なるため、自社トレンドとの比較が重要

---

*作成日: 2025-02-12*
*更新日: 2026-02-12*
