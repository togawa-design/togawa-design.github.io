import{f as e,i as n,a as t,b as o}from"./jobs-loader-CErzUEmq.js";const r="リクエコ求人ナビ",i="https://rikueko.com",a="リクエコ求人ナビ",c="https://rikueko.com";function s(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function l(e){return e?e.replace(/<[^>]*>/g,"").trim():""}function p(e){if(!e)return{prefecture:"",city:"",country:"JP"};const n=e.match(/^(.+?[都道府県])/),t=n?n[1]:"",o=e.match(/[都道府県](.+?[市区町村])/);return{prefecture:t,city:o?o[1]:e.replace(t,"").trim(),country:"JP"}}function u(e){if(!e)return{min:null,max:null,currency:"JPY",period:"MONTH"};const n=String(e);let t=0;const o=n.match(/(\d+(?:\.\d+)?)\s*万/);if(o)t=1e4*parseFloat(o[1]);else{const e=n.match(/(\d{1,3}(?:,\d{3})*|\d+)/);e&&(t=parseInt(e[1].replace(/,/g,"")))}return{min:t,max:t,currency:"JPY",period:"MONTH"}}function y(e){if(!e)return"FULL_TIME";return{"正社員":"FULL_TIME","フルタイム":"FULL_TIME","パート":"PART_TIME","パートタイム":"PART_TIME","アルバイト":"PART_TIME","契約社員":"CONTRACTOR","契約":"CONTRACTOR","派遣":"TEMPORARY","派遣社員":"TEMPORARY","インターン":"INTERN","期間工":"CONTRACTOR","期間従業員":"CONTRACTOR"}[e]||"FULL_TIME"}function m(e){return e.companyDomain&&e.id?`${i}/job-detail.html?company=${encodeURIComponent(e.companyDomain)}&job=${encodeURIComponent(e.id)}`:e.companyDomain?`${i}/lp.html?company=${encodeURIComponent(e.companyDomain)}`:i}function d(e){const n=(new Date).toISOString();let t=`<?xml version="1.0" encoding="UTF-8"?>\n<source>\n  <publisher>${s(a)}</publisher>\n  <publisherurl>${s(c)}</publisherurl>\n  <lastBuildDate>${n}</lastBuildDate>\n`;return e.forEach(e=>{if(!e.title)return;const n=p(e.location||e.companyAddress);u(e.monthlySalary);const o=m(e),r=l(e.jobDescription||e.description||"");t+=`\n  <job>\n    <title><![CDATA[${e.title}]]></title>\n    <date>${e.publishStartDate||(new Date).toISOString().split("T")[0]}</date>\n    <referencenumber>${s(e.id||"")}</referencenumber>\n    <url><![CDATA[${o}]]></url>\n    <company><![CDATA[${e.company||""}]]></company>\n    <city><![CDATA[${n.city}]]></city>\n    <state><![CDATA[${n.prefecture}]]></state>\n    <country>${n.country}</country>\n    <postalcode></postalcode>\n    <description><![CDATA[${r}]]></description>\n    <salary><![CDATA[${e.monthlySalary||""}]]></salary>\n    <jobtype>${y(e.employmentType)}</jobtype>\n    <category><![CDATA[${e.jobType||"製造・工場"}]]></category>\n    <experience><![CDATA[${e.requirements||"未経験歓迎"}]]></experience>\n  </job>`}),t+="\n</source>",t}function b(e){const n=e.map(e=>{if(!e.title)return null;const n=p(e.location||e.companyAddress),t=u(e.monthlySalary),o=m(e),i=l(e.jobDescription||e.description||e.title),a={"@context":"https://schema.org/","@type":"JobPosting",title:e.title,description:i,identifier:{"@type":"PropertyValue",name:e.company||r,value:e.id||""},datePosted:e.publishStartDate||(new Date).toISOString().split("T")[0],hiringOrganization:{"@type":"Organization",name:e.company||"",sameAs:o},jobLocation:{"@type":"Place",address:{"@type":"PostalAddress",addressLocality:n.city,addressRegion:n.prefecture,addressCountry:n.country}},employmentType:y(e.employmentType)};return t.min&&(a.baseSalary={"@type":"MonetaryAmount",currency:t.currency,value:{"@type":"QuantitativeValue",value:t.min,unitText:t.period}}),e.publishEndDate&&(a.validThrough=e.publishEndDate),a}).filter(Boolean);return JSON.stringify(n,null,2)}function h(e){const n=(new Date).toISOString();let t=`<?xml version="1.0" encoding="UTF-8"?>\n<jobs xmlns="http://www.jobbox.com/schema/jobs">\n  <publisher>${s(a)}</publisher>\n  <publisherUrl>${s(c)}</publisherUrl>\n  <lastUpdate>${n}</lastUpdate>\n`;return e.forEach(e=>{if(!e.title)return;const n=p(e.location||e.companyAddress),o=u(e.monthlySalary),r=m(e),i=l(e.jobDescription||e.description||"");t+=`\n  <job>\n    <id>${s(e.id||"")}</id>\n    <title><![CDATA[${e.title}]]></title>\n    <company><![CDATA[${e.company||""}]]></company>\n    <url><![CDATA[${r}]]></url>\n    <location>\n      <prefecture>${s(n.prefecture)}</prefecture>\n      <city>${s(n.city)}</city>\n      <country>${n.country}</country>\n    </location>\n    <description><![CDATA[${i}]]></description>\n    <salary>\n      <type>monthly</type>\n      <min>${o.min||""}</min>\n      <max>${o.max||""}</max>\n      <currency>${o.currency}</currency>\n      <text><![CDATA[${e.monthlySalary||""}]]></text>\n    </salary>\n    <employmentType>${s(e.employmentType||"正社員")}</employmentType>\n    <requirements><![CDATA[${e.requirements||""}]]></requirements>\n    <benefits><![CDATA[${e.benefits||""}]]></benefits>\n    <workingHours><![CDATA[${e.workingHours||""}]]></workingHours>\n    <holidays><![CDATA[${e.holidays||""}]]></holidays>\n    <datePosted>${e.publishStartDate||(new Date).toISOString().split("T")[0]}</datePosted>\n    <validThrough>${e.publishEndDate||""}</validThrough>\n  </job>`}),t+="\n</jobs>",t}function f(e){const n=e=>{if(null==e)return"";const n=String(e).replace(/"/g,'""');return n.includes(",")||n.includes('"')||n.includes("\n")?`"${n}"`:n};let t=["id","タイトル","会社名","勤務地","都道府県","市区町村","月収","特典総額","雇用形態","仕事内容","応募資格","待遇","勤務時間","休日","掲載開始日","掲載終了日","URL"].join(",")+"\n";return e.forEach(e=>{const o=p(e.location||e.companyAddress),r=m(e),i=[e.id||"",e.title||"",e.company||"",e.location||e.companyAddress||"",o.prefecture,o.city,e.monthlySalary||"",e.totalBonus||"",e.employmentType||"",l(e.jobDescription||""),e.requirements||"",e.benefits||"",e.workingHours||"",e.holidays||"",e.publishStartDate||"",e.publishEndDate||"",r];t+=i.map(n).join(",")+"\n"}),t}async function T(){try{const r=await e();if(!r)throw new Error("会社一覧の取得に失敗しました");const i=[];for(const e of r){if(!n(e))continue;const r=await t(e.jobsSheet);r&&r.forEach(n=>{"false"!==n.visible&&"FALSE"!==n.visible&&o(n)&&(n.company=e.company,n.companyDomain=e.companyDomain,n.companyAddress=n.location||e.companyAddress||"",i.push(n))})}return console.log(`[JobFeedGenerator] ${i.length}件の求人を取得しました`),{jobs:i,indeedXml:d(i),googleJsonLd:b(i),jobBoxXml:h(i),csv:f(i)}}catch(r){throw console.error("[JobFeedGenerator] フィード生成エラー:",r),r}}function A(e,n,t){const o=new Blob([e],{type:t}),r=URL.createObjectURL(o),i=document.createElement("a");i.href=r,i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}async function $(){A((await T()).indeedXml,"indeed-feed.xml","application/xml")}async function g(){A((await T()).googleJsonLd,"google-jobs.json","application/json")}async function D(){A((await T()).jobBoxXml,"jobbox-feed.xml","application/xml")}async function j(){A((await T()).csv,"jobs-feed.csv","text/csv;charset=utf-8")}export{g as a,D as b,j as c,$ as d,A as e,b as f,d as g,h,f as i};
