import{e}from"./utils-BE8OECDH.js";import{e as n,f as t,i as o,a,b as s,g as c,h as l,c as r}from"./jobs-loader-CErzUEmq.js";import{L as i,J as d,b as u}from"./index-BCF2U2NH.js";function m(){const e=document.querySelectorAll(".search-card"),n=document.querySelectorAll(".search-panel");e.forEach(t=>{t.addEventListener("click",function(){const t=this.dataset.method;e.forEach(e=>e.classList.remove("active")),n.forEach(e=>e.classList.remove("active")),this.classList.add("active");const o=document.getElementById("panel-"+t);o&&o.classList.add("active"),"location"===t&&async function(){const e=document.querySelector(".location-modal");e&&e.remove();const n=document.createElement("div");n.className="location-modal",n.innerHTML=`\n    <div class="location-modal-overlay"></div>\n    <div class="location-modal-content">\n      <button class="location-modal-close">&times;</button>\n      <h3>勤務地から探す</h3>\n      <p>働きたいエリアを選択してください</p>\n      <div class="location-list">\n        ${i({message:"勤務地を読み込み中..."})}\n      </div>\n    </div>\n  `,document.body.appendChild(n),requestAnimationFrame(()=>{n.classList.add("active")});const t=()=>{n.classList.remove("active"),setTimeout(()=>n.remove(),300)};n.querySelector(".location-modal-close").addEventListener("click",t),n.querySelector(".location-modal-overlay").addEventListener("click",t);try{const e=await r(),o=n.querySelector(".location-list");if(0===e.length)return void(o.innerHTML='<p class="no-data">勤務地データがありません</p>');o.innerHTML=e.map(e=>u({location:e})).join(""),o.querySelectorAll(".location-item").forEach(e=>{e.addEventListener("click",n=>{n.preventDefault();const o=e.dataset.prefecture;t(),window.location.href=`location.html?prefecture=${encodeURIComponent(o)}`})})}catch(o){console.error("勤務地の取得エラー:",o),n.querySelector(".location-list").innerHTML='<p class="error">勤務地の取得に失敗しました</p>'}}(),"consult"===t&&function(){const e=document.querySelector(".consult-modal");e&&e.remove();const n=document.createElement("div");n.className="consult-modal",n.innerHTML='\n    <div class="consult-modal-overlay"></div>\n    <div class="consult-modal-content">\n      <button class="consult-modal-close">&times;</button>\n      <h3>無料相談</h3>\n      <p>専門スタッフがあなたにぴったりの求人をご提案します</p>\n      <div class="consult-options">\n        <a href="#" class="consult-option line">\n          <span class="icon">LINE</span>\n          <span>LINEで相談</span>\n        </a>\n        <a href="#" class="consult-option tel">\n          <span class="icon">TEL</span>\n          <span>電話で相談</span>\n        </a>\n        <a href="#" class="consult-option form">\n          <span class="icon">FORM</span>\n          <span>フォームで相談</span>\n        </a>\n      </div>\n    </div>\n  ',document.body.appendChild(n),requestAnimationFrame(()=>{n.classList.add("active")});const t=()=>{n.classList.remove("active"),setTimeout(()=>n.remove(),300)};n.querySelector(".consult-modal-close").addEventListener("click",t),n.querySelector(".consult-modal-overlay").addEventListener("click",t)}()})})}function f(){const e=document.querySelector(".mobile-menu-btn");if(!e)return;if(document.querySelector(".mobile-nav"))return;const n=document.createElement("nav");n.className="mobile-nav",n.innerHTML='\n    <ul>\n      <li><a href="#jobs">お仕事紹介</a></li>\n      <li><a href="#content">コンテンツ</a></li>\n      <li><a href="#about">当サイトについて</a></li>\n      <li><a href="#contact">お問い合わせ</a></li>\n      <li><a href="admin.html">管理者</a></li>\n    </ul>\n  ';const t=document.querySelector(".header");t&&t.after(n),e.addEventListener("click",function(){this.classList.toggle("active"),n.classList.toggle("active")}),n.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{e.classList.remove("active"),n.classList.remove("active")})})}function v(){const e=document.querySelectorAll(".stat-number"),n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target,o=parseInt(t.textContent.replace(/,/g,""));!function(e,n){const t=2e3,o=0,a=performance.now();function s(c){const l=c-a,r=Math.min(l/t,1),i=1-Math.pow(1-r,3),d=Math.floor(o+(n-o)*i);e.textContent=d.toLocaleString(),r<1&&requestAnimationFrame(s)}requestAnimationFrame(s)}(t,o),n.unobserve(t)}})},{threshold:.5});e.forEach(e=>n.observe(e))}function p(){m(),f(),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){var n;const t=this.getAttribute("href");if("#"===t)return;const o=document.querySelector(t);if(o){e.preventDefault();const t=(null==(n=document.querySelector(".header"))?void 0:n.offsetHeight)||0,a=o.getBoundingClientRect().top+window.pageYOffset-t;window.scrollTo({top:a,behavior:"smooth"})}})}),function(){const e=document.querySelector(".header");e&&window.addEventListener("scroll",()=>{window.scrollY>100?e.classList.add("scrolled"):e.classList.remove("scrolled")})}(),document.getElementById("jobs-container")&&async function(l="jobs-container"){const r=document.getElementById(l);if(!r)return;const u=new URLSearchParams(window.location.search).get("location");if(r.innerHTML=i({message:u?`${u}の求人を読み込んでいます...`:"求人情報を読み込んでいます..."}),u){const t=await n(u);if(!t||0===t.length)return void(r.innerHTML=`\n        <div class="jobs-error">\n          <p>${e(u)}の求人が見つかりませんでした。</p>\n          <a href="/" class="btn-more">すべての求人を見る</a>\n        </div>\n      `);const o=document.createElement("div");return o.className="location-filter-header",o.innerHTML=`\n      <div class="filter-info">\n        <span class="filter-label">${e(u)}の求人</span>\n        <span class="filter-count">${t.length}件</span>\n      </div>\n      <a href="/" class="btn-clear-filter">フィルターを解除</a>\n    `,r.before(o),void(r.innerHTML=t.map(e=>d({job:e,showCompanyName:!0})).join(""))}const m=await t();if(!m||0===m.length)return void(r.innerHTML='\n      <div class="jobs-error">\n        <p>求人情報を取得できませんでした。</p>\n        <button onclick="location.reload()">再読み込み</button>\n      </div>\n    ');const f=m.filter(e=>o(e)).sort((e,n)=>(parseInt(e.order)||999)-(parseInt(n.order)||999)),v=await Promise.all(f.map(async e=>{if(e._displayTotalBonus="",e._displayMonthlySalary=e.monthlySalary||"",e.jobsSheet&&e.jobsSheet.trim()){const n=await a(e.jobsSheet.trim());if(n&&n.length>0){const t=n.filter(e=>"false"!==e.visible&&"FALSE"!==e.visible).filter(e=>s(e)).sort((e,n)=>(parseInt(e.order)||999)-(parseInt(n.order)||999));if(t.length>0){const n=t[0];e._displayTotalBonus=n.totalBonus||"";const o=c(t);o&&(e._displayMonthlySalary=o)}}}return e}));r.innerHTML=v.map(e=>d({job:e})).join("")}(),document.querySelector(".hero-stats")&&async function(){const n=await l();if(!n)return;const t=document.querySelector(".hero-stats");if(!t)return;const o=Object.keys(n).map(t=>{const o=n[t];return`\n      <div class="stat-item">\n        <span class="stat-number">${e(o.value)}</span>\n        <span class="stat-label">${e(o.label)}</span>\n      </div>\n    `}).join("");t.innerHTML=o}(),document.getElementById("footer-locations")&&async function(){const n=document.getElementById("footer-locations");if(n)try{const t=(await r()).slice(0,4);if(0===t.length)return void(n.innerHTML='<li><a href="location.html">すべてのエリア</a></li>');n.innerHTML=t.map(n=>`<li><a href="location.html?prefecture=${encodeURIComponent(n.prefecture)}">${e(n.prefecture)}の求人</a></li>`).join("")+'<li><a href="location.html">すべてのエリア</a></li>'}catch(t){console.error("フッター勤務地の取得エラー:",t)}}(),window.addEventListener("load",v)}export{f as a,p as i};
