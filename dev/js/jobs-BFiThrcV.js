import"./modulepreload-polyfill-YP0FEG5d.js";import{escapeHtml as n,trackEvent as e}from"./utils-BB91om2o.js";import{b as o,g as s,c as a,d as t,f as i,i as r,e as l,h as c,j as d}from"./jobs-loader-DlRV3eH1.js";import{J as p}from"./index-GZIC2vd0.js";import{a as h}from"./index-D7gHjzbA.js";import{i as b}from"./layout-1YYuFAIg.js";async function j(n){try{const s=await i();if(!s||0===s.length)return void(n.innerHTML='\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">求人している会社一覧</h1>\n          <p class="jobs-page-description">現在、掲載中の求人はありません</p>\n        </div>\n        <div class="jobs-error">\n          <p>求人情報が見つかりませんでした。</p>\n          <a href="/" class="btn-more">トップページに戻る</a>\n        </div>\n      ');const a=s.filter(n=>r(n)).sort((n,e)=>(parseInt(n.order)||999)-(parseInt(e.order)||999));if(0===a.length)return void(n.innerHTML='\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">求人している会社一覧</h1>\n          <p class="jobs-page-description">現在、掲載中の求人はありません</p>\n        </div>\n        <div class="jobs-error">\n          <p>求人情報が見つかりませんでした。</p>\n          <a href="/" class="btn-more">トップページに戻る</a>\n        </div>\n      ');const d=await Promise.all(a.map(async n=>{if(n._displayMonthlySalary=n.monthlySalary||"",n.jobsSheet&&n.jobsSheet.trim()){const e=await l(n.jobsSheet.trim());if(e&&e.length>0){const o=e.filter(n=>"false"!==n.visible&&"FALSE"!==n.visible).filter(n=>t(n)).sort((n,e)=>(parseInt(n.order)||999)-(parseInt(e.order)||999));if(o.length>0){const e=c(o);e&&(n._displayMonthlySalary=e)}}}return n}));n.innerHTML=`\n      <div class="jobs-page-header">\n        <h1 class="jobs-page-title">求人している会社一覧</h1>\n        <p class="jobs-page-description">${d.length}社の会社が見つかりました</p>\n      </div>\n      <div class="jobs-grid jobs-page-grid">\n        ${d.map(n=>p({job:n,linkToJobsList:!0})).join("")}\n      </div>\n    `,o=d.length,e("view_jobs_page",{job_count:o,page_location:window.location.href,page_title:document.title})}catch(s){console.error("求人の取得エラー:",s),n.innerHTML='\n      <div class="jobs-error">\n        <p>データの取得に失敗しました。</p>\n        <button onclick="location.reload()">再読み込み</button>\n      </div>\n    '}var o}async function m(o,i,r){try{let l=[],c="";if("keyword"===i?(l=await s(r),c=`「${r}」の検索結果`):"occupation"===i&&(l=await a(r),c=`職種「${r}」の検索結果`),l=l.filter(n=>"false"!==n.visible&&"FALSE"!==n.visible&&t(n)),0===l.length)return void(o.innerHTML=`\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">${n(c)}</h1>\n          <p class="jobs-page-description">該当する求人が見つかりませんでした</p>\n        </div>\n        <div class="jobs-error">\n          <p>条件に一致する求人はありません。</p>\n          <a href="jobs.html" class="btn-more">すべての求人を見る</a>\n        </div>\n      `);o.innerHTML=`\n      <div class="jobs-page-header">\n        <h1 class="jobs-page-title">${n(c)}</h1>\n        <p class="jobs-page-description">${l.length}件の求人が見つかりました</p>\n        <a href="jobs.html" class="filter-clear-link">フィルターを解除</a>\n      </div>\n      <div class="jobs-grid jobs-page-grid">\n        ${l.map(n=>p({job:n,showCompanyName:!0})).join("")}\n      </div>\n    `,e("view_filtered_jobs",{filter_type:i,filter_value:r,result_count:l.length})}catch(l){console.error("フィルタリング求人の取得エラー:",l),o.innerHTML='\n      <div class="jobs-error">\n        <p>データの取得に失敗しました。</p>\n        <button onclick="location.reload()">再読み込み</button>\n      </div>\n    '}}async function g(){const e=document.getElementById("jobs-page-container");if(!e)return;await o();const s=new URLSearchParams(window.location.search),a=s.get("keyword"),t=s.get("occupation");a?await m(e,"keyword",a):t?await m(e,"occupation",t):await j(e),await async function(){const e=document.getElementById("jobs-locations-container");if(e)try{const o=await d();if(!o||0===o.length){const n=document.getElementById("jobs-locations");return void(n&&(n.style.display="none"))}const s=o.slice(0,8);e.innerHTML=`\n      <div class="other-locations-grid">\n        ${s.map(e=>`\n          <a href="location.html?prefecture=${encodeURIComponent(e.prefecture)}" class="other-location-card">\n            <span class="other-location-name">${n(e.prefecture)}</span>\n            <span class="other-location-count">${e.count}件の求人</span>\n          </a>\n        `).join("")}\n      </div>\n      <div class="other-locations-more">\n        <a href="location.html" class="btn-more">すべてのエリアを見る</a>\n      </div>\n    `}catch(o){console.error("勤務地リストの取得エラー:",o),e.innerHTML="<p>データの取得に失敗しました</p>"}}(),h(),b()}document.addEventListener("DOMContentLoaded",()=>{g()});
