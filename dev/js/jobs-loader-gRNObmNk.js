const t="1NVIDV3OiXbNrVI7EFdRrU2Ggn8dx7Q0rSnvJ6uaWvX0",e="会社一覧",n="Stats",o="images/default-job.svg",s=()=>`https://docs.google.com/spreadsheets/d/${t}/gviz/tq?tqx=out:csv&sheet=${e}`,r=()=>`https://docs.google.com/spreadsheets/d/${t}/gviz/tq?tqx=out:csv&sheet=${n}`;function a(t){const e=[];let n="",o=!1;for(let s=0;s<t.length;s++){const r=t[s];'"'===r?o&&'"'===t[s+1]?(n+='"',s++):o=!o:","!==r||o?n+=r:(e.push(n.trim()),n="")}return e.push(n.trim()),e}function i(t){const e={id:"id",ID:"id","求人ID":"jobId",jobId:"jobId",job_id:"jobId","会社名":"company",company:"company","タイトル":"title",title:"title","勤務地":"location",location:"location","特典総額":"totalBonus",totalBonus:"totalBonus","月収例":"monthlySalary",monthlySalary:"monthlySalary","特徴":"features",features:"features","バッジ":"badges",badges:"badges","画像URL":"imageUrl",imageUrl:"imageUrl","詳細URL":"detailUrl",detailUrl:"detailUrl","表示":"visible",visible:"visible","表示する":"showCompany","並び順":"order",order:"order","会社ドメイン":"companyDomain",companyDomain:"companyDomain",company_domain:"companyDomain","会社住所":"companyAddress",companyAddress:"companyAddress","説明":"description",description:"description","お仕事内容":"jobContent",jobContent:"jobContent","仕事内容":"jobDescription",jobDescription:"jobDescription","応募資格":"requirements",requirements:"requirements","待遇":"benefits",benefits:"benefits","勤務時間":"workingHours",workingHours:"workingHours","休日":"holidays",holidays:"holidays","デザインパターン":"designPattern",designPattern:"designPattern",design_pattern:"designPattern","パターン":"designPattern",pattern:"designPattern","管理シート":"jobsSheet",jobsSheet:"jobsSheet",jobs_sheet:"jobsSheet","管理シートURL":"manageSheetUrl",manageSheetUrl:"manageSheetUrl","求人管理シートURL":"manageSheetUrl","掲載開始日":"publishStartDate",publishStartDate:"publishStartDate",publish_start_date:"publishStartDate","掲載終了日":"publishEndDate",publishEndDate:"publishEndDate",publish_end_date:"publishEndDate","職種名":"jobType","職種":"jobType",jobType:"jobType",job_type:"jobType","給与":"salary",salary:"salary","雇用形態":"employmentType",employmentType:"employmentType",employment_type:"employmentType","資格・スキル":"skills",skills:"skills","資格":"skills","スキル":"skills","検索タグ":"tags",tags:"tags"},n=t.replace(/"/g,"").trim();if(e[n])return e[n];const o=n.split(/\s+/);return o.length>1&&e[o[0]]?e[o[0]]:o[0]||n}function c(t,e=0,n=1){const o=t.split("\n"),s=a(o[e]||""),r=[];for(let c=n;c<o.length;c++){if(!o[c].trim())continue;const t=a(o[c]),e={};s.forEach((n,o)=>{const s=i(n);e[s]=t[o]||""}),e.features?e.features=e.features.split(",").map(t=>t.trim()).filter(t=>t):e.features=[],e.tags?(e.tags=e.tags.split(",").map(t=>t.trim()).filter(t=>t),e.features=[...new Set([...e.features,...e.tags])]):e.tags=[],r.push(e)}return r}function l(t){const e=t.match(/\/spreadsheets\/d\/([a-zA-Z0-9_-]+)/);return e?e[1]:/^[a-zA-Z0-9_-]+$/.test(t)?t:null}async function u(){try{const t=await fetch(s());if(!t.ok)throw new Error("会社一覧の取得に失敗しました");return c(await t.text())}catch(t){return console.error("会社一覧の取得エラー:",t),null}}async function p(t){var e;if(!t)return null;try{const n=l(t.trim());if(!n)return null;const o=`https://docs.google.com/spreadsheets/d/${n}/gviz/tq?tqx=out:csv`,s=await fetch(o);if(!s.ok)throw new Error("求人データの取得に失敗しました");const r=await s.text(),a=(null==(e=r.split("\n")[0])?void 0:e.split(",")[0])||"",i=a.includes(" ")&&!a.startsWith('"管理');return c(r,0,i?1:2)}catch(n){return console.error("求人データの取得エラー:",n),null}}function m(t){return!(!t.jobsSheet||!t.jobsSheet.trim())&&("○"===t.showCompany||"◯"===t.showCompany)}function d(t){if(!t)return null;const e=t.trim().replace(/\//g,"-"),n=new Date(e);return isNaN(n.getTime())?null:(n.setHours(0,0,0,0),n)}function h(t){const e=new Date;if(e.setHours(0,0,0,0),t.publishStartDate&&t.publishStartDate.trim()){const n=d(t.publishStartDate);if(n&&e<n)return!1}if(t.publishEndDate&&t.publishEndDate.trim()){const n=d(t.publishEndDate);if(n&&e>n)return!1}return!0}function f(t){let e=0,n="";return t.forEach(t=>{if(!t.monthlySalary)return;const o=t.monthlySalary;let s=0;const r=o.match(/(\d+(?:\.\d+)?)\s*万/);if(r)s=1e4*parseFloat(r[1]);else{const t=o.match(/(\d{1,3}(?:,\d{3})*)\s*円/);if(t)s=parseInt(t[1].replace(/,/g,""));else{const t=o.match(/[¥￥]\s*(\d{1,3}(?:,\d{3})*|\d+)/);if(t)s=parseInt(t[1].replace(/,/g,""));else{const t=o.match(/(\d{1,3}(?:,\d{3})*|\d+)/);t&&(s=parseInt(t[1].replace(/,/g,"")))}}}s>e&&(e=s,n=o)}),n}async function b(){var t;const e=await u();if(!e)return[];const n=[];for(const o of e){if(!m(o))continue;const e=null==(t=o.jobsSheet)?void 0:t.trim();if(!e)continue;const s=await p(e);s&&s.forEach(t=>{t.company=o.company,t.companyDomain=o.companyDomain,n.push(t)})}return n}async function y(){const t=await b(),e={};return t.forEach(t=>{const n=t.companyAddress||t.location;if(!n)return;const o=n.match(/^(.+?[都道府県])/),s=o?o[1]:n;e[s]||(e[s]={prefecture:s,jobs:[],count:0}),e[s].jobs.push(t),e[s].count++}),Object.values(e).sort((t,e)=>e.count-t.count)}async function g(t){return(await b()).filter(e=>{const n=e.companyAddress||e.location;return n&&n.includes(t)})}async function D(t){const e=await b(),n=t.toLowerCase();return e.filter(t=>[t.title,t.company,t.jobContent,t.jobDescription,t.description,t.benefits,t.requirements,t.companyAddress,t.location,t.jobType,...t.features||[],...t.tags||[]].some(t=>t&&t.toLowerCase().includes(n)))}async function w(t){const e=await b(),n=t.toLowerCase();return e.filter(t=>[t.title,t.jobType,t.jobContent,t.jobDescription,...t.features||[],...t.tags||[]].some(t=>t&&t.toLowerCase().includes(n)))}async function S(){try{const t=await fetch(r());if(!t.ok)throw new Error("実績データの取得に失敗しました");return function(t){const e=t.split("\n"),n={};for(let o=1;o<e.length;o++){if(!e[o].trim())continue;const t=a(e[o]),s=t[0]?t[0].replace(/"/g,"").trim():"",r=t[1]?t[1].replace(/"/g,"").trim():"",i=t[2]?t[2].replace(/"/g,"").trim():"";s&&(n[s]={value:r,label:i})}return n}(await t.text())}catch(t){return console.error("実績データの取得エラー:",t),null}}function j(t){const e=t?t.toLowerCase().trim():"";return["modern","classic","minimal","colorful"].includes(e)?`pattern-${e}`:""}const E={SHEET_ID:t,SHEET_NAME:e,STATS_SHEET_NAME:n,DEFAULT_IMAGE:o,get csvUrl(){return s()},get statsUrl(){return r()},getSheetUrl:e=>`https://docs.google.com/spreadsheets/d/${t}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(e)}`,parseCSVLine:a,normalizeHeader:i,parseCSV:c,extractSpreadsheetId:l,fetchCompanies:u,fetchCompanyJobs:p,fetchJobs:u,isCompanyVisible:m,parseDate:d,isJobInPublishPeriod:h,getDetailUrl:function(t){return t.companyDomain&&t.companyDomain.trim()?`company.html?id=${encodeURIComponent(t.companyDomain.trim())}`:t.detailUrl||"#"},getMaxMonthlySalary:f,fetchAllJobs:b,getLocationList:y,getJobsByLocation:g,getJobsByKeyword:D,getJobsByOccupation:w,fetchStats:S,getDesignPatternClass:j,escapeHtml(t){if(!t)return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML},sanitizeHtml(t){if(!t||"<br>"===t||"<div><br></div>"===t)return"";const e=["b","strong","i","em","u","ul","ol","li","br","div","p"],n=document.createElement("div");n.innerHTML=t;return n.querySelectorAll("*").forEach(t=>{if(e.includes(t.tagName.toLowerCase()))for(;t.attributes.length>0;)t.removeAttribute(t.attributes[0].name);else t.replaceWith(...t.childNodes)}),n.innerHTML}};"undefined"!=typeof window&&(window.JobsLoader=E);export{o as D,E as J,w as a,h as b,p as c,f as d,y as e,u as f,D as g,j as h,m as i,g as j,S as k,a as p};
