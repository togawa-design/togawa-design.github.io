const e={cloudName:"dnvtqyhuw",uploadPreset:"rikueko_unsigned"};async function a(e,a={}){const{maxWidth:n=1200,maxHeight:l=1200,quality:t=.8,outputType:i="image/webp"}=a;return new Promise((a,o)=>{const r=new Image,s=document.createElement("canvas"),d=s.getContext("2d");r.onload=()=>{let{width:e,height:p}=r;e>n&&(p=p*n/e,e=n),p>l&&(e=e*l/p,p=l),s.width=e,s.height=p,d.drawImage(r,0,0,e,p),s.toBlob(e=>{e?a(e):o(new Error("ç”»åƒã®å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ"))},i,t)},r.onerror=()=>o(new Error("ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ")),r.src=URL.createObjectURL(e)})}async function n(e){return a(e,{maxWidth:1200,maxHeight:800,quality:.8,outputType:"image/webp"})}async function l(a,n,l=null){var t;const{cloudName:i,uploadPreset:o}=e,r=new FormData;r.append("file",a),r.append("upload_preset",o),r.append("folder",n),l&&r.append("public_id",l);const s=await fetch(`https://api.cloudinary.com/v1_1/${i}/image/upload`,{method:"POST",body:r});if(!s.ok){const e=await s.json();throw new Error((null==(t=e.error)?void 0:t.message)||"ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ")}return(await s.json()).secure_url}async function t(e,n){const t=await async function(e){return a(e,{maxWidth:400,maxHeight:400,quality:.85,outputType:"image/webp"})}(e),i=`companies/${n}`,o=await l(t,i,"logo");return console.log("[ImageUploader] Logo uploaded:",o),o}async function i(e,a){const t=await n(e),i=`companies/${a}/images`,o=await l(t,i);return console.log("[ImageUploader] Company image uploaded:",o),o}async function o(e,a){const t=await n(e),i=`lp/${a}`,o=await l(t,i);return console.log("[ImageUploader] LP image uploaded:",o),o}function r(e={}){const{id:a="image-uploader",label:n="ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",currentUrl:l="",onUpload:t=()=>{},uploadFn:i=null}=e,o=document.createElement("div");o.className="image-uploader",o.id=a,o.innerHTML=`\n    <label class="image-uploader-label">${n}</label>\n    <div class="image-uploader-area" data-drop-zone>\n      ${l?`<img src="${l}" alt="ç¾åœ¨ã®ç”»åƒ" class="image-uploader-preview">`:'<div class="image-uploader-placeholder">\n            <span class="upload-icon">ğŸ“·</span>\n            <p>ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</p>\n            <p class="upload-hint">PNG, JPG, WebP (æœ€å¤§5MB)</p>\n          </div>'}\n      <input type="file" accept="image/*" class="image-uploader-input" style="display: none;">\n      <div class="image-uploader-loading" style="display: none;">\n        <div class="loading-spinner"></div>\n        <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>\n      </div>\n    </div>\n    <input type="hidden" class="image-uploader-url" value="${l}">\n  `;const r=o.querySelector("[data-drop-zone]"),s=o.querySelector(".image-uploader-input"),d=o.querySelector(".image-uploader-loading"),p=o.querySelector(".image-uploader-url");var c,u;async function g(e){if(i){d.style.display="flex";try{const a=await i(e);p.value=a,r.innerHTML=`\n        <img src="${a}" alt="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿" class="image-uploader-preview">\n        <div class="image-uploader-loading" style="display: none;">\n          <div class="loading-spinner"></div>\n          <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>\n        </div>\n      `,t(a)}catch(a){console.error("[ImageUploader] Upload failed:",a),alert("ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ: "+a.message)}finally{d.style.display="none"}}else console.error("[ImageUploader] uploadFn is required")}return r.addEventListener("click",()=>{d.style.display&&"none"!==d.style.display||s.click()}),s.addEventListener("change",async e=>{const a=e.target.files[0];a&&await g(a)}),u=async e=>{e.length>0&&await g(e[0])},(c=r).addEventListener("dragover",e=>{e.preventDefault(),c.classList.add("drag-over")}),c.addEventListener("dragleave",e=>{e.preventDefault(),c.classList.remove("drag-over")}),c.addEventListener("drop",async e=>{e.preventDefault(),c.classList.remove("drag-over");const a=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/"));a.length>0&&u(a)}),o.getUrl=()=>p.value,o.setUrl=e=>{p.value=e,e&&(r.innerHTML=`\n        <img src="${e}" alt="ç¾åœ¨ã®ç”»åƒ" class="image-uploader-preview">\n        <div class="image-uploader-loading" style="display: none;">\n          <div class="loading-spinner"></div>\n          <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>\n        </div>\n      `)},o}export{i as a,o as b,r as c,t as u};
