import{e as n,t as o}from"./utils-C4oNoj7k.js";import{f as e,i as s,a as t,b as a,g as i,c as r}from"./jobs-loader-Cl5xPqcc.js";import{J as c}from"./index-CdesR8cu.js";import{a as l}from"./index-CJkjgS-5.js";async function d(n){try{const l=await e();if(!l||0===l.length)return void(n.innerHTML='\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">求人している会社一覧</h1>\n          <p class="jobs-page-description">現在、掲載中の求人はありません</p>\n        </div>\n        <div class="jobs-error">\n          <p>求人情報が見つかりませんでした。</p>\n          <a href="/" class="btn-more">トップページに戻る</a>\n        </div>\n      ');const d=l.filter(n=>s(n)).sort((n,o)=>(parseInt(n.order)||999)-(parseInt(o.order)||999));if(0===d.length)return void(n.innerHTML='\n        <div class="jobs-page-header">\n          <h1 class="jobs-page-title">求人している会社一覧</h1>\n          <p class="jobs-page-description">現在、掲載中の求人はありません</p>\n        </div>\n        <div class="jobs-error">\n          <p>求人情報が見つかりませんでした。</p>\n          <a href="/" class="btn-more">トップページに戻る</a>\n        </div>\n      ');const p=await Promise.all(d.map(async n=>{if(n._displayTotalBonus="",n._displayMonthlySalary=n.monthlySalary||"",n.jobsSheet&&n.jobsSheet.trim()){const o=await t(n.jobsSheet.trim());if(o&&o.length>0){const e=o.filter(n=>"false"!==n.visible&&"FALSE"!==n.visible).filter(n=>a(n)).sort((n,o)=>(parseInt(n.order)||999)-(parseInt(o.order)||999));if(e.length>0){const o=e[0];n._displayTotalBonus=o.totalBonus||"";const s=i(e);s&&(n._displayMonthlySalary=s)}}}return n}));n.innerHTML=`\n      <div class="jobs-page-header">\n        <h1 class="jobs-page-title">求人している会社一覧</h1>\n        <p class="jobs-page-description">${p.length}社の会社が見つかりました</p>\n      </div>\n      <div class="jobs-grid jobs-page-grid">\n        ${p.map(n=>c({job:n})).join("")}\n      </div>\n    `,r=p.length,o("view_jobs_page",{job_count:r,page_location:window.location.href,page_title:document.title})}catch(l){console.error("求人の取得エラー:",l),n.innerHTML='\n      <div class="jobs-error">\n        <p>データの取得に失敗しました。</p>\n        <button onclick="location.reload()">再読み込み</button>\n      </div>\n    '}var r}async function p(){const o=document.getElementById("jobs-page-container");o&&(await d(o),await async function(){const o=document.getElementById("jobs-locations-container");if(o)try{const e=await r();if(!e||0===e.length){const n=document.getElementById("jobs-locations");return void(n&&(n.style.display="none"))}const s=e.slice(0,8);o.innerHTML=`\n      <div class="other-locations-grid">\n        ${s.map(o=>`\n          <a href="location.html?prefecture=${encodeURIComponent(o.prefecture)}" class="other-location-card">\n            <span class="other-location-name">${n(o.prefecture)}</span>\n            <span class="other-location-count">${o.count}件の求人</span>\n          </a>\n        `).join("")}\n      </div>\n      <div class="other-locations-more">\n        <a href="location.html" class="btn-more">すべてのエリアを見る</a>\n      </div>\n    `}catch(e){console.error("勤務地リストの取得エラー:",e),o.innerHTML="<p>データの取得に失敗しました</p>"}}(),l())}document.addEventListener("DOMContentLoaded",()=>{p()});
