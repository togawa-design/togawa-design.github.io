import"./modulepreload-polyfill-YP0FEG5d.js";import{g as n,a,b as e,w as t,t as o,e as i}from"./utils-BE8OECDH.js";import{f as l,a as c,i as s}from"./jobs-loader-CErzUEmq.js";import{I as p,P as r,D as d,J as m}from"./index-BCF2U2NH.js";async function y(n,a,e){try{const t=[];for(const e of n)if(s(e)&&e.companyDomain!==a){if(e.jobsSheet&&e.jobsSheet.trim()){const n=await c(e.jobsSheet.trim());n&&n.length>0&&(n.forEach(n=>{n.company=e.company,n.companyDomain=e.companyDomain}),t.push(...n.slice(0,2)))}if(t.length>=6)break}!function(n,a,e){const t=document.getElementById("related-jobs-container");if(!t)return;const o=n.filter(n=>!(n.companyDomain===a&&String(n.id)===String(e))).slice(0,6);0!==o.length?t.innerHTML=o.map(n=>m({job:n})).join(""):t.innerHTML='<p class="no-data">関連する求人がありません。</p>'}(t.slice(0,6),a,e)}catch(t){console.error("関連求人の取得エラー:",t)}}function b(){document.querySelectorAll("[data-apply-btn]").forEach(n=>{n.addEventListener("click",()=>{const a={company_domain:n.dataset.companyDomain,company_name:n.dataset.companyName,job_id:n.dataset.jobId,job_title:n.dataset.jobTitle};o("click_apply",a),async function(n){try{if(!window.firebaseDb)return void console.warn("[Application] Firestore not initialized");await window.firebaseDb.collection("applications").add({companyDomain:n.company_domain,companyName:n.company_name,jobId:n.job_id,jobTitle:n.job_title,type:"apply",source:document.referrer||"direct",userAgent:navigator.userAgent,timestamp:new Date,createdAt:firebase.firestore.FieldValue.serverTimestamp()}),console.log("[Application] Saved to Firestore")}catch(a){console.error("[Application] Failed to save:",a)}}(a)})})}async function u(){const s=n("company"),m=n("job");if(s&&m){e("job-detail-container","求人情報を読み込んでいます...");try{await t();const n=await l();if(!n)return void a("job-detail-container","データの取得に失敗しました。");const e=n.find(n=>n.companyDomain&&n.companyDomain.trim()===s);if(!e)return void a("job-detail-container","会社が見つかりませんでした。");let u=null;if(e.jobsSheet&&e.jobsSheet.trim()){const n=await c(e.jobsSheet.trim());n&&(u=n.find(n=>String(n.id)===String(m)),u&&(u.company=e.company,u.companyDomain=e.companyDomain))}if(!u)return void a("job-detail-container","求人が見つかりませんでした。");!function(n){const a=document.getElementById("job-detail-container");if(!a)return;const e=Array.isArray(n.features)?n.features:[];a.innerHTML=`\n    <div class="lp-container">\n      \x3c!-- ヒーローセクション --\x3e\n      <section class="lp-hero-section">\n        <div class="lp-hero-bg"></div>\n        <div class="lp-hero-inner">\n          <p class="lp-hero-label">${i(n.company)}</p>\n          <h1 class="lp-hero-title">${i(n.title)}</h1>\n          <div class="lp-hero-meta">\n            <span class="lp-hero-location">\n              ${p.location}\n              ${i(n.location)}\n            </span>\n          </div>\n          <a href="#apply-section" class="lp-hero-cta" data-apply-btn data-job-id="${i(String(n.id))}" data-company-domain="${i(n.companyDomain)}" data-company-name="${i(n.company)}" data-job-title="${i(n.title)}">今すぐ応募する</a>\n        </div>\n      </section>\n\n      \x3c!-- ポイントセクション --\x3e\n      <section class="lp-points-section">\n        <div class="lp-section-inner">\n          <h2 class="lp-section-heading">この求人のポイント</h2>\n          <div class="lp-points-grid">\n            ${n.totalBonus?r({icon:p.money,label:"特典総額",value:n.totalBonus,isHighlight:!0}):""}\n            ${n.monthlySalary?r({icon:p.wallet,label:"月収例",value:n.monthlySalary}):""}\n            ${n.employmentType?r({icon:p.briefcase,label:"雇用形態",value:n.employmentType}):""}\n          </div>\n          ${e.length>0?`\n          <div class="lp-tags">\n            ${e.map(n=>`<span class="lp-tag">${i(n)}</span>`).join("")}\n          </div>\n          `:""}\n        </div>\n      </section>\n\n      \x3c!-- 募集要項セクション --\x3e\n      <section class="lp-details-section">\n        <div class="lp-section-inner">\n          <h2 class="lp-section-heading">募集要項</h2>\n          <div class="lp-details-table">\n            ${d({label:"仕事内容",value:n.jobDescription})}\n            ${d({label:"給与",value:n.salary})}\n            ${d({label:"応募資格",value:n.requirements})}\n            ${d({label:"勤務時間",value:n.workingHours})}\n            ${d({label:"休日・休暇",value:n.holidays})}\n            ${d({label:"待遇・福利厚生",value:n.benefits})}\n            <div class="lp-detail-row">\n              <div class="lp-detail-label">勤務地</div>\n              <div class="lp-detail-value">${i(n.location)}</div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      \x3c!-- 応募セクション --\x3e\n      <section class="lp-apply-section" id="apply-section">\n        <div class="lp-section-inner">\n          <h2 class="lp-apply-heading">まずはお気軽にご応募ください</h2>\n          <p class="lp-apply-text">経験・学歴不問！あなたのご応募をお待ちしています。</p>\n          <div class="lp-apply-buttons">\n            <a href="#" class="lp-apply-btn primary" data-apply-btn data-job-id="${i(String(n.id))}" data-company-domain="${i(n.companyDomain)}" data-company-name="${i(n.company)}" data-job-title="${i(n.title)}">この求人に応募する</a>\n            <a href="company.html?id=${i(n.companyDomain)}" class="lp-apply-btn secondary">${i(n.company)}の企業情報を見る</a>\n          </div>\n        </div>\n      </section>\n    </div>\n  `}(u),function(n){const a=document.getElementById("breadcrumb-company");a&&(a.innerHTML=`<a href="company.html?id=${encodeURIComponent(n.companyDomain)}">${i(n.company)}</a>`);const e=document.getElementById("breadcrumb-current");e&&(e.textContent=n.title)}(u),function(n){document.title=`${n.title} | ${n.company} | リクエコ求人ナビ`;const a=document.querySelector('meta[name="description"]');a&&(a.content=`${n.company}の${n.title}。${n.location}勤務。${n.totalBonus?"特典総額"+n.totalBonus+"。":""}`)}(u),y(n,s,m),o("view_job_detail",{company_domain:u.companyDomain,company_name:u.company,job_id:String(u.id),job_title:u.title,location:u.location}),b()}catch(u){console.error("求人詳細の取得エラー:",u),a("job-detail-container","データの取得に失敗しました。しばらくしてから再度お試しください。")}}else a("job-detail-container","求人が見つかりませんでした。")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>u(),0)}):setTimeout(()=>u(),0);
