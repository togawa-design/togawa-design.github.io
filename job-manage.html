<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">

  <title>求人管理 | リクエコ求人ナビ</title>

  <!-- スタイルシート -->
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/admin.css">
  <link rel="stylesheet" href="/css/applicants.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <script type="module" crossorigin src="/js/jobManage-BGNLLQEL.js"></script>
  <link rel="modulepreload" crossorigin href="/js/modulepreload-polyfill-YP0FEG5d.js">
  <link rel="modulepreload" crossorigin href="/js/utils-BE8OECDH.js">
  <link rel="modulepreload" crossorigin href="/js/LPEditor-Cg7IJGVU.js">
  <link rel="modulepreload" crossorigin href="/js/image-uploader-CwR9OqLI.js">
  <link rel="modulepreload" crossorigin href="/js/jobs-loader-CIZMoLrM.js">
  <link rel="modulepreload" crossorigin href="/js/job-feed-generator-BBEmU1ix.js">
</head>
<body class="admin-body">
  <!-- 求人管理ダッシュボード -->
  <div id="job-manage-dashboard" class="admin-dashboard">
    <!-- サイドバー -->
    <aside class="admin-sidebar">
      <div class="sidebar-header">
        <h2>リクエコ求人ナビ</h2>
        <p>求人管理</p>
      </div>
      <nav class="sidebar-nav">
        <ul>
          <li><a href="admin.html" data-section="back"><span class="nav-icon">←</span>管理画面に戻る</a></li>
          <li class="active"><a href="#" data-section="jobs"><span class="nav-icon">📋</span>求人一覧</a></li>
          <li><a href="#" data-section="analytics"><span class="nav-icon">📈</span>アクセス解析</a></li>
          <li><a href="#" data-section="reports"><span class="nav-icon">📊</span>レポート</a></li>
          <li><a href="#" id="nav-applicants" data-section="applicants"><span class="nav-icon">👥</span>応募者管理</a></li>
          <li id="nav-lp-settings-item" style="display: none;"><a href="#" data-section="lp-settings"><span class="nav-icon">🎨</span>LP設定</a></li>
          <li id="nav-settings-item" style="display: none;"><a href="#" data-section="settings"><span class="nav-icon">⚙️</span>設定</a></li>
        </ul>
      </nav>
      <div class="sidebar-footer">
        <a href="#" id="btn-open-sheet" target="_blank" class="btn-back-top">管理シートを開く</a>
        <a href="admin.html" id="btn-back-admin" class="btn-back-admin">管理画面へ戻る</a>
        <button id="btn-logout" class="btn-logout" style="display: none;">ログアウト</button>
      </div>
    </aside>

    <!-- メインコンテンツ -->
    <main class="admin-main">
      <!-- ヘッダー -->
      <header class="admin-header">
        <h1 id="page-title">求人一覧</h1>
        <div class="header-actions">
          <button id="btn-add-job" class="btn-primary">+ 新規求人作成</button>
          <button id="btn-refresh" class="btn-refresh">更新</button>
        </div>
      </header>

      <!-- 求人一覧セクション -->
      <section id="section-jobs" class="admin-section active">
        <div class="info-box">
          <p id="company-info">会社: <strong id="company-name">-</strong></p>
          <p>この会社の求人データは、専用の管理シートで管理されています。</p>
        </div>

        <!-- 求人フィード出力 -->
        <div class="feed-export-section">
          <div class="feed-export-header">
            <h3>求人フィード出力</h3>
            <p class="form-hint">各求人媒体に掲載するためのフィードをダウンロードできます</p>
          </div>
          <div class="feed-export-buttons">
            <button id="btn-download-indeed" class="btn-feed" title="Indeed用XMLフィード">
              <span class="feed-icon">📄</span>
              <span class="feed-label">Indeed XML</span>
            </button>
            <button id="btn-download-google" class="btn-feed" title="Google しごと検索用JSON-LD">
              <span class="feed-icon">📄</span>
              <span class="feed-label">Google JSON-LD</span>
            </button>
            <button id="btn-download-jobbox" class="btn-feed" title="求人ボックス/スタンバイ用XML">
              <span class="feed-icon">📄</span>
              <span class="feed-label">求人ボックス XML</span>
            </button>
            <button id="btn-download-csv" class="btn-feed" title="CSV形式でエクスポート">
              <span class="feed-icon">📊</span>
              <span class="feed-label">CSV</span>
            </button>
          </div>
          <div id="feed-status" class="feed-status" style="display: none;">
            <div class="loading-spinner-small"></div>
            <span>フィードを生成中...</span>
          </div>
        </div>

        <div class="table-container">
          <table class="admin-table" id="jobs-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>募集タイトル</th>
                <th>勤務地</th>
                <th>月収</th>
                <th>表示</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody id="jobs-tbody">
              <tr>
                <td colspan="6" class="loading-cell">データを読み込み中...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- アクセス解析セクション -->
      <section id="section-analytics" class="admin-section">
        <div class="analytics-header">
          <h2>アクセス解析</h2>
          <p class="section-description">求人ページへのアクセス状況を確認できます</p>
        </div>

        <!-- 期間選択 -->
        <div class="analytics-controls">
          <div class="analytics-period-select">
            <label for="analytics-period">期間</label>
            <select id="analytics-period">
              <option value="7days" selected>過去7日間</option>
              <option value="30days">過去30日間</option>
              <option value="month">今月</option>
              <option value="last-month">先月</option>
            </select>
          </div>
          <button id="btn-load-analytics" class="btn-primary">データ取得</button>
        </div>

        <!-- サマリーカード -->
        <div class="analytics-summary">
          <div class="analytics-card">
            <div class="analytics-icon">👁️</div>
            <div class="analytics-content">
              <span class="analytics-value" id="analytics-pv">-</span>
              <span class="analytics-label">総PV数</span>
            </div>
          </div>
          <div class="analytics-card">
            <div class="analytics-icon">👤</div>
            <div class="analytics-content">
              <span class="analytics-value" id="analytics-users">-</span>
              <span class="analytics-label">ユニークユーザー</span>
            </div>
          </div>
          <div class="analytics-card">
            <div class="analytics-icon">📄</div>
            <div class="analytics-content">
              <span class="analytics-value" id="analytics-pages-per-session">-</span>
              <span class="analytics-label">平均閲覧求人数</span>
            </div>
          </div>
          <div class="analytics-card">
            <div class="analytics-icon">⏱️</div>
            <div class="analytics-content">
              <span class="analytics-value" id="analytics-avg-time">-</span>
              <span class="analytics-label">平均滞在時間</span>
            </div>
          </div>
        </div>

        <!-- 求人別アクセス数 -->
        <div class="analytics-section">
          <h3>求人別アクセス数</h3>
          <div class="analytics-table-container">
            <table class="analytics-table">
              <thead>
                <tr>
                  <th>求人タイトル</th>
                  <th>PV</th>
                  <th>ユーザー</th>
                  <th>直帰率</th>
                  <th>平均滞在時間</th>
                </tr>
              </thead>
              <tbody id="job-analytics-tbody">
                <tr>
                  <td colspan="5" class="loading-cell">「データ取得」ボタンをクリックしてください</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- 流入元別 -->
        <div class="analytics-section">
          <h3>流入元別アクセス</h3>
          <div class="analytics-table-container">
            <table class="analytics-table">
              <thead>
                <tr>
                  <th>流入元</th>
                  <th>セッション</th>
                  <th>割合</th>
                </tr>
              </thead>
              <tbody id="source-analytics-tbody">
                <tr>
                  <td colspan="3" class="loading-cell">-</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- デバイス別 -->
        <div class="analytics-section">
          <h3>デバイス別アクセス</h3>
          <div class="analytics-table-container">
            <table class="analytics-table">
              <thead>
                <tr>
                  <th>デバイス</th>
                  <th>セッション</th>
                  <th>割合</th>
                </tr>
              </thead>
              <tbody id="device-analytics-tbody">
                <tr>
                  <td colspan="3" class="loading-cell">-</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ユーザー属性（会社アカウント用） -->
        <div class="analytics-demographics company-only-section" id="analytics-demographics" style="display: none;">
          <h3>ユーザー属性</h3>
          <p class="demographics-note">※ Google Signalsが有効な場合のみデータが表示されます</p>
          <div class="demographics-grid">
            <!-- 男女比 -->
            <div class="demographics-card">
              <h4>男女比</h4>
              <div class="gender-chart" id="gender-chart">
                <div class="gender-bar-container">
                  <div class="gender-bar male" id="gender-bar-male" style="width: 0%"></div>
                  <div class="gender-bar female" id="gender-bar-female" style="width: 0%"></div>
                </div>
                <div class="gender-labels">
                  <span class="gender-label male"><span class="gender-icon">♂</span> 男性 <span id="gender-male-percent">-</span></span>
                  <span class="gender-label female"><span class="gender-icon">♀</span> 女性 <span id="gender-female-percent">-</span></span>
                </div>
              </div>
            </div>
            <!-- 年齢分布 -->
            <div class="demographics-card">
              <h4>年齢分布</h4>
              <div class="age-chart" id="age-chart">
                <div class="age-bars" id="age-bars">
                  <!-- JSで動的に生成 -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 注意書き -->
        <div class="analytics-note">
          <p>※ アクセス解析データはGoogle Analyticsから取得しています。データ反映には最大24時間かかる場合があります。</p>
        </div>
      </section>

      <!-- レポートセクション -->
      <section id="section-reports" class="admin-section">
        <div class="report-header">
          <h2>応募レポート</h2>
          <p class="section-description">期間を選択してレポートを生成・ダウンロードできます</p>
        </div>

        <!-- 期間選択 -->
        <div class="report-controls">
          <div class="report-period-select">
            <label for="report-period">期間</label>
            <select id="report-period">
              <option value="week">今週</option>
              <option value="last-week">先週</option>
              <option value="month" selected>今月</option>
              <option value="last-month">先月</option>
              <option value="custom">カスタム</option>
            </select>
          </div>
          <div id="report-custom-dates" class="report-custom-dates" style="display: none;">
            <div class="date-input">
              <label for="report-from">開始日</label>
              <input type="date" id="report-from">
            </div>
            <span class="date-separator">〜</span>
            <div class="date-input">
              <label for="report-to">終了日</label>
              <input type="date" id="report-to">
            </div>
          </div>
          <button id="btn-generate-report" class="btn-primary">レポート生成</button>
        </div>

        <!-- レポートプレビュー -->
        <div id="report-preview" class="report-preview">
          <div class="report-loading" id="report-loading" style="display: none;">
            <div class="loading-spinner"></div>
            <p>レポートを生成中...</p>
          </div>

          <div id="report-content" style="display: none;">
            <!-- サマリーカード -->
            <div class="report-summary">
              <div class="summary-card">
                <div class="summary-icon">📥</div>
                <div class="summary-content">
                  <span class="summary-value" id="summary-total">0</span>
                  <span class="summary-label">総応募数</span>
                </div>
              </div>
              <div class="summary-card">
                <div class="summary-icon">📈</div>
                <div class="summary-content">
                  <span class="summary-value" id="summary-change">-</span>
                  <span class="summary-label">前期比</span>
                </div>
              </div>
              <div class="summary-card">
                <div class="summary-icon">✅</div>
                <div class="summary-content">
                  <span class="summary-value" id="summary-hired">0</span>
                  <span class="summary-label">採用数</span>
                </div>
              </div>
              <div class="summary-card">
                <div class="summary-icon">⏳</div>
                <div class="summary-content">
                  <span class="summary-value" id="summary-pending">0</span>
                  <span class="summary-label">対応中</span>
                </div>
              </div>
            </div>

            <!-- ステータス別内訳 -->
            <div class="report-section">
              <h3>ステータス別内訳</h3>
              <div class="report-table-container">
                <table class="report-table">
                  <thead>
                    <tr>
                      <th>ステータス</th>
                      <th>件数</th>
                      <th>割合</th>
                    </tr>
                  </thead>
                  <tbody id="status-breakdown">
                  </tbody>
                </table>
              </div>
            </div>

            <!-- 求人別パフォーマンス -->
            <div class="report-section">
              <h3>求人別パフォーマンス TOP5</h3>
              <div class="report-table-container">
                <table class="report-table">
                  <thead>
                    <tr>
                      <th>求人</th>
                      <th>応募数</th>
                      <th>PV</th>
                      <th>CVR</th>
                    </tr>
                  </thead>
                  <tbody id="job-performance">
                  </tbody>
                </table>
              </div>
            </div>

            <!-- 流入元分析 -->
            <div class="report-section">
              <h3>流入元分析</h3>
              <div class="report-table-container">
                <table class="report-table">
                  <thead>
                    <tr>
                      <th>流入元</th>
                      <th>応募数</th>
                      <th>割合</th>
                    </tr>
                  </thead>
                  <tbody id="source-breakdown">
                  </tbody>
                </table>
              </div>
            </div>

            <!-- 担当者別対応状況 -->
            <div class="report-section">
              <h3>担当者別対応状況</h3>
              <div class="report-table-container">
                <table class="report-table">
                  <thead>
                    <tr>
                      <th>担当者</th>
                      <th>対応済</th>
                      <th>未対応</th>
                    </tr>
                  </thead>
                  <tbody id="assignee-breakdown">
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- 未生成時メッセージ -->
          <div id="report-empty" class="report-empty">
            <div class="empty-icon">📊</div>
            <p>「レポート生成」ボタンをクリックしてレポートを作成してください</p>
          </div>
        </div>

        <!-- ダウンロードボタン -->
        <div class="report-actions" id="report-actions" style="display: none;">
          <button id="btn-report-csv" class="btn-secondary">
            <span class="btn-icon">📄</span>
            CSVダウンロード
          </button>
          <button id="btn-report-excel" class="btn-primary">
            <span class="btn-icon">📊</span>
            Excelダウンロード
          </button>
        </div>
      </section>

      <!-- 応募者管理セクション -->
      <section id="section-applicants" class="admin-section">
        <div class="section-header">
          <div class="header-actions">
            <button id="btn-export-csv" class="btn-secondary">📥 CSVエクスポート</button>
            <button id="btn-refresh-applicants" class="btn-refresh">更新</button>
          </div>
        </div>

        <!-- 2カラムレイアウト -->
        <div class="applicants-content">
          <!-- 左：応募者一覧 (60%) -->
          <div class="applicants-list-panel">
            <!-- 統計カード -->
            <div class="stats-cards compact">
              <div class="stat-card">
                <div class="stat-value" id="stat-total">0</div>
                <div class="stat-label">総応募</div>
              </div>
              <div class="stat-card stat-new">
                <div class="stat-value" id="stat-new">0</div>
                <div class="stat-label">新規</div>
              </div>
              <div class="stat-card stat-progress">
                <div class="stat-value" id="stat-progress">0</div>
                <div class="stat-label">対応中</div>
              </div>
              <div class="stat-card stat-complete">
                <div class="stat-value" id="stat-complete">0</div>
                <div class="stat-label">完了</div>
              </div>
            </div>

            <!-- フィルター -->
            <div class="filter-section compact">
              <div class="filter-row">
                <select id="filter-status" class="filter-select">
                  <option value="">全ステータス</option>
                  <option value="new">新規</option>
                  <option value="contacted">連絡済み</option>
                  <option value="interviewing">面接調整中</option>
                  <option value="interviewed">面接済み</option>
                  <option value="hired">採用</option>
                  <option value="rejected">不採用</option>
                  <option value="withdrawn">辞退</option>
                </select>
                <select id="filter-type" class="filter-select">
                  <option value="">全種別</option>
                  <option value="apply">応募</option>
                  <option value="line">LINE相談</option>
                  <option value="consult">お問い合わせ</option>
                </select>
                <input type="text" id="filter-search" class="filter-input" placeholder="検索...">
              </div>
            </div>

            <!-- 応募者リスト -->
            <div class="applicants-list" id="applicants-list">
              <div class="loading-message">データを読み込み中...</div>
            </div>

            <!-- ページネーション -->
            <div class="pagination" id="pagination"></div>
          </div>

          <!-- 右：詳細パネル (40%) -->
          <div class="applicants-detail-panel" id="detail-panel">
            <div class="detail-empty-state" id="detail-empty">
              <div class="empty-icon">👆</div>
              <p>左の一覧から応募者を選択してください</p>
            </div>

            <div class="detail-content" id="detail-content" style="display: none;">
              <!-- 詳細ヘッダー -->
              <div class="detail-header">
                <div class="detail-header-info">
                  <h2 id="detail-name">-</h2>
                  <p id="detail-job-title" class="detail-job">-</p>
                </div>
                <button class="btn-close-detail" id="btn-close-detail" title="閉じる">&times;</button>
              </div>

              <!-- スクロール可能な詳細エリア -->
              <div class="detail-scroll-area">
                <!-- 基本情報カード -->
                <div class="detail-card">
                  <h3>基本情報</h3>
                  <div class="detail-grid">
                    <div class="detail-item">
                      <label>電話番号</label>
                      <span id="detail-phone">-</span>
                    </div>
                    <div class="detail-item">
                      <label>メール</label>
                      <span id="detail-email">-</span>
                    </div>
                    <div class="detail-item">
                      <label>年齢</label>
                      <span id="detail-age">-</span>
                    </div>
                    <div class="detail-item">
                      <label>現住所</label>
                      <span id="detail-address">-</span>
                    </div>
                    <div class="detail-item">
                      <label>希望開始日</label>
                      <span id="detail-start-date">-</span>
                    </div>
                    <div class="detail-item">
                      <label>応募日時</label>
                      <span id="detail-datetime">-</span>
                    </div>
                    <div class="detail-item">
                      <label>種別</label>
                      <span id="detail-type">-</span>
                    </div>
                    <div class="detail-item">
                      <label>流入元</label>
                      <span id="detail-source">-</span>
                    </div>
                  </div>
                </div>

                <!-- ステータス・担当者 -->
                <div class="detail-card">
                  <h3>ステータス</h3>
                  <div class="status-buttons" id="status-buttons">
                    <button class="status-btn" data-status="new">新規</button>
                    <button class="status-btn" data-status="contacted">連絡済み</button>
                    <button class="status-btn" data-status="interviewing">面接調整</button>
                    <button class="status-btn" data-status="interviewed">面接済み</button>
                    <button class="status-btn status-success" data-status="hired">採用</button>
                    <button class="status-btn status-danger" data-status="rejected">不採用</button>
                    <button class="status-btn status-muted" data-status="withdrawn">辞退</button>
                  </div>
                  <div class="assignee-row">
                    <label>担当者</label>
                    <select id="detail-assignee">
                      <option value="">未割当</option>
                    </select>
                    <button type="button" id="btn-add-assignee" class="btn-icon" title="担当者を追加">+</button>
                  </div>
                </div>

                <!-- メモ -->
                <div class="detail-card">
                  <h3>メモ</h3>
                  <textarea id="detail-notes" rows="3" placeholder="メモを入力..."></textarea>
                  <button id="btn-save-notes" class="btn-save-small">保存</button>
                </div>

                <!-- 対応履歴 -->
                <div class="detail-card">
                  <h3>対応履歴</h3>
                  <div id="detail-history" class="history-list">
                    <p class="no-data">対応履歴はありません</p>
                  </div>
                  <div class="add-history-row">
                    <input type="text" id="new-history-text" placeholder="対応内容を入力...">
                    <button id="btn-add-history" class="btn-add">追加</button>
                  </div>
                </div>

                <!-- メッセージ -->
                <div class="detail-card">
                  <h3>メッセージ</h3>
                  <div id="messages-container" class="messages-container">
                    <p class="no-data">メッセージはありません</p>
                  </div>
                  <div class="message-input-row">
                    <select id="message-template-select" class="template-select">
                      <option value="">テンプレート選択...</option>
                      <option value="first_contact">初回連絡</option>
                      <option value="schedule_interview">面接日程調整</option>
                      <option value="interview_reminder">面接リマインダー</option>
                      <option value="document_request">書類提出依頼</option>
                      <option value="result_pending">選考結果待ち</option>
                      <option value="offer">内定通知</option>
                      <option value="rejection">不採用通知</option>
                    </select>
                  </div>
                  <div class="message-input-row">
                    <textarea id="new-message-text" rows="4" placeholder="メッセージを入力..."></textarea>
                  </div>
                  <div class="message-actions">
                    <button id="btn-send-message" class="btn-primary btn-send">送信</button>
                  </div>
                  <p class="message-hint">応募者がマイページで確認できます</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 設定セクション（会社ユーザー用） -->
      <section id="section-settings" class="admin-section">
        <div class="section-header">
          <h2>アカウント設定</h2>
        </div>

        <div class="settings-card">
          <h3>パスワード変更</h3>
          <form id="password-change-form">
            <div class="form-group">
              <label for="current-password">現在のパスワード</label>
              <input type="password" id="current-password" required autocomplete="current-password">
            </div>
            <div class="form-group">
              <label for="new-password">新しいパスワード</label>
              <input type="password" id="new-password" required minlength="8" autocomplete="new-password">
              <p class="form-hint">8文字以上で設定してください</p>
            </div>
            <div class="form-group">
              <label for="confirm-password">新しいパスワード（確認）</label>
              <input type="password" id="confirm-password" required minlength="8" autocomplete="new-password">
            </div>
            <div id="password-change-error" class="form-error" style="display: none;"></div>
            <div id="password-change-success" class="form-success" style="display: none;"></div>
            <button type="submit" class="btn-primary">パスワードを変更</button>
          </form>
        </div>
      </section>

      <!-- LP設定セクション（会社ユーザー用 - admin同等のUI） -->
      <section id="section-lp-settings" class="admin-section">
        <div class="section-header">
          <h3>LP（ランディングページ）設定</h3>
        </div>

        <div class="info-box">
          <p>求人専用のランディングページの設定を行います。URLは <code>/lp.html?j=求人ID</code> でアクセスできます。</p>
        </div>

        <div class="lp-settings-form" id="lp-settings-form">
          <!-- ステップインジケーター -->
          <div class="lp-selection-steps" id="lp-selection-steps">
            <div class="lp-step active" data-step="job">
              <span class="lp-step-number">1</span>
              <span class="lp-step-label">求人を選択</span>
            </div>
            <div class="lp-step-arrow">→</div>
            <div class="lp-step" data-step="edit">
              <span class="lp-step-number">2</span>
              <span class="lp-step-label">LP編集</span>
            </div>
          </div>

          <!-- 求人選択 -->
          <div class="lp-selection-panel" id="lp-job-select-group">
            <div class="lp-selection-header">
              <h4>LP設定する求人を選択</h4>
            </div>
            <div class="lp-job-grid" id="lp-job-grid">
              <div class="lp-loading-placeholder">読み込み中...</div>
            </div>
          </div>

          <!-- 非表示のselect（互換性のため） -->
          <select id="lp-job-select" style="display: none;"></select>

          <div id="lp-editor" style="display: none;">
            <!-- プレビューアクション -->
            <div class="lp-preview-actions">
              <button type="button" class="lp-back-btn" id="lp-back-to-jobs">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                求人一覧に戻る
              </button>
              <a href="#" id="lp-preview-btn" target="_blank" class="btn btn-secondary">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                プレビュー
              </a>
              <a href="#" id="lp-edit-mode-btn" target="_blank" class="btn btn-primary">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                編集モードで開く
              </a>
            </div>

            <!-- 1. テンプレート -->
            <div class="form-section lp-form-section" id="template-section">
              <div class="lp-section-header">
                <span class="lp-section-number">1</span>
                <h4>テンプレート</h4>
              </div>
              <p class="form-hint">LPのレイアウトスタイルを選択してください。未選択の場合はデフォルトが適用されます。</p>
              <div id="template-selector-container">
                <!-- テンプレートセレクターはJSで動的に生成 -->
              </div>
            </div>

            <!-- 2. カラー選択 -->
            <div class="form-section lp-form-section">
              <div class="lp-section-header">
                <span class="lp-section-number">2</span>
                <h4>カラー選択</h4>
              </div>
              <p class="form-hint">LPのカラーテーマを選択してください</p>
              <div class="design-pattern-grid" id="design-pattern-grid">
                <label class="pattern-option">
                  <input type="radio" name="design-pattern" value="standard" checked>
                  <div class="pattern-preview standard">
                    <div class="pattern-mini-lp">
                      <div class="mini-hero"></div>
                      <div class="mini-section"></div>
                      <div class="mini-section"></div>
                      <div class="mini-cta"></div>
                    </div>
                    <span class="pattern-name">スタンダード</span>
                    <span class="pattern-desc">シンプルで使いやすい</span>
                  </div>
                </label>
                <label class="pattern-option">
                  <input type="radio" name="design-pattern" value="modern">
                  <div class="pattern-preview modern">
                    <div class="pattern-mini-lp">
                      <div class="mini-hero"></div>
                      <div class="mini-section"></div>
                      <div class="mini-section"></div>
                      <div class="mini-cta"></div>
                    </div>
                    <span class="pattern-name">モダン</span>
                    <span class="pattern-desc">洗練されたデザイン</span>
                  </div>
                </label>
                <label class="pattern-option">
                  <input type="radio" name="design-pattern" value="classic">
                  <div class="pattern-preview classic">
                    <div class="pattern-mini-lp">
                      <div class="mini-hero"></div>
                      <div class="mini-section"></div>
                      <div class="mini-section"></div>
                      <div class="mini-cta"></div>
                    </div>
                    <span class="pattern-name">クラシック</span>
                    <span class="pattern-desc">信頼感のある重厚感</span>
                  </div>
                </label>
                <label class="pattern-option">
                  <input type="radio" name="design-pattern" value="minimal">
                  <div class="pattern-preview minimal">
                    <div class="pattern-mini-lp">
                      <div class="mini-hero"></div>
                      <div class="mini-section"></div>
                      <div class="mini-section"></div>
                      <div class="mini-cta"></div>
                    </div>
                    <span class="pattern-name">ミニマル</span>
                    <span class="pattern-desc">シックでモノトーン</span>
                  </div>
                </label>
                <label class="pattern-option">
                  <input type="radio" name="design-pattern" value="colorful">
                  <div class="pattern-preview colorful">
                    <div class="pattern-mini-lp">
                      <div class="mini-hero"></div>
                      <div class="mini-section"></div>
                      <div class="mini-section"></div>
                      <div class="mini-cta"></div>
                    </div>
                    <span class="pattern-name">カラフル</span>
                    <span class="pattern-desc">華やかで目を引く</span>
                  </div>
                </label>
              </div>
            </div>

            <!-- 3. ヒーローセクション -->
            <div class="form-section lp-form-section">
              <div class="lp-section-header">
                <span class="lp-section-number">3</span>
                <h4>ヒーローセクション</h4>
              </div>
              <div class="form-group">
                <label for="lp-hero-title">ヒーロータイトル</label>
                <input type="text" id="lp-hero-title" placeholder="例: 月収32万円以上可！入社特典あり">
              </div>
              <div class="form-group">
                <label for="lp-hero-subtitle">サブタイトル</label>
                <input type="text" id="lp-hero-subtitle" placeholder="例: 未経験歓迎・寮完備">
              </div>
              <div class="form-group">
                <label for="lp-hero-image">ヒーロー画像URL</label>
                <input type="text" id="lp-hero-image" placeholder="https://example.com/image.jpg">
                <p class="form-hint">下のプリセットから選択するか、直接URLを入力してください</p>
              </div>
              <div class="form-group">
                <label>プリセット画像を選択</label>
                <div class="hero-image-presets" id="hero-image-presets">
                  <!-- JavaScriptで動的に生成 -->
                </div>
              </div>
            </div>

            <!-- 4. ポイント（特徴） -->
            <div class="form-section lp-form-section">
              <div class="lp-section-header">
                <span class="lp-section-number">4</span>
                <h4>ポイント（特徴）</h4>
              </div>
              <p class="form-hint">最大6つまで追加できます。表示したくない項目は空欄のままにしてください。</p>
              <div class="point-inputs" id="point-inputs-container">
                <!-- JavaScriptで動的に生成 -->
              </div>
              <button type="button" id="btn-add-point" class="btn-add-item">
                <span>+</span> ポイントを追加
              </button>
            </div>

            <!-- 5. CTA（応募ボタン） -->
            <div class="form-section lp-form-section">
              <div class="lp-section-header">
                <span class="lp-section-number">5</span>
                <h4>CTA（応募ボタン）</h4>
              </div>
              <div class="form-group">
                <label for="lp-cta-text">ボタンテキスト</label>
                <input type="text" id="lp-cta-text" placeholder="例: 今すぐ応募する" value="今すぐ応募する">
              </div>
            </div>

            <!-- 6. FAQ（よくある質問） -->
            <div class="form-section lp-form-section">
              <div class="lp-section-header">
                <span class="lp-section-number">6</span>
                <h4>FAQ（よくある質問）</h4>
              </div>
              <p class="form-hint">質問と回答を入力してください。LPではLINE風のチャット形式で表示されます。</p>
              <div class="faq-editor" id="faq-editor">
                <div class="faq-list" id="faq-list">
                  <!-- FAQアイテムはJSで動的に生成 -->
                </div>
                <button type="button" class="faq-add-btn" id="btn-add-faq">
                  <span class="faq-add-icon">+</span>
                  質問を追加
                </button>
              </div>
              <!-- 互換性のため非表示のテキストエリアを保持 -->
              <textarea id="lp-faq" style="display: none;"></textarea>
            </div>

            <!-- カスタムセクション（動画・カルーセル等） -->
            <div class="form-section lp-form-section" id="custom-sections-panel" style="display: none;">
              <div class="lp-section-header">
                <span class="lp-section-number">✨</span>
                <h4>追加コンテンツ</h4>
              </div>
              <p class="form-hint">登録済みの動画・画像スライド・ギャラリーなど。クリックして編集できます。</p>
              <div class="custom-sections-list" id="custom-sections-list">
                <!-- JSで動的に生成 -->
              </div>
              <button type="button" id="btn-add-custom-section" class="btn-add-item">
                <span>+</span> 動画・スライドなどを追加
              </button>
            </div>

            <!-- 7. セクション管理 -->
            <div class="form-section lp-form-section" id="section-manager">
              <div class="lp-section-header">
                <span class="lp-section-number">7</span>
                <h4>セクション管理</h4>
              </div>
              <p class="form-hint">セクションの追加・削除・並び替えができます。ドラッグ＆ドロップで並び替え可能です。</p>
              <div class="section-manager-toolbar">
                <button type="button" id="btn-add-section" class="btn-primary">
                  <span>+</span> セクションを追加
                </button>
              </div>
              <ul id="lp-sections-list" class="sections-list">
                <!-- セクションリストはJSで動的に生成 -->
              </ul>
            </div>

            <!-- 8. 広告トラッキング設定 -->
            <div class="form-section lp-form-section collapsible" id="ad-tracking-section">
              <div class="lp-section-header collapsible-header" data-target="ad-tracking-content">
                <span class="lp-section-number">8</span>
                <h4>広告トラッキング設定</h4>
                <span class="collapse-icon">▼</span>
              </div>
              <div class="collapsible-content" id="ad-tracking-content">
                <p class="form-hint">TikTok広告やGoogle広告のコンバージョン計測に使用します。</p>
                <div class="form-group">
                  <label for="lp-tiktok-pixel">TikTok Pixel ID</label>
                  <input type="text" id="lp-tiktok-pixel" placeholder="例: CXXXXXXXXXXXXXX">
                  <p class="form-hint">TikTok Ads ManagerのPixel IDを入力してください</p>
                </div>
                <div class="form-group">
                  <label for="lp-google-ads-id">Google Ads コンバージョンID</label>
                  <input type="text" id="lp-google-ads-id" placeholder="例: AW-123456789">
                  <p class="form-hint">Google Adsのコンバージョン追跡タグIDを入力してください</p>
                </div>
                <div class="form-group">
                  <label for="lp-google-ads-label">Google Ads コンバージョンラベル</label>
                  <input type="text" id="lp-google-ads-label" placeholder="例: AbCdEfGhIjKlMn">
                  <p class="form-hint">コンバージョンアクション作成時に発行されるラベルを入力してください</p>
                </div>
                <div class="form-group">
                  <label for="lp-meta-pixel">Meta Pixel ID</label>
                  <input type="text" id="lp-meta-pixel" placeholder="例: 1234567890123456">
                  <p class="form-hint">Meta Business SuiteのPixel IDを入力してください（Facebook/Instagram広告用）</p>
                </div>
                <div class="form-group">
                  <label for="lp-line-tag">LINE Tag ID</label>
                  <input type="text" id="lp-line-tag" placeholder="例: 12345678-abcd-efgh-ijkl-1234567890ab">
                  <p class="form-hint">LINE広告マネージャーのベースタグIDを入力してください</p>
                </div>
                <div class="form-group">
                  <label for="lp-clarity">Microsoft Clarity Project ID</label>
                  <input type="text" id="lp-clarity" placeholder="例: abcdefghij">
                  <p class="form-hint">Clarityのプロジェクト設定で確認できるIDを入力してください（ヒートマップ・レコーディング用）</p>
                </div>
              </div>
            </div>

            <!-- 9. OGP設定（広告プレビュー用） -->
            <div class="form-section lp-form-section collapsible" id="ogp-section">
              <div class="lp-section-header collapsible-header" data-target="ogp-content">
                <span class="lp-section-number">9</span>
                <h4>OGP設定（広告プレビュー用）</h4>
                <span class="collapse-icon">▼</span>
              </div>
              <div class="collapsible-content" id="ogp-content">
                <p class="form-hint">広告やSNSでシェアされた時に表示される情報です。</p>
                <div class="form-group">
                  <label for="lp-ogp-title">OGPタイトル</label>
                  <input type="text" id="lp-ogp-title" placeholder="例: 月収32万円以上可！製造スタッフ募集">
                  <p class="form-hint">空欄の場合はヒーロータイトルが使用されます</p>
                </div>
                <div class="form-group">
                  <label for="lp-ogp-description">OGP説明文</label>
                  <input type="text" id="lp-ogp-description" placeholder="例: 未経験歓迎・寮完備の高待遇求人！今すぐチェック">
                  <p class="form-hint">空欄の場合は自動生成されます</p>
                </div>
                <div class="form-group">
                  <label for="lp-ogp-image">OGP画像URL</label>
                  <input type="text" id="lp-ogp-image" placeholder="https://example.com/ogp-image.jpg">
                  <p class="form-hint">推奨サイズ: 1200×630px。空欄の場合はヒーロー画像が使用されます</p>
                </div>
              </div>
            </div>

            <!-- 保存ボタン -->
            <div class="form-actions">
              <button id="btn-save-lp-settings" class="btn-primary">LP設定を保存</button>
              <button id="btn-reset-lp-settings" class="btn-secondary">リセット</button>
              <button id="btn-toggle-preview" class="btn-secondary">プレビュー表示</button>
            </div>

            <div id="lp-save-message" class="form-success" style="display: none;">LP設定を保存しました</div>
            <div id="lp-error-message" class="form-error" style="display: none;"></div>
          </div>

          <!-- リアルタイムプレビュー -->
          <div id="lp-preview-container" class="lp-preview-container" style="display: none;">
            <div class="lp-preview-header">
              <h4>プレビュー</h4>
              <div class="lp-preview-controls">
                <label class="edit-mode-toggle">
                  <input type="checkbox" id="preview-edit-mode">
                  <span>編集モード</span>
                </label>
                <button class="preview-device-btn active" data-device="desktop" title="デスクトップ">🖥️</button>
                <button class="preview-device-btn" data-device="tablet" title="タブレット">📱</button>
                <button class="preview-device-btn" data-device="mobile" title="スマートフォン">📲</button>
              </div>
              <button id="btn-close-preview" class="btn-close-preview">&times;</button>
            </div>
            <div class="lp-preview-frame-wrapper" data-device="desktop">
              <iframe id="lp-preview-frame" class="lp-preview-frame"></iframe>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- 担当者追加モーダル -->
  <div id="assignee-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h3>担当者を追加</h3>
        <button class="modal-close" id="assignee-modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="new-assignee-name">担当者名</label>
          <input type="text" id="new-assignee-name" placeholder="例: 山田太郎">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-secondary" id="assignee-modal-cancel">キャンセル</button>
        <button type="button" class="btn-primary" id="assignee-modal-save">追加</button>
      </div>
    </div>
  </div>

  <!-- 求人編集モーダル -->
  <div id="job-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h3 id="job-modal-title">求人情報の編集</h3>
        <button class="modal-close" id="job-modal-close">&times;</button>
      </div>
      <form id="job-edit-form">
        <div class="modal-body">
          <div class="form-row">
            <div class="form-group">
              <label for="edit-job-title">募集タイトル <span class="required">*</span></label>
              <input type="text" id="edit-job-title" required placeholder="例: 製造スタッフ募集！月収32万円以上">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="edit-job-location">勤務地 <span class="required">*</span></label>
              <input type="text" id="edit-job-location" required placeholder="例: 愛知県豊田市">
            </div>
            <div class="form-group">
              <label for="edit-job-salary">月収（円）</label>
              <input type="number" id="edit-job-salary" placeholder="例: 320000">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="edit-job-bonus">賞与合計（円）</label>
              <input type="number" id="edit-job-bonus" placeholder="例: 500000">
            </div>
            <div class="form-group">
              <label for="edit-job-order">表示順</label>
              <input type="number" id="edit-job-order" placeholder="1" min="1">
            </div>
          </div>
          <div class="form-group">
            <label for="edit-job-type">職種</label>
            <select id="edit-job-type">
              <option value="">選択してください</option>
              <option value="事務・管理・企画">事務・管理・企画</option>
              <option value="営業・販売・サービス">営業・販売・サービス</option>
              <option value="IT・クリエイティブ">IT・クリエイティブ</option>
              <option value="製造・エンジニアリング">製造・エンジニアリング</option>
              <option value="医療・福祉・教育">医療・福祉・教育</option>
              <option value="物流・運輸">物流・運輸</option>
              <option value="その他">その他</option>
            </select>
          </div>
          <div class="form-group">
            <label for="edit-job-features">特徴（カンマ区切り）</label>
            <input type="text" id="edit-job-features" placeholder="例: 未経験歓迎, 寮完備, 交通費支給">
          </div>
          <div class="form-group">
            <label for="edit-job-badges">バッジ（カンマ区切り）</label>
            <input type="text" id="edit-job-badges" placeholder="例: 急募, 高収入">
          </div>
          <div class="form-group">
            <label for="edit-job-description">仕事内容</label>
            <textarea id="edit-job-description" rows="4" placeholder="仕事内容の詳細を入力..."></textarea>
          </div>
          <div class="form-group">
            <label for="edit-job-requirements">応募資格</label>
            <textarea id="edit-job-requirements" rows="3" placeholder="応募資格を入力..."></textarea>
          </div>
          <div class="form-group">
            <label for="edit-job-benefits">福利厚生</label>
            <textarea id="edit-job-benefits" rows="3" placeholder="福利厚生を入力..."></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="edit-job-hours">勤務時間</label>
              <input type="text" id="edit-job-hours" placeholder="例: 8:00〜17:00">
            </div>
            <div class="form-group">
              <label for="edit-job-holidays">休日</label>
              <input type="text" id="edit-job-holidays" placeholder="例: 土日祝, GW, 年末年始">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="edit-job-start-date">掲載開始日</label>
              <input type="date" id="edit-job-start-date">
            </div>
            <div class="form-group">
              <label for="edit-job-end-date">掲載終了日</label>
              <input type="date" id="edit-job-end-date">
            </div>
          </div>
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" id="edit-job-visible" checked>
              <span>公開する</span>
            </label>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-danger" id="job-modal-delete" style="margin-right: auto; display: none;">削除</button>
          <button type="button" class="btn-secondary" id="job-modal-cancel">キャンセル</button>
          <button type="submit" class="btn-primary" id="job-modal-save">保存</button>
        </div>
      </form>
    </div>
  </div>

  <!-- セクション追加モーダル -->
  <div id="add-section-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>セクションを追加</h3>
        <button class="modal-close" id="add-section-modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <p class="form-hint">追加したいセクションタイプを選択してください</p>
        <div class="section-type-grid" id="section-type-grid">
          <!-- JSで動的に生成 -->
        </div>
      </div>
    </div>
  </div>

  <!-- セクションエディターモーダル -->
  <div id="section-editor-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h3 id="section-editor-title">セクションを編集</h3>
        <button class="modal-close" id="section-editor-close">&times;</button>
      </div>
      <div class="modal-body" id="section-editor-content">
        <!-- JSで動的に生成 -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-danger" id="section-delete-btn">削除</button>
        <button type="button" class="btn-secondary" id="section-editor-cancel">キャンセル</button>
        <button type="button" class="btn-primary" id="section-editor-save">適用</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  <!-- SheetJS for Excel export -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</body>
</html>
